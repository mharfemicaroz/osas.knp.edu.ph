import{r as p,c as m,o as D,A as q,l as P,q as f,f as U,e as t,a as h,h as w,O as C,t as B,g as G,k as A}from"./index.B-6tafY-.js";import{_ as W,a as E}from"./SectionMain.CFNX5LOs.js";import{i as I,a as O,b as j,F}from"./index.sn20Oafi.js";import{i as J}from"./index.Di1jakzK.js";import{u as H}from"./activityDesign.CNmspB-s.js";import{u as Y}from"./utilizationRequest.Cr34-bTk.js";import{u as Z}from"./annualPlan.B_7K4PHW.js";import{_ as K}from"./_plugin-vue_export-helper.DlAUqK2U.js";import"./activityDesignService.Cgg2A24x.js";import"./utilizationRequestService.DxmES0ND.js";import"./liquidationFundService.DAdOKNzw.js";import"./ToasterComponent.CQa4GvvN.js";const Q={class:"w-full space-y-4"},X={class:"flex items-center justify-between flex-wrap gap-3"},ee={class:"flex items-center gap-2"},te={class:"inline-flex items-center gap-2 px-3 py-1.5 rounded-full bg-blue-50 text-blue-700 border border-blue-200"},re={class:"inline-flex items-center gap-2 px-3 py-1.5 rounded-full bg-emerald-50 text-emerald-700 border border-emerald-200"},se={class:"inline-flex items-center gap-2 px-3 py-1.5 rounded-full bg-amber-50 text-amber-700 border border-amber-200"},ae={key:0,class:"w-full p-6 text-center rounded-xl border border-gray-200 bg-white shadow-sm"},oe={key:1,class:"w-full p-4 rounded-xl border border-red-200 bg-red-50 text-red-700"},le={key:2,class:"w-full rounded-xl overflow-hidden border border-gray-200 bg-white shadow"},ie="Asia/Manila",ne={__name:"CalendarActivityPage",setup(de){const d=H(),c=Y(),u=Z(),b=p(!0),x=p(!0),g=p(!0),M=m(()=>d.isLoading||c.isLoading||u.isLoading),k=m(()=>d.error||c.error||u.error),z={status:"approved",limit:1e3,officer:"true",order:"ASC",sort:"date_of_implementation"};D(async()=>{await Promise.allSettled([d.fetchAll(z,!0),c.fetchAll({status:"approved",limit:1e3,officer:"true",order:"ASC",sort:"start_at"},!0),u.fetchAll({status:"approved",limit:1e3,officer:"true",order:"ASC",sort:"approved_at"},!0)])});function N(r,e=[]){try{return JSON.parse(r||"[]")}catch{return e}}function v(r){return r==="AD"?{backgroundColor:"#1e40af",borderColor:"#1e3a8a",textColor:"#ffffff"}:r==="UR"?{backgroundColor:"#047857",borderColor:"#065f46",textColor:"#ffffff"}:{backgroundColor:"#b45309",borderColor:"#92400e",textColor:"#ffffff"}}const R=m(()=>{const r=[];if(b.value)for(const e of d.items.data){const s=e?.date_of_implementation||e?.approved_at||e?.created_at;if(!s)continue;const a=e?.club?.name?` • ${e.club.name}`:"",{backgroundColor:l,borderColor:i,textColor:o}=v("AD");r.push({id:`AD-${e.id}`,title:`Activity: ${e.name_of_activity||e.reference_code}${a}`,start:s,allDay:!0,extendedProps:{type:"Activity Design",ref:e.reference_code,club:e?.club},backgroundColor:l,borderColor:i,textColor:o})}if(x.value)for(const e of c.items.data){const s=e?.start_at||e?.approved_at||e?.created_at,a=e?.end_at||e?.start_at||e?.approved_at;if(!s)continue;const l=Array.isArray(e?.facilities)?e.facilities:N(e?.facilities),i=l?.length?` • ${l.join(", ")}`:"",o=e?.activity_design?.name_of_activity?` • ${e.activity_design.name_of_activity}`:"",{backgroundColor:n,borderColor:y,textColor:_}=v("UR");r.push({id:`UR-${e.id}`,title:`Utilization${o}${i}`,start:s,end:a,allDay:!e?.start_at||!e?.end_at,extendedProps:{type:"Utilization",ref:e.reference_code,facilities:l},backgroundColor:n,borderColor:y,textColor:_})}if(g.value)for(const e of u.items.data){const s=e?.approved_at||e?.submitted_at||e?.created_at;if(!s)continue;const a=e?.club?.name?` • ${e.club.name}`:"",l=e?.school_year?` • SY ${e.school_year}`:"",{backgroundColor:i,borderColor:o,textColor:n}=v("AP");r.push({id:`AP-${e.id}`,title:`Annual Plan Approved${a}${l}`,start:s,allDay:!0,extendedProps:{type:"Annual Plan",ref:e.reference_code},backgroundColor:i,borderColor:o,textColor:n})}return r});function V(r){const e=!!r.el.closest(".fc-list"),s=(r.event.backgroundColor||"").trim().toLowerCase(),a=s.startsWith("#")?s.slice(1):null;let l=!0;if(a&&(a.length===6||a.length===3)){const o=a.length===3?a.split("").map(L=>L+L).join(""):a,n=parseInt(o.slice(0,2),16),y=parseInt(o.slice(2,4),16),_=parseInt(o.slice(4,6),16);l=(.299*n+.587*y+.114*_)/255<.6}e?(r.el.classList.remove("text-white"),r.el.classList.add("text-gray-900")):(r.el.classList.add("rounded-md","shadow-sm"),r.el.classList.remove("text-white","text-gray-900"),r.el.classList.add(l?"text-white":"text-gray-900"));const i=document.createElement("span");if(i.textContent=r.event.extendedProps?.type||"",e){i.className="mr-2 inline-block px-1.5 py-0.5 text-[10px] font-semibold rounded bg-slate-200 text-slate-700";const o=r.el.querySelector(".fc-list-event-title");(o?.querySelector("a")||o)?.prepend(i)}else i.className=`px-1.5 py-0.5 text-[10px] font-semibold rounded mr-1 align-middle ${l?"bg-white/20 text-white":"bg-black/10 text-gray-900"}`,r.el.prepend(i)}const $=p(!1),S=()=>{$.value=window.innerWidth<640};D(()=>{S(),window.addEventListener("resize",S)});const T=m(()=>({plugins:[I,O,J,j],initialView:"dayGridMonth",headerToolbar:$.value?{left:"prev,next",center:"title",right:"dayGridMonth"}:{left:"prev,next today",center:"title",right:"dayGridMonth,timeGridWeek,timeGridDay,listWeek"},height:"auto",handleWindowResize:!0,stickyHeaderDates:!0,dayMaxEvents:3,navLinks:!0,eventTimeFormat:{hour:"2-digit",minute:"2-digit",meridiem:!0},timeZone:ie,events:R.value,eventDidMount:V}));return(r,e)=>(f(),q(W,null,{default:P(()=>[U(E,null,{default:P(()=>[t("div",Q,[t("div",X,[e[6]||(e[6]=t("h1",{class:"text-xl font-semibold"},"Campus Activities Calendar",-1)),t("div",ee,[t("label",te,[w(t("input",{type:"checkbox","onUpdate:modelValue":e[0]||(e[0]=s=>b.value=s),class:"accent-blue-600"},null,512),[[C,b.value]]),e[3]||(e[3]=t("span",{class:"text-sm"},"Activity Designs",-1))]),t("label",re,[w(t("input",{type:"checkbox","onUpdate:modelValue":e[1]||(e[1]=s=>x.value=s),class:"accent-emerald-600"},null,512),[[C,x.value]]),e[4]||(e[4]=t("span",{class:"text-sm"},"Utilizations",-1))]),t("label",se,[w(t("input",{type:"checkbox","onUpdate:modelValue":e[2]||(e[2]=s=>g.value=s),class:"accent-amber-600"},null,512),[[C,g.value]]),e[5]||(e[5]=t("span",{class:"text-sm"},"Annual Plans",-1))])])]),M.value?(f(),h("div",ae," Loading approved events… ")):k.value?(f(),h("div",oe,B(k.value),1)):(f(),h("div",le,[U(G(F),{options:T.value},null,8,["options"])])),e[7]||(e[7]=t("div",{class:"grid grid-cols-1 md:grid-cols-3 gap-3"},[t("div",{class:"p-4 rounded-xl border bg-white shadow-sm border-blue-200"},[t("div",{class:"text-xs uppercase tracking-wide text-blue-600 mb-1"},"Legend"),t("div",{class:"flex items-center gap-2 text-sm"},[t("span",{class:"w-3 h-3 rounded-sm bg-blue-600"}),A(" Activity Design (approved)")])]),t("div",{class:"p-4 rounded-xl border bg-white shadow-sm border-emerald-200"},[t("div",{class:"text-xs uppercase tracking-wide text-emerald-600 mb-1"},"Legend"),t("div",{class:"flex items-center gap-2 text-sm"},[t("span",{class:"w-3 h-3 rounded-sm bg-emerald-600"}),A(" Utilization Request (approved)")])]),t("div",{class:"p-4 rounded-xl border bg-white shadow-sm border-amber-200"},[t("div",{class:"text-xs uppercase tracking-wide text-amber-600 mb-1"},"Legend"),t("div",{class:"flex items-center gap-2 text-sm"},[t("span",{class:"w-3 h-3 rounded-sm bg-amber-600"}),A(" Annual Plan (approved)")])])],-1))])]),_:1})]),_:1}))}},Ce=K(ne,[["__scopeId","data-v-1412ec41"]]);export{Ce as default};
