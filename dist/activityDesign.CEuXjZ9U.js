import{M as i,N as A,r as d}from"./index.C4ttRr7x.js";function $(s={}){const{filters:a={},page:n,limit:o,sort:r,order:c,q:v,status:y,semester:f,school_year:g,club_id:p,filed_by_user_id:m,nature_of_activity:h,date_filed_from:w,date_filed_to:_,impl_from:B,impl_to:F,annual_plan_id:I,...l}=s,t={page:n,limit:o,sort:r,order:c,q:v,status:y,semester:f,school_year:g,club_id:p,filed_by_user_id:m,nature_of_activity:h,date_filed_from:w,date_filed_to:_,impl_from:B,impl_to:F,annual_plan_id:I,...l,filters:{...a}};return Object.keys(t).forEach(e=>t[e]===void 0&&delete t[e]),t}function S(s){return typeof Blob<"u"&&(s instanceof Blob||s instanceof File)}function P(s){if(typeof s=="string")return s;if(s==null)return null;try{return JSON.stringify(s)}catch{return null}}function b(s={}){const a={...s};return a.annual_plan_id===""&&(a.annual_plan_id=null),a.annual_plan_item!==void 0&&(a.annual_plan_item=P(a.annual_plan_item)),a}const u={async create(s){const{data:a}=await i.post("/activity-designs",b(s));return a},async getById(s){const{data:a}=await i.get(`/activity-designs/${s}`);return a},async updateById(s,a){const{data:n}=await i.put(`/activity-designs/${s}`,b(a));return n},async delete(s){const{data:a}=await i.delete(`/activity-designs/${s}`);return a},async list(s={}){const a={officer:!1,...$(s)},{data:n}=await i.get("/activity-designs",{params:a});return n},async submit(s){const{data:a}=await i.post(`/activity-designs/${s}/submit`);return a},async approve(s,{remarks:a}={}){const{data:n}=await i.post(`/activity-designs/${s}/approve`,{remarks:a});return n},async reject(s,{remarks:a}={}){const{data:n}=await i.post(`/activity-designs/${s}/reject`,{remarks:a});return n},async cancel(s,{remarks:a}={}){const{data:n}=await i.post(`/activity-designs/${s}/cancel`,{remarks:a});return n},async uploadAttachment(s,a){if(S(a)){const n=new FormData;n.append("file",a);const{data:o}=await i.post(`/activity-designs/${s}/attachments`,n,{headers:{"Content-Type":"multipart/form-data"}});return o}else{const{data:n}=await i.post(`/activity-designs/${s}/attachments`,{file:a});return n}},async deleteAttachment(s,a){const{data:n}=await i.delete(`/activity-designs/${s}/attachments/${a}`);return n}},x=A("activityDesign",()=>{const s=d({total:0,totalPages:1,currentPage:1,pageSize:10,data:[]}),a=d(!1),n=d(null),o=d(!1),r=d(null),c=l=>{if(!l?.id)return;const t=s.value.data.findIndex(e=>e.id===l.id);t!==-1&&(s.value.data[t]=l)};return{items:s,selected:r,isLoading:a,error:n,isLoaded:o,fetchAll:async(l={},t=!1)=>{if(n.value=null,!(!t&&o.value))try{a.value=!0;const e=await u.list(l);Object.assign(s.value,{total:e.total||0,totalPages:e.totalPages||1,currentPage:l.page||1,pageSize:l.limit||10,data:e.data||[]}),o.value=!0}catch(e){n.value=e?.response?.data?.message||e?.response?.message||e?.message||"Failed to fetch activity designs"}finally{a.value=!1}},fetchById:async l=>{n.value=null;try{a.value=!0;const t=await u.getById(l);r.value=t,c(t)}catch(t){n.value=t?.response?.data?.message||t?.response?.message||t?.message||"Failed to fetch activity design"}finally{a.value=!1}},create:async l=>{n.value=null;try{a.value=!0;const t=await u.create(l);return s.value.data.push(t),s.value.total+=1,t}catch(t){throw n.value=t?.response?.data?.message||t?.response?.message||t?.message||"Failed to create activity design",t}finally{a.value=!1}},updateById:async(l,t)=>{n.value=null;try{a.value=!0;const e=await u.updateById(l,t);return c(e),r.value?.id===l&&(r.value=e),e}catch(e){throw n.value=e?.response?.data?.message||e?.response?.message||e?.message||"Failed to update activity design",e}finally{a.value=!1}},deleteById:async l=>{n.value=null;try{a.value=!0,await u.delete(l),s.value.data=s.value.data.filter(t=>t.id!==l),s.value.total=Math.max(0,s.value.total-1),r.value?.id===l&&(r.value=null)}catch(t){n.value=t?.response?.data?.message||t?.response?.message||t?.message||"Failed to delete activity design"}finally{a.value=!1}},submit:async l=>{n.value=null;try{a.value=!0;const t=await u.submit(l);return c(t),r.value?.id===l&&(r.value=t),t}catch(t){throw n.value=t?.response?.data?.message||t?.response?.message||t?.message||"Failed to submit activity design",t}finally{a.value=!1}},approve:async(l,t)=>{n.value=null;try{a.value=!0;const e=await u.approve(l,{remarks:t});return c(e),r.value?.id===l&&(r.value=e),e}catch(e){throw n.value=e?.response?.data?.message||e?.response?.message||e?.message||"Failed to approve activity design",e}finally{a.value=!1}},reject:async(l,t)=>{n.value=null;try{a.value=!0;const e=await u.reject(l,{remarks:t});return c(e),r.value?.id===l&&(r.value=e),e}catch(e){throw n.value=e?.response?.data?.message||e?.response?.message||e?.message||"Failed to reject activity design",e}finally{a.value=!1}},cancel:async(l,t)=>{n.value=null;try{a.value=!0;const e=await u.cancel(l,{remarks:t});return c(e),r.value?.id===l&&(r.value=e),e}catch(e){throw n.value=e?.response?.data?.message||e?.response?.message||e?.message||"Failed to cancel activity design",e}finally{a.value=!1}},uploadAttachment:async(l,t)=>{n.value=null;try{a.value=!0;const e=await u.uploadAttachment(l,t);return c(e),r.value?.id===l&&(r.value=e),e}catch(e){throw n.value=e?.response?.data?.message||e?.response?.message||e?.message||"Failed to upload attachment",e}finally{a.value=!1}},deleteAttachment:async(l,t)=>{n.value=null;try{a.value=!0;const e=await u.deleteAttachment(l,t);return c(e),r.value?.id===l&&(r.value=e),e}catch(e){throw n.value=e?.response?.data?.message||e?.response?.message||e?.message||"Failed to delete attachment",e}finally{a.value=!1}},resetStore:()=>{s.value={total:0,totalPages:1,currentPage:1,pageSize:10,data:[]},r.value=null,o.value=!1,a.value=!1,n.value=null}}});export{x as u};
