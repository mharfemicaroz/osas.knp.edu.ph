import{N as v,r as i}from"./index.B2BJlPrj.js";import{a as n}from"./activityDesignService.BcUtml_x.js";const j=v("activityDesign",()=>{const u=i({total:0,totalPages:1,currentPage:1,pageSize:10,data:[]}),s=i(!1),l=i(null),o=i(!1),r=i(null),c=t=>{if(!t?.id)return;const a=u.value.data.findIndex(e=>e.id===t.id);a!==-1&&(u.value.data[a]=t)};return{items:u,selected:r,isLoading:s,error:l,isLoaded:o,fetchAll:async(t={},a=!1)=>{if(l.value=null,!(!a&&o.value))try{s.value=!0;const e=await n.list(t);Object.assign(u.value,{total:e.total||0,totalPages:e.totalPages||1,currentPage:t.page||1,pageSize:t.limit||10,data:e.data||[]}),o.value=!0}catch(e){l.value=e?.response?.data?.message||e?.response?.message||e?.message||"Failed to fetch activity designs"}finally{s.value=!1}},fetchById:async t=>{l.value=null;try{s.value=!0;const a=await n.getById(t);r.value=a,c(a)}catch(a){l.value=a?.response?.data?.message||a?.response?.message||a?.message||"Failed to fetch activity design"}finally{s.value=!1}},create:async t=>{l.value=null;try{s.value=!0;const a=await n.create(t);return u.value.data.push(a),u.value.total+=1,a}catch(a){throw l.value=a?.response?.data?.message||a?.response?.message||a?.message||"Failed to create activity design",a}finally{s.value=!1}},updateById:async(t,a)=>{l.value=null;try{s.value=!0;const e=await n.updateById(t,a);return c(e),r.value?.id===t&&(r.value=e),e}catch(e){throw l.value=e?.response?.data?.message||e?.response?.message||e?.message||"Failed to update activity design",e}finally{s.value=!1}},deleteById:async t=>{l.value=null;try{s.value=!0,await n.delete(t),u.value.data=u.value.data.filter(a=>a.id!==t),u.value.total=Math.max(0,u.value.total-1),r.value?.id===t&&(r.value=null)}catch(a){l.value=a?.response?.data?.message||a?.response?.message||a?.message||"Failed to delete activity design"}finally{s.value=!1}},submit:async t=>{l.value=null;try{s.value=!0;const a=await n.submit(t);return c(a),r.value?.id===t&&(r.value=a),a}catch(a){throw l.value=a?.response?.data?.message||a?.response?.message||a?.message||"Failed to submit activity design",a}finally{s.value=!1}},approve:async(t,a)=>{l.value=null;try{s.value=!0;const e=await n.approve(t,{remarks:a});return c(e),r.value?.id===t&&(r.value=e),e}catch(e){throw l.value=e?.response?.data?.message||e?.response?.message||e?.message||"Failed to approve activity design",e}finally{s.value=!1}},reject:async(t,a)=>{l.value=null;try{s.value=!0;const e=await n.reject(t,{remarks:a});return c(e),r.value?.id===t&&(r.value=e),e}catch(e){throw l.value=e?.response?.data?.message||e?.response?.message||e?.message||"Failed to reject activity design",e}finally{s.value=!1}},cancel:async(t,a)=>{l.value=null;try{s.value=!0;const e=await n.cancel(t,{remarks:a});return c(e),r.value?.id===t&&(r.value=e),e}catch(e){throw l.value=e?.response?.data?.message||e?.response?.message||e?.message||"Failed to cancel activity design",e}finally{s.value=!1}},uploadAttachment:async(t,a)=>{l.value=null;try{s.value=!0;const e=await n.uploadAttachment(t,a);return c(e),r.value?.id===t&&(r.value=e),e}catch(e){throw l.value=e?.response?.data?.message||e?.response?.message||e?.message||"Failed to upload attachment",e}finally{s.value=!1}},deleteAttachment:async(t,a)=>{l.value=null;try{s.value=!0;const e=await n.deleteAttachment(t,a);return c(e),r.value?.id===t&&(r.value=e),e}catch(e){throw l.value=e?.response?.data?.message||e?.response?.message||e?.message||"Failed to delete attachment",e}finally{s.value=!1}},sendEmail:async(t,a)=>{l.value=null;try{return s.value=!0,await n.sendEmail(t,a)}catch(e){throw l.value=e?.response?.data?.message||e?.response?.message||e?.message||"Failed to send email",e}finally{s.value=!1}},resetStore:()=>{u.value={total:0,totalPages:1,currentPage:1,pageSize:10,data:[]},r.value=null,o.value=!1,s.value=!1,l.value=null}}});export{j as u};
