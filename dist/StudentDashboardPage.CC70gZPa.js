import{u as pt,r as R,o as xt,c as l,x as ft,A as yt,l as J,q as i,f as h,e,h as j,a as n,F as $,B as F,t as b,C as N,g as c,k as x}from"./index.bm0HPCz8.js";import{_ as wt,a as Ct,q as M,t as Mt,r as St,n as At,i as kt,j as Dt,s as O}from"./SectionMain.DxjXU903.js";import{_ as W,a as Y,b as Bt}from"./LineChart.BeXjwzzT.js";import{u as jt}from"./club.B90eGyu3.js";import{u as $t}from"./clubDoc.B8jWOIhO.js";import{u as Ft}from"./activityDesign.CGBY-xgt.js";import{u as Nt}from"./clubScope.BJla7Oy8.js";import"./appContext.CP9t1CNK.js";import"./_plugin-vue_export-helper.DlAUqK2U.js";import"./activityDesignService.CVvrks6v.js";import"./utilizationRequestService.DR8aI7Vk.js";import"./liquidationFundService.C6xP3fLR.js";import"./ToasterComponent.QXt_Z3fa.js";const Ot={class:"p-3 mb-5 rounded-2xl border bg-white"},Wt={class:"grid grid-cols-1 md:grid-cols-3 gap-2 text-sm"},Yt=["value"],Tt=["value"],It=["disabled"],Lt=["value"],Ut={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4"},Vt={class:"rounded-2xl border bg-white shadow-sm p-4"},zt={class:"flex items-center justify-between"},Et={class:"w-5 h-5 text-blue-500",viewBox:"0 0 24 24"},Ht=["d"],Rt={class:"mt-2 text-2xl font-semibold text-gray-900"},Jt={class:"rounded-2xl border bg-white shadow-sm p-4"},Pt={class:"flex items-center justify-between"},qt={class:"w-5 h-5 text-emerald-600",viewBox:"0 0 24 24"},Gt=["d"],Kt={class:"mt-2 text-2xl font-semibold text-gray-900"},Qt={class:"rounded-2xl border bg-white shadow-sm p-4"},Xt={class:"flex items-center justify-between"},Zt={class:"w-5 h-5 text-indigo-600",viewBox:"0 0 24 24"},te=["d"],ee={class:"mt-2 text-2xl font-semibold text-gray-900"},se={class:"rounded-2xl border bg-white shadow-sm p-4"},oe={class:"flex items-center justify-between"},ae={class:"w-5 h-5 text-amber-600",viewBox:"0 0 24 24"},le=["d"],ie={class:"mt-2 text-2xl font-semibold text-gray-900"},ne={class:"rounded-2xl border bg-white shadow-sm p-4"},de={class:"flex items-center justify-between"},re={class:"w-5 h-5 text-blue-600",viewBox:"0 0 24 24"},ce=["d"],ue={class:"mt-2 text-2xl font-semibold text-gray-900"},me={class:"mt-1 text-xs text-gray-500"},be={class:"rounded-2xl border bg-white shadow-sm p-4"},ve={class:"flex items-center justify-between"},_e={class:"w-5 h-5 text-indigo-600",viewBox:"0 0 24 24"},he=["d"],ge={class:"mt-2 text-2xl font-semibold text-gray-900"},pe={class:"mt-6 grid grid-cols-1 xl:grid-cols-3 gap-6"},xe={class:"rounded-2xl border bg-white shadow-sm"},fe={class:"px-4 py-3 border-b flex items-center justify-between"},ye={class:"text-sm font-semibold text-gray-800 flex items-center gap-2"},we={class:"w-4 h-4 text-emerald-600",viewBox:"0 0 24 24"},Ce=["d"],Me={class:"p-4"},Se={class:"h-72"},Ae={class:"rounded-2xl border bg-white shadow-sm"},ke={class:"px-4 py-3 border-b flex items-center justify-between"},De={class:"text-sm font-semibold text-gray-800 flex items-center gap-2"},Be={class:"w-4 h-4 text-blue-600",viewBox:"0 0 24 24"},je=["d"],$e={class:"p-4"},Fe={class:"h-72"},Ne={class:"rounded-2xl border bg-white shadow-sm"},Oe={class:"px-4 py-3 border-b flex items-center justify-between"},We={class:"text-sm font-semibold text-gray-800 flex items-center gap-2"},Ye={class:"w-4 h-4 text-blue-600",viewBox:"0 0 24 24"},Te=["d"],Ie={class:"p-4"},Le={class:"h-72"},Ue={class:"rounded-2xl border bg-white shadow-sm"},Ve={class:"px-4 py-3 border-b flex items-center justify-between"},ze={class:"text-sm font-semibold text-gray-800 flex items-center gap-2"},Ee={class:"w-4 h-4 text-blue-600",viewBox:"0 0 24 24"},He=["d"],Re={class:"p-4"},Je={class:"h-72"},Pe={class:"rounded-2xl border bg-white shadow-sm"},qe={class:"px-4 py-3 border-b flex items-center justify-between"},Ge={class:"text-sm font-semibold text-gray-800 flex items-center gap-2"},Ke={class:"w-4 h-4 text-emerald-600",viewBox:"0 0 24 24"},Qe=["d"],Xe={class:"p-4"},Ze={class:"h-72"},ts={class:"rounded-2xl border bg-white shadow-sm"},es={class:"px-4 py-3 border-b flex items-center justify-between"},ss={class:"text-sm font-semibold text-gray-800 flex items-center gap-2"},os={class:"w-4 h-4 text-blue-600",viewBox:"0 0 24 24"},as=["d"],ls={class:"p-4"},is={class:"h-72"},ns={class:"rounded-2xl border bg-white shadow-sm xl:col-span-3"},ds={class:"px-4 py-3 border-b flex items-center justify-between"},rs={class:"text-sm font-semibold text-gray-800 flex items-center gap-2"},cs={class:"w-4 h-4 text-indigo-600",viewBox:"0 0 24 24"},us=["d"],ms={class:"p-4"},bs={class:""},Ds={__name:"StudentDashboardPage",setup(vs){const S=jt(),A=$t(),P=pt(),k=Ft(),{isClub:y,activeClubId:f,withClub:q}=Nt(),T=R(!0);xt(async()=>{try{await Promise.all([S.fetchAll({page:1,limit:1e3,filters:{include:"users"}},!0),A.fetchAll({page:1,limit:2e3},!0),k.fetchAll(q({page:1,limit:2e3}),!0)]),y.value&&f.value&&(m.value.club_id=Number(f.value))}finally{T.value=!1}});const I=l(()=>P.user?.id),G=l(()=>Array.isArray(S.clubs?.data)?S.clubs.data:[]),K=l(()=>Array.isArray(A.docs?.data)?A.docs.data:[]),Q=l(()=>Array.isArray(k.items?.data)?k.items.data:[]),v=l(()=>{const o=I.value;return o?G.value.filter(t=>Array.isArray(t.users)&&t.users.some(s=>s.id===o)):[]}),L=l(()=>new Set(v.value.map(o=>o.id))),X=l(()=>v.value.length),Z=l(()=>v.value.filter(o=>o.is_active!==!1).length),tt=l(()=>v.value.reduce((o,t)=>o+(Array.isArray(t.users)?t.users.length:0),0)),et=l(()=>{const o=L.value;return K.value.filter(t=>o.has(t.club_id)).length}),st=["1st Semester","2nd Semester","Summer"],ot=l(()=>{const o=new Date().getFullYear();return Array.from({length:6},(t,s)=>`${o-s}-${o-s+1}`)}),m=R({school_year:"",semester:"",club_id:""});ft([y,f],()=>{y.value&&f.value?m.value.club_id=Number(f.value):y.value||(m.value.club_id="")});const at=o=>{const t=(o??"active").toString().trim().toLowerCase();return["pending","active","inactive"].includes(t)?t:"active"},d={blue:"rgba(59,130,246,0.85)",blueSoft:"rgba(59,130,246,0.15)",indigo:"rgba(99,102,241,0.85)",indigoSoft:"rgba(99,102,241,0.15)",emerald:"rgba(16,185,129,0.85)",emeraldSoft:"rgba(16,185,129,0.15)",amber:"rgba(245,158,11,0.85)",amberSoft:"rgba(245,158,11,0.15)",rose:"rgba(244,63,94,0.85)",roseSoft:"rgba(244,63,94,0.15)",slate:"rgba(100,116,139,0.85)",slateSoft:"rgba(100,116,139,0.15)"},U=[d.blue,d.indigo,d.emerald,d.amber,d.rose,d.slate],V=[d.blueSoft,d.indigoSoft,d.emeraldSoft,d.amberSoft,d.roseSoft,d.slateSoft],w=o=>U[o%U.length],D=o=>V[o%V.length],B=o=>{if(!o)return null;const t=new Date(o);return isNaN(t)?null:t},C=new Date,z=(()=>{const o=new Date,t=o.getDay()||7;return t!==1&&o.setHours(-24*(t-1)),o.setHours(0,0,0,0),o})(),lt=(()=>{const o=new Date(z);return o.setDate(o.getDate()+6),o.setHours(23,59,59,999),o})(),it=new Date(C.getFullYear(),C.getMonth(),1),nt=new Date(C.getFullYear(),C.getMonth()+1,0,23,59,59,999),E=(o,t,s)=>{const a=B(o);return a&&a>=t&&a<=s},g=l(()=>{const o=L.value,t=m.value;return Q.value.filter(s=>!(!o.has(s.club_id)||t.school_year&&s.school_year!==t.school_year||t.semester&&s.semester!==t.semester||t.club_id&&+s.club_id!=+t.club_id))}),dt=l(()=>g.value.filter(o=>E(o.date_of_implementation,z,lt)).length),rt=l(()=>g.value.filter(o=>E(o.date_of_implementation,it,nt)).length),ct=l(()=>g.value.filter(o=>{const t=B(o.date_of_implementation);if(!t)return!1;const s=(t-C)/864e5;return s>=0&&s<=30}).length),ut=l(()=>{const o={active:0,pending:0,inactive:0},t=I.value;for(const s of v.value){const a=(s.users||[]).find(r=>r.id===t),u=at(a?.UserClub?.status);o[u]=(o[u]||0)+1}return{labels:["Active","Pending","Inactive"],datasets:[{data:[o.active,o.pending,o.inactive],backgroundColor:[d.emerald,d.amber,d.rose],borderColor:["white","white","white"],borderWidth:2}]}}),mt=l(()=>{const o={};for(const s of v.value){const a=(s.category||"Uncategorized").trim();o[a]=(o[a]||0)+1}const t=Object.keys(o).sort((s,a)=>o[a]-o[s]);return{labels:t,datasets:[{label:"My Clubs",data:t.map(s=>o[s]),backgroundColor:t.map((s,a)=>D(a)),borderColor:t.map((s,a)=>w(a)),borderWidth:1.5}]}}),bt=l(()=>{const o=v.value.map(s=>({name:s.name||s.code||`Club ${s.id}`,count:Array.isArray(s.users)?s.users.length:0})).sort((s,a)=>a.count-s.count),t=o.map(s=>s.name);return{labels:t,datasets:[{label:"Members",data:o.map(s=>s.count),backgroundColor:t.map((s,a)=>D(a)),borderColor:t.map((s,a)=>w(a)),borderWidth:1.5}]}}),vt=l(()=>{const o={draft:0,pending:0,approved:0,rejected:0,cancelled:0};for(const s of g.value)o[s.status]=(o[s.status]||0)+1;const t=Object.keys(o);return{labels:t,datasets:[{data:t.map(s=>o[s]),backgroundColor:t.map((s,a)=>w(a)),borderColor:t.map(()=>"white"),borderWidth:2}]}}),_t=l(()=>{const o={Curricular:0,"Co-Curricular":0,"Extra-Curricular":0};for(const s of g.value)o[s.nature_of_activity]=(o[s.nature_of_activity]||0)+1;const t=Object.keys(o);return{labels:t,datasets:[{data:t.map(s=>o[s]),backgroundColor:t.map((s,a)=>w(a+1)),borderColor:t.map(()=>"white"),borderWidth:2}]}}),ht=l(()=>{const o=new Map;for(const a of g.value){const u=a.club?.name||`Club #${a.club_id}`;o.set(u,(o.get(u)||0)+1)}const t=[...o.entries()].map(([a,u])=>({name:a,count:u})).sort((a,u)=>u.count-a.count),s=t.map(a=>a.name);return{labels:s,datasets:[{label:"# Activities",data:t.map(a=>a.count),backgroundColor:s.map((a,u)=>D(u)),borderColor:s.map((a,u)=>w(u)),borderWidth:1.5}]}}),gt=l(()=>{const o=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],t=new Date,s=[];for(let r=11;r>=0;r--){const _=new Date(t.getFullYear(),t.getMonth()-r,1);s.push({key:`${_.getFullYear()}-${_.getMonth()}`,y:_.getFullYear(),m:_.getMonth(),v:0})}const a=new Map(s.map(r=>[r.key,r]));for(const r of g.value){const _=B(r.date_filed||r.created_at);if(!_)continue;const H=`${_.getFullYear()}-${_.getMonth()}`;a.has(H)&&a.get(H).v++}return{labels:s.map(r=>`${o[r.m]} ${String(r.y).slice(-2)}`),datasets:[{label:"My clubsâ€™ activities filed",data:s.map(r=>r.v),borderColor:d.indigo,backgroundColor:d.indigoSoft,borderWidth:2,pointRadius:3,pointHoverRadius:4,tension:.3,fill:!0}]}}),p=l(()=>T.value||S.isLoading||A.isLoading||k.isLoading);return(o,t)=>(i(),yt(wt,null,{default:J(()=>[h(Ct,null,{default:J(()=>[t[24]||(t[24]=e("div",{class:"mb-4"},[e("h1",{class:"text-xl font-semibold text-gray-900"},"Student Dashboard"),e("p",{class:"text-sm text-gray-500"},"Your clubs and their activitiesâ€”at a glance.")],-1)),e("div",Ot,[e("div",Wt,[j(e("select",{"onUpdate:modelValue":t[0]||(t[0]=s=>m.value.school_year=s),class:"border rounded px-2 py-2"},[t[3]||(t[3]=e("option",{value:""},"All School Years",-1)),(i(!0),n($,null,F(ot.value,s=>(i(),n("option",{key:s,value:s},b(s),9,Yt))),128))],512),[[N,m.value.school_year]]),j(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>m.value.semester=s),class:"border rounded px-2 py-2"},[t[4]||(t[4]=e("option",{value:""},"All Semesters",-1)),(i(),n($,null,F(st,s=>e("option",{key:s,value:s},b(s),9,Tt)),64))],512),[[N,m.value.semester]]),j(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>m.value.club_id=s),class:"border rounded px-2 py-2",disabled:c(y)&&!!c(f)},[t[5]||(t[5]=e("option",{value:""},"All My Clubs",-1)),(i(!0),n($,null,F(v.value,s=>(i(),n("option",{key:s.id,value:s.id},b(s.name||"Club "+s.id),9,Lt))),128))],8,It),[[N,m.value.club_id]])])]),e("div",Ut,[e("div",Vt,[e("div",zt,[t[6]||(t[6]=e("div",{class:"text-sm text-gray-500"},"My Clubs",-1)),(i(),n("svg",Et,[e("path",{d:c(M)},null,8,Ht)]))]),e("div",Rt,b(X.value),1),t[7]||(t[7]=e("div",{class:"mt-1 text-xs text-gray-500"},"Youâ€™re a member of these clubs",-1))]),e("div",Jt,[e("div",Pt,[t[8]||(t[8]=e("div",{class:"text-sm text-gray-500"},"Active Memberships",-1)),(i(),n("svg",qt,[e("path",{d:c(Mt)},null,8,Gt)]))]),e("div",Kt,b(Z.value),1),t[9]||(t[9]=e("div",{class:"mt-1 text-xs text-gray-500"},"Clubs currently active",-1))]),e("div",Qt,[e("div",Xt,[t[10]||(t[10]=e("div",{class:"text-sm text-gray-500"},"Members in My Clubs",-1)),(i(),n("svg",Zt,[e("path",{d:c(St)},null,8,te)]))]),e("div",ee,b(tt.value),1),t[11]||(t[11]=e("div",{class:"mt-1 text-xs text-gray-500"},"Total membership size",-1))]),e("div",se,[e("div",oe,[t[12]||(t[12]=e("div",{class:"text-sm text-gray-500"},"Club Documents",-1)),(i(),n("svg",ae,[e("path",{d:c(At)},null,8,le)]))]),e("div",ie,b(et.value),1),t[13]||(t[13]=e("div",{class:"mt-1 text-xs text-gray-500"},"Across your clubs",-1))]),e("div",ne,[e("div",de,[t[14]||(t[14]=e("div",{class:"text-sm text-gray-500"},"Activities This Week",-1)),(i(),n("svg",re,[e("path",{d:c(kt)},null,8,ce)]))]),e("div",ue,b(dt.value),1),e("div",me,"This Month: "+b(rt.value),1)]),e("div",be,[e("div",ve,[t[15]||(t[15]=e("div",{class:"text-sm text-gray-500"},"Upcoming (30 Days)",-1)),(i(),n("svg",_e,[e("path",{d:c(Dt)},null,8,he)]))]),e("div",ge,b(ct.value),1),t[16]||(t[16]=e("div",{class:"mt-1 text-xs text-gray-500"},"Implementation dates ahead",-1))])]),e("div",pe,[e("div",xe,[e("div",fe,[e("h3",ye,[(i(),n("svg",we,[e("path",{d:c(O)},null,8,Ce)])),t[17]||(t[17]=x(" My Membership Status ",-1))])]),e("div",Me,[e("div",Se,[h(W,{data:ut.value,loading:p.value},null,8,["data","loading"])])])]),e("div",Ae,[e("div",ke,[e("h3",De,[(i(),n("svg",Be,[e("path",{d:c(M)},null,8,je)])),t[18]||(t[18]=x(" My Clubs by Category ",-1))])]),e("div",$e,[e("div",Fe,[h(Y,{data:mt.value,loading:p.value},null,8,["data","loading"])])])]),e("div",Ne,[e("div",Oe,[e("h3",We,[(i(),n("svg",Ye,[e("path",{d:c(M)},null,8,Te)])),t[19]||(t[19]=x(" Members by My Club ",-1))])]),e("div",Ie,[e("div",Le,[h(Y,{data:bt.value,loading:p.value,horizontal:!0},null,8,["data","loading"])])])]),e("div",Ue,[e("div",Ve,[e("h3",ze,[(i(),n("svg",Ee,[e("path",{d:c(O)},null,8,He)])),t[20]||(t[20]=x(" Activities by Status (My Clubs) ",-1))])]),e("div",Re,[e("div",Je,[h(W,{data:vt.value,loading:p.value},null,8,["data","loading"])])])]),e("div",Pe,[e("div",qe,[e("h3",Ge,[(i(),n("svg",Ke,[e("path",{d:c(O)},null,8,Qe)])),t[21]||(t[21]=x(" Activities by Nature (My Clubs) ",-1))])]),e("div",Xe,[e("div",Ze,[h(W,{data:_t.value,loading:p.value},null,8,["data","loading"])])])]),e("div",ts,[e("div",es,[e("h3",ss,[(i(),n("svg",os,[e("path",{d:c(M)},null,8,as)])),t[22]||(t[22]=x(" Activities by My Club ",-1))])]),e("div",ls,[e("div",is,[h(Y,{data:ht.value,loading:p.value,horizontal:!0},null,8,["data","loading"])])])]),e("div",ns,[e("div",ds,[e("h3",rs,[(i(),n("svg",cs,[e("path",{d:c(M)},null,8,us)])),t[23]||(t[23]=x(" My Clubsâ€™ Activity Trend (Monthly) ",-1))])]),e("div",ms,[e("div",bs,[h(Bt,{data:gt.value,loading:p.value},null,8,["data","loading"])])])])])]),_:1,__:[24]})]),_:1}))}};export{Ds as default};
