import{c as N,r as $,C as H,a as x,d as I,q as p,e,t as b,h as M,k as z,v as Y,E as ee,b as Re,g as L,z as Ne,F as W,G as q,S as ie,H as ze,I as Fe,o as ge,D as Oe,J as Ge,K as Ke,L as _e,n as Se,j as se,f as T,u as We,l as te,A as ke}from"./index.B-Q-J4WK.js";import{f as Ye,g as qe,h as He,i as Je,j as Qe,k as Xe,_ as Ze,a as et,l as tt,n as lt,o as nt}from"./SectionMain.C5xrv34b.js";import{_ as ue,a as ot,b as at,c as $e,B as st,d as Ve}from"./IconifyButton.Dm77Uu99.js";import{u as Pe}from"./club.WAbvTr5t.js";import{u as it}from"./clubDoc.CKWstWM_.js";import"./ToasterComponent.DeljTacu.js";import"./_plugin-vue_export-helper.DlAUqK2U.js";const rt={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/30 backdrop-blur-sm"},ut={class:"bg-white p-4 rounded-xl shadow-xl w-[920px] max-h-screen overflow-auto"},dt={class:"flex items-center justify-between mb-3"},ct={class:"text-lg font-semibold"},mt={class:"grid grid-cols-2 gap-4 text-sm"},vt={key:0,class:"text-red-600 text-xs mt-1"},ft={key:0,class:"text-red-600 text-xs mt-1"},bt={class:"col-span-2"},pt={class:"col-span-2 grid grid-cols-2 gap-4"},gt={class:"space-y-2"},yt={class:"border-2 border-dashed rounded-xl p-4 flex items-center justify-between gap-3"},xt={class:"flex items-center gap-3"},Ct={class:"w-16 h-16 bg-gray-50 border rounded-lg overflow-hidden flex items-center justify-center"},wt=["src"],ht={key:1,class:"text-xs text-gray-400"},_t={class:"flex items-center gap-2"},St={class:"px-3 py-2 bg-gray-800 text-white rounded cursor-pointer text-xs"},kt=["disabled"],$t={key:0,class:"text-red-600 text-xs mt-1"},Vt={key:1,class:"text-xs text-gray-500 break-all"},Dt={class:"space-y-2"},Ut={class:"border-2 border-dashed rounded-xl p-4 flex items-center justify-between gap-3"},Et={class:"flex items-center gap-3"},It={class:"w-40 h-16 bg-gray-50 border rounded-lg overflow-hidden flex items-center justify-center"},At=["src"],Lt={key:1,class:"text-xs text-gray-400"},Ot={class:"flex items-center gap-2"},Pt={class:"px-3 py-2 bg-gray-800 text-white rounded cursor-pointer text-xs"},Tt=["disabled"],Mt={key:0,class:"text-red-600 text-xs mt-1"},Bt={key:1,class:"text-xs text-gray-500 break-all"},jt={class:"flex justify-end gap-2 mt-5"},Rt=2*1024*1024,De={__name:"ClubFormModal",props:{modelValue:{type:Boolean,default:!1},mode:{type:String,default:"create"},initial:{type:Object,default:()=>({id:null,name:"",code:"",category:"",description:"",is_active:!0,established_at:"",website:"",email:"",phone:"",logo:"",banner:""})}},emits:["update:modelValue","submit"],setup(t,{emit:f}){const n=t,h=f,d=N({get:()=>n.modelValue,set:r=>h("update:modelValue",r)}),V="https://knp.edu.ph",l=$({...n.initial}),o=$({});H(()=>n.initial,r=>{l.value={...r},o.value={}},{immediate:!0});const m=N(()=>n.mode==="edit"?"Edit Club":"Add New Club"),y=N(()=>n.mode==="edit"?"Save Changes":"Create"),A=N(()=>{const r=l.value.logo;return r?r.startsWith("data:")?r:`${V}${r}`:""}),B=N(()=>{const r=l.value.banner;return r?r.startsWith("data:")?r:`${V}${r}`:""}),D=()=>{const r={};return l.value.name?.trim()||(r.name="Name is required"),l.value.code?.trim()||(r.code="Code is required"),o.value={...o.value,...r},Object.keys(r).length===0},U=["image/png","image/jpeg"],F=r=>new Promise((a,v)=>{const S=new FileReader;S.onload=E=>a(E.target.result),S.onerror=v,S.readAsDataURL(r)});function O(r,a){return o.value[a]="",U.includes(r.type)?r.size>Rt?(o.value[a]="File too large. Maximum size is 2 MB.",!1):!0:(o.value[a]="Invalid file type. Please upload a PNG or JPEG image.",!1)}const R=async r=>{const a=r.target.files?.[0];if(a){if(!O(a,"logo")){r.target.value="";return}l.value.logo=await F(a)}},P=async r=>{const a=r.target.files?.[0];if(a){if(!O(a,"banner")){r.target.value="";return}l.value.banner=await F(a)}},j=()=>{l.value.logo="",o.value.logo=""},_=()=>{l.value.banner="",o.value.banner=""},C=()=>{if(!D())return;const r={...l.value};Object.keys(r).forEach(a=>{r[a]===""&&(r[a]=null)}),h("submit",r)};return(r,a)=>d.value?(p(),x("div",rt,[e("div",ut,[e("div",dt,[e("h2",ct,b(m.value),1),e("button",{class:"px-3 py-1 text-xs bg-gray-200 rounded",onClick:a[0]||(a[0]=v=>d.value=!1)},"Close")]),e("div",mt,[e("div",null,[a[11]||(a[11]=e("label",{class:"block mb-1"},[z("Name "),e("span",{class:"text-red-500"},"*")],-1)),M(e("input",{"onUpdate:modelValue":a[1]||(a[1]=v=>l.value.name=v),class:"w-full border rounded px-3 py-2 focus:outline-none focus:ring",placeholder:"e.g. Math Society"},null,512),[[Y,l.value.name]]),o.value.name?(p(),x("p",vt,b(o.value.name),1)):I("",!0)]),e("div",null,[a[12]||(a[12]=e("label",{class:"block mb-1"},[z("Code "),e("span",{class:"text-red-500"},"*")],-1)),M(e("input",{"onUpdate:modelValue":a[2]||(a[2]=v=>l.value.code=v),class:"w-full border rounded px-3 py-2 focus:outline-none focus:ring",placeholder:"e.g. MATHSOC"},null,512),[[Y,l.value.code]]),o.value.code?(p(),x("p",ft,b(o.value.code),1)):I("",!0)]),e("div",null,[a[14]||(a[14]=e("label",{class:"block mb-1"},"Category",-1)),M(e("select",{"onUpdate:modelValue":a[3]||(a[3]=v=>l.value.category=v),class:"w-full border rounded px-3 py-2 focus:outline-none focus:ring"},a[13]||(a[13]=[Re('<option disabled value="">Select a category</option><option value="Academic">Academic</option><option value="Cultural">Cultural</option><option value="Athletics">Athletics</option><option value="Social">Social</option><option value="Community Service">Community Service</option><option value="Religious/Spiritual">Religious / Spiritual</option><option value="Environmental">Environmental</option><option value="Leadership">Leadership</option><option value="Others">Others</option>',10)]),512),[[ee,l.value.category]])]),e("div",null,[a[16]||(a[16]=e("label",{class:"block mb-1"},"Active?",-1)),M(e("select",{"onUpdate:modelValue":a[4]||(a[4]=v=>l.value.is_active=v),class:"w-full border rounded px-3 py-2 focus:outline-none focus:ring"},a[15]||(a[15]=[e("option",{value:!0},"Yes",-1),e("option",{value:!1},"No",-1)]),512),[[ee,l.value.is_active]])]),e("div",bt,[a[17]||(a[17]=e("label",{class:"block mb-1"},"Description",-1)),M(e("textarea",{"onUpdate:modelValue":a[5]||(a[5]=v=>l.value.description=v),class:"w-full border rounded px-3 py-2 focus:outline-none focus:ring",rows:"3"},null,512),[[Y,l.value.description]])]),e("div",null,[a[18]||(a[18]=e("label",{class:"block mb-1"},"Established At",-1)),M(e("input",{"onUpdate:modelValue":a[6]||(a[6]=v=>l.value.established_at=v),type:"date",class:"w-full border rounded px-3 py-2 focus:outline-none focus:ring"},null,512),[[Y,l.value.established_at]])]),e("div",null,[a[19]||(a[19]=e("label",{class:"block mb-1"},"Website",-1)),M(e("input",{"onUpdate:modelValue":a[7]||(a[7]=v=>l.value.website=v),class:"w-full border rounded px-3 py-2 focus:outline-none focus:ring",placeholder:"https://…"},null,512),[[Y,l.value.website]])]),e("div",null,[a[20]||(a[20]=e("label",{class:"block mb-1"},"Email",-1)),M(e("input",{"onUpdate:modelValue":a[8]||(a[8]=v=>l.value.email=v),type:"email",class:"w-full border rounded px-3 py-2 focus:outline-none focus:ring",placeholder:"club@example.com"},null,512),[[Y,l.value.email]])]),e("div",null,[a[21]||(a[21]=e("label",{class:"block mb-1"},"Phone",-1)),M(e("input",{"onUpdate:modelValue":a[9]||(a[9]=v=>l.value.phone=v),class:"w-full border rounded px-3 py-2 focus:outline-none focus:ring",placeholder:"+63…"},null,512),[[Y,l.value.phone]])]),e("div",pt,[e("div",gt,[a[24]||(a[24]=e("label",{class:"block"},"Logo",-1)),e("div",yt,[e("div",xt,[e("div",Ct,[A.value?(p(),x("img",{key:0,src:A.value,alt:"Logo",class:"w-full h-full object-contain"},null,8,wt)):(p(),x("span",ht,"No logo"))]),a[22]||(a[22]=e("div",{class:"text-xs text-gray-500"},[e("p",{class:"font-medium text-gray-700"},"PNG/JPEG • ≤ 2MB"),e("p",null,"Square works best")],-1))]),e("div",_t,[e("label",St,[a[23]||(a[23]=z(" Change ",-1)),e("input",{type:"file",class:"hidden",accept:"image/png,image/jpeg",onChange:R},null,32)]),e("button",{class:"px-3 py-2 bg-gray-200 rounded text-xs",onClick:j,disabled:!l.value.logo},"Remove",8,kt)])]),o.value.logo?(p(),x("p",$t,b(o.value.logo),1)):I("",!0),l.value.logo&&!l.value.logo.startsWith("data:")?(p(),x("p",Vt,b(L(V)+l.value.logo),1)):I("",!0)]),e("div",Dt,[a[27]||(a[27]=e("label",{class:"block"},"Banner",-1)),e("div",Ut,[e("div",Et,[e("div",It,[B.value?(p(),x("img",{key:0,src:B.value,alt:"Banner",class:"w-full h-full object-contain"},null,8,At)):(p(),x("span",Lt,"No banner"))]),a[25]||(a[25]=e("div",{class:"text-xs text-gray-500"},[e("p",{class:"font-medium text-gray-700"},"PNG/JPEG • ≤ 2MB"),e("p",null,"Wide 5:1 recommended")],-1))]),e("div",Ot,[e("label",Pt,[a[26]||(a[26]=z(" Change ",-1)),e("input",{type:"file",class:"hidden",accept:"image/png,image/jpeg",onChange:P},null,32)]),e("button",{class:"px-3 py-2 bg-gray-200 rounded text-xs",onClick:_,disabled:!l.value.banner},"Remove",8,Tt)])]),o.value.banner?(p(),x("p",Mt,b(o.value.banner),1)):I("",!0),l.value.banner&&!l.value.banner.startsWith("data:")?(p(),x("p",Bt,b(L(V)+l.value.banner),1)):I("",!0)])])]),e("div",jt,[e("button",{class:"px-4 py-2 bg-gray-200 rounded text-xs",onClick:a[10]||(a[10]=v=>d.value=!1)},"Cancel"),e("button",{class:"px-4 py-2 bg-blue-600 text-white rounded text-xs",onClick:C},b(y.value),1)])])])):I("",!0)}},Nt={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/30 backdrop-blur-sm"},zt={class:"bg-white p-4 rounded shadow-lg w-[860px] max-h-screen overflow-auto"},Ft={class:"flex items-center justify-between"},Gt={class:"text-lg font-semibold"},Kt={class:"text-gray-600"},Wt={class:"mt-3 flex flex-col gap-2"},Yt={class:"flex items-center gap-2"},qt=["value"],Ht={class:"text-[12px] text-gray-600"},Jt={class:"mt-4"},Qt={class:"relative"},Xt={key:0,class:"absolute z-10 mt-1 w-full bg-white border rounded shadow max-h-64 overflow-auto"},Zt={key:0,class:"px-3 py-2 text-xs text-gray-500"},el=["onClick"],tl={class:"font-medium"},ll={class:"text-gray-500"},nl={class:"text-xs text-gray-500"},ol={key:0,class:"px-3 py-2 text-xs text-gray-500"},al={key:0,class:"flex flex-wrap gap-2 mt-2"},sl=["onClick"],il={class:"flex justify-end mt-2"},rl=["disabled"],ul={class:"space-y-2 mt-4 max-h-[60vh] overflow-y-auto pr-2 -mr-2"},dl={class:"text-sm"},cl={class:"font-semibold"},ml={class:"text-gray-500 text-xs"},vl={class:"text-gray-600 text-xs"},fl={class:"mt-1 text-xs flex flex-wrap items-center gap-3"},bl=["disabled","value","onChange"],pl=["value"],gl=["disabled","value","onChange"],yl=["value"],xl={key:0,class:"text-[11px] text-gray-500"},Cl=["onClick"],wl={class:"flex justify-between items-center mt-3 text-xs text-gray-600"},me=10,hl={__name:"ClubMembersModal",props:{modelValue:{type:Boolean,default:!1},clubId:{type:[Number,String],required:!0},clubName:{type:String,default:""}},emits:["update:modelValue"],setup(t,{emit:f}){const n=t,h=f,d=Pe(),V=Ne(),l=N({get:()=>n.modelValue,set:u=>h("update:modelValue",u)}),o=$([]),m=$(1),y=$(""),A=$("all"),B=$("all"),D=["president","vice-president","secretary","treasurer","pio","business manager","bod","officer"],U=new Set([...D,"officer"]),F=[...D,"member"],O=["pending","active","inactive"],R=u=>(u??"member").toString().trim().toLowerCase()||"member",P=u=>{const s=R(u);if(s==="member")return 999;const i=D.indexOf(s);return i===-1?D.indexOf("officer"):i},j=u=>U.has(R(u?.UserClub?.role)),_=u=>{const s=(u??"active").toString().trim().toLowerCase();return O.includes(s)?s:"active"},C=u=>{const s=R(u?.UserClub?.role);return s==="member"?"member":F.includes(s)?s:"officer"},r=(u,s)=>{if(!s)return!0;const i=`${u.first_name||""} ${u.last_name||""}`.toLowerCase(),k=(u.username||"").toLowerCase(),Z=(u.email||"").toLowerCase();return i.includes(s)||k.includes(s)||Z.includes(s)},a=N(()=>{const u=y.value.trim().toLowerCase();let s=o.value||[];return A.value==="officers"?s=s.filter(j):A.value==="members"&&(s=s.filter(i=>!j(i))),B.value!=="all"&&(s=s.filter(i=>_(i?.UserClub?.status)===B.value)),u&&(s=s.filter(i=>r(i,u))),s.slice().sort((i,k)=>{const Z=P(i.UserClub?.role),ye=P(k.UserClub?.role);if(Z!==ye)return Z-ye;const xe=(i.last_name||"").toLowerCase(),Ce=(k.last_name||"").toLowerCase();if(xe!==Ce)return xe.localeCompare(Ce);const we=(i.first_name||"").toLowerCase(),he=(k.first_name||"").toLowerCase();return we!==he?we.localeCompare(he):(i.username||"").toLowerCase().localeCompare((k.username||"").toLowerCase())})}),v=N(()=>(o.value||[]).filter(j).length),S=N(()=>(o.value||[]).filter(u=>!j(u)).length),E=N(()=>{const u=a.value.length,s=Math.ceil(Math.max(u,1)/me),i=Math.min(m.value,s||1),k=(i-1)*me,Z=a.value.slice(k,k+me);return{total:u,totalPages:s,currentPage:i,pageSize:me,data:Z}});H([y,A,B],()=>m.value=1);const fe=async()=>{await d.fetchById(n.clubId),o.value=Array.isArray(d.selectedClub?.users)?d.selectedClub.users:[],y.value="",A.value="all",B.value="all",m.value=1},J=$(""),K=$([]),ne=$(!1),w=$([]);let g=null;const c=u=>{const s={};return u&&(u.includes("@")?s.email=u:s.username=u,s.is_active=!0),s},G=u=>{const s=new Set((o.value||[]).map(k=>k.id)),i=new Set((w.value||[]).map(k=>k.id));return(u||[]).filter(k=>!s.has(k.id)&&!i.has(k.id))},X=async()=>{const u=J.value.trim();if(!u){K.value=[];return}ne.value=!0;try{await V.fetchAll({page:1,limit:8,filters:c(u)},!0),K.value=G(V.users.data||[])}finally{ne.value=!1}};H(J,u=>{if(clearTimeout(g),!u?.trim()){K.value=[];return}g=setTimeout(X,250)});const oe=u=>{w.value.push(u),K.value=K.value.filter(s=>s.id!==u.id),J.value=""},de=u=>{w.value=w.value.filter(s=>s.id!==u)},ce=async()=>{if(!w.value.length)return;const u=w.value.map(s=>s.id);await d.addUsersToClub(n.clubId,u),o.value=Array.isArray(d.selectedClub?.users)?d.selectedClub.users:[],w.value=[],K.value=[],J.value="",m.value=1},ae=$(new Set),re=$(new Set),Me=async(u,s)=>{const i=_(s),k=_(u.UserClub?.status);if(k!==i){ae.value.add(u.id),u.UserClub||(u.UserClub={}),u.UserClub.status=i;try{await d.updateMemberStatus(n.clubId,u.id,i)}catch{u.UserClub.status=k,ie.fire("Update failed",d.error||"Unable to update status","error")}finally{ae.value.delete(u.id)}}},Be=async(u,s)=>{const i=R(s),k=R(u.UserClub?.role);if(k!==i){re.value.add(u.id),u.UserClub||(u.UserClub={}),u.UserClub.role=i;try{await d.updateMemberRole(n.clubId,u.id,i)}catch{u.UserClub.role=k,ie.fire("Update failed",d.error||"Unable to update role","error")}finally{re.value.delete(u.id)}}},je=async u=>{await d.removeUserFromClub(n.clubId,u),o.value=o.value.filter(s=>s.id!==u),J.value.trim()&&K.value.length&&(K.value=G(K.value))};return H(()=>n.modelValue,u=>{u&&fe()},{immediate:!1}),(u,s)=>l.value?(p(),x("div",Nt,[e("div",zt,[e("div",Ft,[e("h2",Gt,[s[7]||(s[7]=z("Club Members — ",-1)),e("span",Kt,b(t.clubName),1)]),e("button",{class:"px-3 py-1 text-xs bg-gray-200 rounded",onClick:s[0]||(s[0]=i=>l.value=!1)},"Close")]),e("div",Wt,[e("div",Yt,[M(e("select",{"onUpdate:modelValue":s[1]||(s[1]=i=>A.value=i),class:"border rounded px-2 py-1 text-sm"},s[8]||(s[8]=[e("option",{value:"all"},"All roles",-1),e("option",{value:"officers"},"Officers",-1),e("option",{value:"members"},"Members",-1)]),512),[[ee,A.value]]),M(e("select",{"onUpdate:modelValue":s[2]||(s[2]=i=>B.value=i),class:"border rounded px-2 py-1 text-sm"},[s[9]||(s[9]=e("option",{value:"all"},"All statuses",-1)),(p(),x(W,null,q(O,i=>e("option",{key:i,value:i},b(i),9,qt)),64))],512),[[ee,B.value]]),M(e("input",{"onUpdate:modelValue":s[3]||(s[3]=i=>y.value=i),type:"text",placeholder:"Search club members by name, username, or email…",class:"border rounded px-2 py-1 text-sm w-full"},null,512),[[Y,y.value]])]),e("div",Ht," Showing "+b(E.value.total)+" result(s). Officers: "+b(v.value)+" • Members: "+b(S.value),1)]),e("div",Jt,[e("div",Qt,[M(e("input",{"onUpdate:modelValue":s[4]||(s[4]=i=>J.value=i),type:"text",placeholder:"Add users: search by username or email…",class:"border rounded px-2 py-1 text-sm w-full",autocomplete:"off"},null,512),[[Y,J.value]]),J.value&&(K.value.length||ne.value)?(p(),x("div",Xt,[ne.value?(p(),x("div",Zt,"Searching…")):(p(),x(W,{key:1},[(p(!0),x(W,null,q(K.value,i=>(p(),x("button",{key:i.id,class:"w-full text-left px-3 py-2 hover:bg-gray-100 text-sm",onClick:k=>oe(i)},[e("div",tl,[z(b(i.first_name)+" "+b(i.last_name)+" ",1),e("span",ll,"@"+b(i.username),1)]),e("div",nl,b(i.email),1)],8,el))),128)),K.value.length?I("",!0):(p(),x("div",ol,"No matches"))],64))])):I("",!0)]),w.value.length?(p(),x("div",al,[(p(!0),x(W,null,q(w.value,i=>(p(),x("span",{key:i.id,class:"inline-flex items-center gap-2 px-2 py-1 bg-blue-50 border border-blue-200 rounded text-xs"},[z(b(i.first_name)+" "+b(i.last_name)+" (@"+b(i.username)+") ",1),e("button",{class:"ml-1 text-blue-600",onClick:k=>de(i.id)},"✕",8,sl)]))),128))])):I("",!0),e("div",il,[e("button",{class:"px-3 py-1 bg-blue-600 text-white rounded text-xs disabled:opacity-50",disabled:!w.value.length,onClick:ce}," Add Selected ",8,rl)])]),e("div",ul,[(p(!0),x(W,null,q(E.value.data,i=>(p(),x("div",{key:i.id,class:"flex items-start justify-between p-3 border bg-gray-50 rounded"},[e("div",dl,[e("div",cl,[z(b(i.first_name)+" "+b(i.last_name)+" ",1),e("span",ml,"(@"+b(i.username)+")",1)]),e("div",vl,b(i.email),1),e("div",fl,[e("span",null,[s[10]||(s[10]=z("Role: ",-1)),e("select",{class:"border rounded px-1 py-0.5 text-xs",disabled:re.value.has(i.id),value:C(i),onChange:k=>Be(i,k.target.value)},[(p(),x(W,null,q(F,k=>e("option",{key:k,value:k},b(k),9,pl)),64))],40,bl)]),e("span",null,[s[11]||(s[11]=z("Status: ",-1)),e("select",{class:"border rounded px-1 py-0.5 text-xs",disabled:ae.value.has(i.id),value:_(i.UserClub?.status),onChange:k=>Me(i,k.target.value)},[(p(),x(W,null,q(O,k=>e("option",{key:k,value:k},b(k),9,yl)),64))],40,gl)]),e("span",null,[s[12]||(s[12]=z("Joined: ",-1)),e("strong",null,b(i.UserClub?.joined_at?new Date(i.UserClub.joined_at).toLocaleDateString():"—"),1)]),re.value.has(i.id)||ae.value.has(i.id)?(p(),x("span",xl,"Saving…")):I("",!0)])]),e("div",null,[e("button",{class:"px-2 py-1 bg-red-600 text-white rounded text-xs",onClick:k=>je(i.id)},"Remove",8,Cl)])]))),128))]),e("div",wl,[m.value>1?(p(),x("button",{key:0,onClick:s[5]||(s[5]=i=>m.value=m.value-1),class:"px-3 py-1 bg-gray-300 rounded"},"Previous")):I("",!0),e("div",null,"Page "+b(E.value.currentPage)+" of "+b(E.value.totalPages||1),1),m.value<E.value.totalPages?(p(),x("button",{key:1,onClick:s[6]||(s[6]=i=>m.value=m.value+1),class:"px-3 py-1 bg-gray-300 rounded"},"Next")):I("",!0)])])])):I("",!0)}};var _l=["onActivate","onAddUndo","onBeforeAddUndo","onBeforeExecCommand","onBeforeGetContent","onBeforeRenderUI","onBeforeSetContent","onBeforePaste","onBlur","onChange","onClearUndos","onClick","onContextMenu","onCommentChange","onCompositionEnd","onCompositionStart","onCompositionUpdate","onCopy","onCut","onDblclick","onDeactivate","onDirty","onDrag","onDragDrop","onDragEnd","onDragGesture","onDragOver","onDrop","onExecCommand","onFocus","onFocusIn","onFocusOut","onGetContent","onHide","onInit","onInput","onKeyDown","onKeyPress","onKeyUp","onLoadContent","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onNodeChange","onObjectResizeStart","onObjectResized","onObjectSelected","onPaste","onPostProcess","onPostRender","onPreProcess","onProgressState","onRedo","onRemove","onReset","onSaveContent","onSelectionChange","onSetAttrib","onSetContent","onShow","onSubmit","onUndo","onVisualAid"],Sl=function(t){return _l.map(function(f){return f.toLowerCase()}).indexOf(t.toLowerCase())!==-1},kl=function(t,f,n){Object.keys(f).filter(Sl).forEach(function(h){var d=f[h];typeof d=="function"&&(h==="onInit"?d(t,n):n.on(h.substring(2),function(V){return d(V,n)}))})},$l=function(t,f,n,h){var d=t.modelEvents?t.modelEvents:null,V=Array.isArray(d)?d.join(" "):d;H(h,function(l,o){n&&typeof l=="string"&&l!==o&&l!==n.getContent({format:t.outputFormat})&&n.setContent(l)}),n.on(V||"change input undo redo",function(){f.emit("update:modelValue",n.getContent({format:t.outputFormat}))})},Vl=function(t,f,n,h,d,V){h.setContent(V()),n.attrs["onUpdate:modelValue"]&&$l(f,n,h,d),kl(t,n.attrs,h)},Ue=0,Te=function(t){var f=Date.now(),n=Math.floor(Math.random()*1e9);return Ue++,t+"_"+n+Ue+String(f)},Dl=function(t){return t!==null&&t.tagName.toLowerCase()==="textarea"},Ee=function(t){return typeof t>"u"||t===""?[]:Array.isArray(t)?t:t.split(" ")},Ul=function(t,f){return Ee(t).concat(Ee(f))},El=function(t){return t==null},Ie=function(t){var f;return typeof((f=t.options)===null||f===void 0?void 0:f.set)=="function"&&t.options.isRegistered("disabled")},Ae=function(){return{listeners:[],scriptId:Te("tiny-script"),scriptLoaded:!1}},Il=function(){var t=Ae(),f=function(d,V,l,o){var m=V.createElement("script");m.referrerPolicy="origin",m.type="application/javascript",m.id=d,m.src=l;var y=function(){m.removeEventListener("load",y),o()};m.addEventListener("load",y),V.head&&V.head.appendChild(m)},n=function(d,V,l){t.scriptLoaded?l():(t.listeners.push(l),d.getElementById(t.scriptId)||f(t.scriptId,d,V,function(){t.listeners.forEach(function(o){return o()}),t.scriptLoaded=!0}))},h=function(){t=Ae()};return{load:n,reinitialize:h}},Al=Il(),Ll=function(){return typeof window<"u"?window:global},le=function(){var t=Ll();return t&&t.tinymce?t.tinymce:null},Ol={apiKey:String,licenseKey:String,cloudChannel:String,id:String,init:Object,initialValue:String,inline:Boolean,modelEvents:[String,Array],plugins:[String,Array],tagName:String,toolbar:[String,Array],modelValue:String,disabled:Boolean,readonly:Boolean,tinymceScriptSrc:String,outputFormat:{type:String,validator:function(t){return t==="html"||t==="text"}}},Q=function(){return Q=Object.assign||function(t){for(var f,n=1,h=arguments.length;n<h;n++){f=arguments[n];for(var d in f)Object.prototype.hasOwnProperty.call(f,d)&&(t[d]=f[d])}return t},Q.apply(this,arguments)},Pl=function(t,f,n,h){return t(h||"div",{id:f,ref:n})},Tl=function(t,f,n){return t("textarea",{id:f,visibility:"hidden",ref:n})},be={selector:void 0,target:void 0},pe=function(t,f){var n;typeof((n=t.mode)===null||n===void 0?void 0:n.set)=="function"?t.mode.set(f):t.setMode(f)},Ml=ze({props:Ol,setup:function(t,f){var n=t.init?Q(Q({},t.init),be):Q({},be),h=Fe(t),d=h.disabled,V=h.readonly,l=h.modelValue,o=h.tagName,m=$(null),y=null,A=t.id||Te("tiny-vue"),B=t.init&&t.init.inline||t.inline,D=!!f.attrs["onUpdate:modelValue"],U=!0,F=t.initialValue?t.initialValue:"",O="",R=function(_){return D?function(){return l?.value?l.value:""}:function(){return _?F:O}},P=function(){var _=R(U),C=Q(Q({},n),{disabled:t.disabled,readonly:t.readonly,target:m.value,plugins:Ul(n.plugins,t.plugins),toolbar:t.toolbar||n.toolbar,inline:B,license_key:t.licenseKey,setup:function(r){y=r,!Ie(y)&&t.disabled===!0&&pe(y,"readonly"),r.on("init",function(a){return Vl(a,t,f,r,l,_)}),typeof n.setup=="function"&&n.setup(r)}});Dl(m.value)&&(m.value.style.visibility=""),le().init(C),U=!1};H(V,function(_){y!==null&&pe(y,_?"readonly":"design")}),H(d,function(_){y!==null&&(Ie(y)?y.options.set("disabled",_):pe(y,_?"readonly":"design"))}),H(o,function(_){var C;y&&(D||(O=y.getContent()),(C=le())===null||C===void 0||C.remove(y),Se(function(){return P()}))}),ge(function(){if(le()!==null)P();else if(m.value&&m.value.ownerDocument){var _=t.cloudChannel?t.cloudChannel:"8",C=t.apiKey?t.apiKey:"no-api-key",r=El(t.tinymceScriptSrc)?"https://cdn.tiny.cloud/1/".concat(C,"/tinymce/").concat(_,"/tinymce.min.js"):t.tinymceScriptSrc;Al.load(m.value.ownerDocument,r,P)}}),Oe(function(){le()!==null&&le().remove(y)}),B||(Ge(function(){U||P()}),Ke(function(){var _;y&&(D||(O=y.getContent()),(_=le())===null||_===void 0||_.remove(y))}));var j=function(_){var C;y&&(O=y.getContent(),(C=le())===null||C===void 0||C.remove(y),n=Q(Q(Q({},n),_),be),Se(function(){return P()}))};return f.expose({rerender:j,getEditor:function(){return y}}),function(){return B?Pl(_e,A,m,t.tagName):Tl(_e,A,m)}}});function Bl(){const t=$(null),f=$(!1);return{editorRef:t,isFullscreen:f,onInit:(l,o)=>{t.value=o},toggleFullscreen:()=>{t.value&&(t.value.execCommand("mceFullScreen"),f.value=!f.value)},ensureExitFullscreen:()=>{f.value&&t.value&&(t.value.execCommand("mceFullScreen"),f.value=!1)},tinymceInit:{menubar:!1,height:320,plugins:"lists link image table code paste fullscreen",toolbar:"undo redo | blocks | bold italic underline strikethrough | forecolor backcolor | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link image | removeformat | code | fullscreen",paste_data_images:!0,image_dimensions:!0,image_caption:!0,object_resizing:"img",branding:!1,content_style:"body{font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif; font-size:14px}",automatic_uploads:!1,file_picker_types:"image",file_picker_callback:l=>{const o=document.createElement("input");o.type="file",o.accept="image/*",o.onchange=()=>{const m=o.files?.[0];if(!m)return;const y=new FileReader;y.onload=()=>l(y.result),y.readAsDataURL(m)},o.click()}}}}const jl={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/30 backdrop-blur-sm"},Rl={class:"bg-white p-4 rounded shadow-lg w-[1024px] max-h-screen overflow-auto"},Nl={class:"flex items-center justify-between mb-2"},zl={class:"text-lg font-semibold"},Fl={class:"flex items-center gap-2"},Gl={class:"bg-white w-full max-w-[1024px] max-h-screen rounded-2xl shadow-lg flex flex-col"},Kl={class:"p-5 flex-1 overflow-auto"},Wl={class:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm"},Yl=["aria-invalid"],ql=["value"],Hl={key:0,class:"text-red-600 text-xs mt-1"},Jl=["aria-invalid"],Ql=["value"],Xl={key:0,class:"text-red-600 text-xs mt-1"},Zl={class:"md:col-span-2"},en=["aria-invalid"],tn={key:0,class:"text-red-600 text-xs mt-1"},ln={class:"md:col-span-2"},nn={key:0,class:"text-red-600 text-xs mt-1"},on={class:"md:col-span-2"},an={class:"border-t p-4 bg-white flex items-center justify-end gap-2"},Le={__name:"DocFormModal",props:{modelValue:{type:Boolean,default:!1},mode:{type:String,default:"create"},initial:{type:Object,default:()=>({id:null,type:"cbl",title:"",content:"",status:"draft",doc_date:""})}},emits:["update:modelValue","submit","closed"],setup(t,{emit:f}){const n=["draft","published","archived"],h=["cbl","resolution","minute"],d=t,V=f,l=N({get:()=>d.modelValue,set:_=>V("update:modelValue",_)}),{isFullscreen:o,onInit:m,toggleFullscreen:y,ensureExitFullscreen:A,tinymceInit:B}=Bl(),D=$({...d.initial}),U=$({});H(()=>d.initial,_=>{D.value={..._},U.value={}},{immediate:!0});const F=N(()=>d.mode==="edit"?"Edit Document":"Add Document"),O=N(()=>d.mode==="edit"?"Save Changes":"Create"),R=()=>{const _={};return D.value.type||(_.type="Type is required"),D.value.title?.trim()||(_.title="Title is required"),D.value.content?.trim()||(_.content="Content is required"),D.value.status&&!n.includes(D.value.status)&&(_.status="Invalid status"),U.value=_,Object.keys(_).length===0},P=()=>{if(!R())return;const _={...D.value,doc_date:D.value.doc_date||null};V("submit",_)},j=()=>{A(),l.value=!1,V("closed")};return(_,C)=>l.value?(p(),x("div",jl,[e("div",Rl,[e("div",Nl,[e("h2",zl,b(F.value),1),e("div",Fl,[e("button",{class:"px-3 py-1 text-xs bg-indigo-600 text-white rounded",onClick:C[0]||(C[0]=(...r)=>L(y)&&L(y)(...r))},b(L(o)?"Restore":"Maximize"),1),e("button",{class:"px-3 py-1 text-xs bg-gray-200 rounded",onClick:j},"Close")])]),e("div",Gl,[e("div",Kl,[e("div",Wl,[e("div",null,[C[6]||(C[6]=e("label",{class:"block mb-1 font-medium text-gray-700"},[z("Type "),e("span",{class:"text-red-500"},"*")],-1)),M(e("select",{"onUpdate:modelValue":C[1]||(C[1]=r=>D.value.type=r),"aria-invalid":!!U.value.type,class:se(["w-full rounded-lg border px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",U.value.type?"border-red-500":"border-gray-300"])},[(p(),x(W,null,q(h,r=>e("option",{key:r,value:r},b(r),9,ql)),64))],10,Yl),[[ee,D.value.type]]),U.value.type?(p(),x("p",Hl,b(U.value.type),1)):I("",!0)]),e("div",null,[C[7]||(C[7]=e("label",{class:"block mb-1 font-medium text-gray-700"},"Status",-1)),M(e("select",{"onUpdate:modelValue":C[2]||(C[2]=r=>D.value.status=r),"aria-invalid":!!U.value.status,class:se(["w-full rounded-lg border px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",U.value.status?"border-red-500":"border-gray-300"])},[(p(),x(W,null,q(["draft","published","archived"],r=>e("option",{key:r,value:r},b(r),9,Ql)),64))],10,Jl),[[ee,D.value.status]]),U.value.status?(p(),x("p",Xl,b(U.value.status),1)):I("",!0)]),e("div",Zl,[C[8]||(C[8]=e("label",{class:"block mb-1 font-medium text-gray-700"},[z("Title "),e("span",{class:"text-red-500"},"*")],-1)),M(e("input",{"onUpdate:modelValue":C[3]||(C[3]=r=>D.value.title=r),"aria-invalid":!!U.value.title,placeholder:"Document title",class:se(["w-full rounded-lg border px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",U.value.title?"border-red-500":"border-gray-300"])},null,10,en),[[Y,D.value.title]]),U.value.title?(p(),x("p",tn,b(U.value.title),1)):I("",!0)]),e("div",ln,[C[9]||(C[9]=e("label",{class:"block mb-1 font-medium text-gray-700"},[z("Content "),e("span",{class:"text-red-500"},"*")],-1)),e("div",{class:se(["rounded-lg border",U.value.content?"border-red-500":"border-gray-300"])},[T(L(Ml),{modelValue:D.value.content,"onUpdate:modelValue":C[4]||(C[4]=r=>D.value.content=r),init:L(B),onInit:L(m),"tinymce-script-src":"/tinymce/tinymce.min.js",licenseKey:"gpl"},null,8,["modelValue","init","onInit"])],2),U.value.content?(p(),x("p",nn,b(U.value.content),1)):I("",!0)]),e("div",on,[C[10]||(C[10]=e("label",{class:"block mb-1 font-medium text-gray-700"},"Document Date",-1)),M(e("input",{"onUpdate:modelValue":C[5]||(C[5]=r=>D.value.doc_date=r),type:"date",class:"w-full rounded-lg border px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 border-gray-300"},null,512),[[Y,D.value.doc_date]])])])]),e("div",an,[e("button",{type:"button",class:"px-4 py-2 rounded-lg text-xs border border-gray-300 hover:bg-gray-100 transition",onClick:j}," Cancel "),e("button",{type:"button",class:se(["px-4 py-2 rounded-lg text-xs",d.mode==="edit"?"bg-emerald-600 text-white hover:bg-emerald-700":"bg-blue-600 text-white hover:bg-blue-700"]),onClick:P},b(O.value),3)])])])])):I("",!0)}},sn={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/30 backdrop-blur-sm"},rn={class:"bg-white p-4 rounded shadow-lg w-[900px] max-h-screen overflow-auto"},un={class:"flex items-center justify-between"},dn={class:"text-lg font-semibold"},cn={class:"text-gray-600"},mn={class:"flex items-center gap-2"},vn={class:"mt-3 flex flex-col gap-2"},fn={class:"flex items-center gap-2"},bn=["value"],pn=["value"],gn={class:"text-[12px] text-gray-600"},yn={class:"space-y-2 mt-4 max-h-[60vh] overflow-y-auto pr-2 -mr-2"},xn={class:"text-sm"},Cn={class:"flex flex-wrap items-center gap-2"},wn={class:"font-semibold"},hn={class:"px-2 py-[2px] text-[11px] rounded bg-indigo-100 text-indigo-700 uppercase"},_n={class:"text-xs text-gray-600"},Sn={class:"shrink-0 flex items-center gap-2"},kn=["onClick"],$n=["onClick"],Vn={class:"flex justify-between items-center mt-3 text-xs text-gray-600"},ve=10,Dn={__name:"ClubDocsModal",props:{modelValue:{type:Boolean,default:!1},clubId:{type:[Number,String],required:!0},clubName:{type:String,default:""}},emits:["update:modelValue"],setup(t,{emit:f}){const n=t,h=f,d=it(),V=N({get:()=>n.modelValue,set:w=>h("update:modelValue",w)}),l=$([]),o=$(1),m=$(""),y=$("all"),A=$("all"),B=["cbl","resolution","minute"],D=["draft","published","archived"],U=["cbl","resolution","minute"],F=w=>U.includes((w||"").toLowerCase())?(w||"").toLowerCase():"cbl",O=w=>{const g=F(w),c=B.indexOf(g);return c===-1?999:c},R=(w,g)=>{if(!g)return!0;const c=(w.title||"").toLowerCase(),G=(w.content||"").toLowerCase();return c.includes(g)||G.includes(g)},P=N(()=>{const w=m.value.trim().toLowerCase();let g=l.value||[];return y.value!=="all"&&(g=g.filter(c=>(c.type||"").toLowerCase()===y.value)),A.value!=="all"&&(g=g.filter(c=>(c.status||"").toLowerCase()===A.value)),w&&(g=g.filter(c=>R(c,w))),g.slice().sort((c,G)=>{const X=O(c.type),oe=O(G.type);if(X!==oe)return X-oe;const de=c.doc_date||c.created_at,ce=G.doc_date||G.created_at,ae=de?new Date(de).getTime():0;return(ce?new Date(ce).getTime():0)-ae})}),j=N(()=>{const w=P.value.length,g=Math.ceil(Math.max(w,1)/ve),c=Math.min(o.value,g||1),G=(c-1)*ve,X=P.value.slice(G,G+ve);return{total:w,totalPages:g,currentPage:c,pageSize:ve,data:X}});H([m,y,A],()=>o.value=1);const _=async()=>{m.value="",y.value="all",A.value="all",o.value=1,await d.fetchByClub(n.clubId,{page:1,limit:200}),l.value=Array.isArray(d.docs?.data)?d.docs.data:[]},C=$(!1),r=$(!1),a=$(null),v=()=>{C.value=!0},S=async w=>{const g=await d.create({...w,club_id:n.clubId});l.value.unshift(g),C.value=!1},E=()=>{},fe=w=>{a.value={id:w.id,type:w.type||"cbl",title:w.title||"",content:w.content||"",status:w.status||"draft",doc_date:w.doc_date?String(w.doc_date).slice(0,10):""},r.value=!0},J=async w=>{const{id:g,...c}=w,G=await d.updateById(g,{...c}),X=l.value.findIndex(oe=>oe.id===g);X!==-1&&(l.value[X]=G),r.value=!1},K=()=>{},ne=async w=>{(await ie.fire({title:`Delete document "${w.title}"?`,text:"This cannot be undone.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Yes, delete it",cancelButtonText:"Cancel"})).isConfirmed&&(await d.deleteById(w.id),l.value=l.value.filter(c=>c.id!==w.id),await ie.fire("Deleted!","The document has been deleted.","success"))};return H(()=>n.modelValue,w=>{w&&_()},{immediate:!1}),(w,g)=>V.value?(p(),x("div",sn,[e("div",rn,[e("div",un,[e("h2",dn,[g[8]||(g[8]=z("Club Documents — ",-1)),e("span",cn,b(t.clubName),1)]),e("div",mn,[e("button",{class:"px-3 py-1 text-xs bg-blue-600 text-white rounded",onClick:v},"+ Add Document"),e("button",{class:"px-3 py-1 text-xs bg-gray-200 rounded",onClick:g[0]||(g[0]=c=>V.value=!1)},"Close")])]),e("div",vn,[e("div",fn,[M(e("select",{"onUpdate:modelValue":g[1]||(g[1]=c=>y.value=c),class:"border rounded px-2 py-1 text-sm"},[g[9]||(g[9]=e("option",{value:"all"},"All types",-1)),(p(),x(W,null,q(U,c=>e("option",{key:c,value:c},b(c),9,bn)),64))],512),[[ee,y.value]]),M(e("select",{"onUpdate:modelValue":g[2]||(g[2]=c=>A.value=c),class:"border rounded px-2 py-1 text-sm"},[g[10]||(g[10]=e("option",{value:"all"},"All statuses",-1)),(p(),x(W,null,q(D,c=>e("option",{key:c,value:c},b(c),9,pn)),64))],512),[[ee,A.value]]),M(e("input",{"onUpdate:modelValue":g[3]||(g[3]=c=>m.value=c),type:"text",placeholder:"Search documents by title or content…",class:"border rounded px-2 py-1 text-sm w-full"},null,512),[[Y,m.value]])]),e("div",gn," Showing "+b(j.value.total)+" document(s). Ordered by type → date. ",1)]),e("div",yn,[(p(!0),x(W,null,q(j.value.data,c=>(p(),x("div",{key:c.id,class:"border rounded p-3 bg-gray-50 flex items-start justify-between gap-4"},[e("div",xn,[e("div",Cn,[e("span",wn,b(c.title),1),e("span",hn,b(c.type),1),e("span",{class:se(["px-2 py-[2px] text-[11px] rounded",{"bg-yellow-100 text-yellow-700":c.status==="draft","bg-emerald-100 text-emerald-700":c.status==="published","bg-gray-200 text-gray-700":c.status==="archived"}])},b(c.status),3),e("span",_n,b(c.doc_date?new Date(c.doc_date).toLocaleDateString():c.created_at?new Date(c.created_at).toLocaleDateString():"—"),1)])]),e("div",Sn,[e("button",{class:"px-2 py-1 bg-amber-500 hover:bg-amber-600 text-white rounded text-xs",onClick:G=>fe(c)},"Edit",8,kn),e("button",{class:"px-2 py-1 bg-red-600 text-white rounded text-xs",onClick:G=>ne(c)},"Delete",8,$n)])]))),128))]),e("div",Vn,[o.value>1?(p(),x("button",{key:0,onClick:g[4]||(g[4]=c=>o.value=o.value-1),class:"px-3 py-1 bg-gray-300 rounded"},"Previous")):I("",!0),e("div",null,"Page "+b(j.value.currentPage)+" of "+b(j.value.totalPages||1),1),o.value<j.value.totalPages?(p(),x("button",{key:1,onClick:g[5]||(g[5]=c=>o.value=o.value+1),class:"px-3 py-1 bg-gray-300 rounded"},"Next")):I("",!0)])]),T(Le,{modelValue:C.value,"onUpdate:modelValue":g[6]||(g[6]=c=>C.value=c),mode:"create",initial:{type:"cbl",title:"",content:"",status:"draft",doc_date:""},onSubmit:S,onClosed:E},null,8,["modelValue"]),T(Le,{modelValue:r.value,"onUpdate:modelValue":g[7]||(g[7]=c=>r.value=c),mode:"edit",initial:a.value||{id:null,type:"cbl",title:"",content:"",status:"draft",doc_date:""},onSubmit:J,onClosed:K},null,8,["modelValue","initial"])])):I("",!0)}},Un={class:"flex items-center gap-1 md:gap-2"},En=["aria-expanded"],In={style:{width:"18px",height:"18px"},viewBox:"0 0 24 24","aria-hidden":"true"},An=["d"],Ln={__name:"ClubRowActions",props:{row:{type:Object,required:!0}},emits:["members","docs","edit","delete","view"],setup(t,{emit:f}){const n=$(!1),h=$(null),d=$(null),V=l=>{if(!n.value)return;const o=h.value,m=d.value;o&&!o.contains(l.target)&&m&&!m.contains(l.target)&&(n.value=!1)};return ge(()=>{document.addEventListener("click",V)}),Oe(()=>{document.removeEventListener("click",V)}),(l,o)=>(p(),x("div",Un,[T(ue,{"icon-path":L(Ye),color:"text-gray-700",label:"View",tooltip:"View Club",size:"sm",onClick:o[0]||(o[0]=m=>l.$emit("view",t.row))},null,8,["icon-path"]),T(ue,{"icon-path":L(qe),color:"text-blue-600",label:"Members",tooltip:"View Members",size:"sm",onClick:o[1]||(o[1]=m=>l.$emit("members",t.row))},null,8,["icon-path"]),T(ue,{"icon-path":L(He),color:"text-indigo-600",label:"Docs",tooltip:"View Documents",size:"sm",onClick:o[2]||(o[2]=m=>l.$emit("docs",t.row))},null,8,["icon-path"]),T(ue,{"icon-path":L(Je),color:"text-emerald-600",label:"Edit",tooltip:"Edit Club",size:"sm",onClick:o[3]||(o[3]=m=>l.$emit("edit",t.row))},null,8,["icon-path"]),T(ue,{"icon-path":L(Qe),color:"text-red-600",label:"Delete",tooltip:"Delete Club",size:"sm",onClick:o[4]||(o[4]=m=>l.$emit("delete",t.row))},null,8,["icon-path"]),e("div",{class:"relative md:hidden",ref_key:"btnRef",ref:d},[e("button",{class:"inline-flex items-center justify-center rounded-xl p-1.5 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-offset-1","aria-expanded":n.value,"aria-haspopup":"menu",title:"More",onClick:o[5]||(o[5]=m=>n.value=!n.value)},[(p(),x("svg",In,[e("path",{d:L(Xe)},null,8,An)]))],8,En),n.value?(p(),x("div",{key:0,ref_key:"menuRef",ref:h,role:"menu",class:"absolute right-0 z-20 mt-1 w-40 overflow-hidden rounded-xl border bg-white shadow-lg"},[e("button",{role:"menuitem",class:"w-full px-3 py-2 text-left text-sm hover:bg-gray-50",onClick:o[6]||(o[6]=m=>{n.value=!1,l.$emit("view",t.row)})}," View Club "),e("button",{role:"menuitem",class:"w-full px-3 py-2 text-left text-sm hover:bg-gray-50",onClick:o[7]||(o[7]=m=>{n.value=!1,l.$emit("members",t.row)})}," View Members "),e("button",{role:"menuitem",class:"w-full px-3 py-2 text-left text-sm hover:bg-gray-50",onClick:o[8]||(o[8]=m=>{n.value=!1,l.$emit("docs",t.row)})}," View Documents "),e("button",{role:"menuitem",class:"w-full px-3 py-2 text-left text-sm hover:bg-gray-50",onClick:o[9]||(o[9]=m=>{n.value=!1,l.$emit("edit",t.row)})}," Edit Club "),e("button",{role:"menuitem",class:"w-full px-3 py-2 text-left text-sm text-red-600 hover:bg-red-50",onClick:o[10]||(o[10]=m=>{n.value=!1,l.$emit("delete",t.row)})}," Delete ")],512)):I("",!0)],512)]))}},On={class:"flex items-center gap-2"},zn={__name:"ClubsOrganizationPage",setup(t){const f=We(),n=Pe(),h=$({page:1,limit:10}),d=async(v={},S=!0)=>{h.value={...h.value,...v},typeof h.value.officer>"u"&&(h.value.officer=!0),await n.fetchAll(h.value,S)};ge(()=>d({page:1,limit:10}));const V=N(()=>({total:n.clubs.total||0,totalPages:n.clubs.totalPages||1,currentPage:n.clubs.currentPage||1,pageSize:n.clubs.pageSize||10,data:n.clubs.data||[]})),l=$(!1),o=$(!1),m=$(null),y=()=>{l.value=!0},A=async v=>{await n.create(v),l.value=!1,await d(h.value,!0)},B=async v=>{await n.fetchById(v.id);const S=n.selectedClub||v;m.value={id:S.id,name:S.name||"",code:S.code||"",category:S.category||"",description:S.description||"",is_active:S.is_active??!0,established_at:S.established_at?String(S.established_at).slice(0,10):"",website:S.website||"",email:S.email||"",phone:S.phone||"",logo:S.logo||"",banner:S.banner||""},o.value=!0},D=async v=>{const{id:S,...E}=v;await n.updateById(S,E),o.value=!1,await d(h.value,!0)},U=async v=>{if(!v?.id)return;(await ie.fire({title:`Delete club "${v.name}"?`,text:"This cannot be undone.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Yes, delete it",cancelButtonText:"Cancel"})).isConfirmed&&(await n.deleteById(v.id),await d(h.value,!0),await ie.fire("Deleted!","The club has been deleted.","success"))},F=$(!1),O=$(!1),R=$(null),P=$(""),j=v=>{R.value=v.id,P.value=v.name||"",F.value=!0},_=v=>{R.value=v.id,P.value=v.name||"",O.value=!0},C=v=>{v?.id&&window.open(`/#/club/${v.id}`,"_self")},r=[{key:"name",label:"Name",sortable:!0,filterable:!0},{key:"code",label:"Code",sortable:!0,filterable:!0},{key:"category",label:"Category",sortable:!0,filterable:!0},{key:"is_active",label:"Active",sortable:!0,formatter:v=>v?"Yes":"No"}],a=async v=>{await d(v)};return(v,S)=>(p(),x(W,null,[T(Ze,null,{default:te(()=>[T(et,null,{default:te(()=>[L(n).error?(p(),ke(ot,{key:0,icon:L(tt),color:"danger"},{default:te(()=>[z(b(L(n).error),1)]),_:1},8,["icon"])):I("",!0),T(at,{icon:L(lt),title:"Clubs",main:""},{default:te(()=>[e("div",On,[L(f).user.role==="admin"?(p(),ke($e,{key:0,icon:L(nt),color:"primary",label:"Add Club",onClick:y},null,8,["icon"])):I("",!0),T($e,{color:"info",label:"Refresh",onClick:S[0]||(S[0]=E=>d({page:1,limit:V.value.pageSize}))})])]),_:1},8,["icon"]),T(st,{columns:r,data:V.value,loading:L(n).isLoading,onQueryChange:a},{"cell-category":te(({value:E})=>[T(Ve,{text:E||"—",tone:"indigo"},null,8,["text"])]),"cell-is_active":te(({value:E})=>[T(Ve,{text:E?"Active":"Inactive",tone:E?"emerald":"gray"},null,8,["text","tone"])]),"cell-actions":te(({row:E})=>[T(Ln,{row:E,onView:C,onMembers:j,onDocs:_,onEdit:B,onDelete:U},null,8,["row"])]),_:1},8,["data","loading"])]),_:1})]),_:1}),T(De,{modelValue:l.value,"onUpdate:modelValue":S[1]||(S[1]=E=>l.value=E),mode:"create",onSubmit:A},null,8,["modelValue"]),T(De,{modelValue:o.value,"onUpdate:modelValue":S[2]||(S[2]=E=>o.value=E),mode:"edit",initial:m.value||{},onSubmit:D},null,8,["modelValue","initial"]),T(hl,{modelValue:F.value,"onUpdate:modelValue":S[3]||(S[3]=E=>F.value=E),"club-id":R.value,"club-name":P.value},null,8,["modelValue","club-id","club-name"]),T(Dn,{modelValue:O.value,"onUpdate:modelValue":S[4]||(S[4]=E=>O.value=E),"club-id":R.value,"club-name":P.value},null,8,["modelValue","club-id","club-name"])],64))}};export{zn as default};
