import{T as y}from"./ToasterComponent.ck4oDp-0.js";import{c as o,a as n,b as p,d as e,e as g,w,f as l,v as u,g as S,n as m,h as f,t as d,i as _,r as x,u as k,o as c}from"./index.DG-D-jlF.js";import{_ as C}from"./logo.Dx3Q79ni.js";import{_ as I}from"./_plugin-vue_export-helper.DlAUqK2U.js";const A={data(){return{email:"",password:"",showPassword:!1,capsOn:!1,captchaA:0,captchaB:0,captchaInput:"",captchaError:"",honeypot:"",_ssoHandled:!1}},computed:{auth(){return k()},captchaAnswer(){return this.captchaA+this.captchaB},captchaValid(){return String(parseInt(this.captchaInput||"NaN",10))===String(this.captchaAnswer)},captchaStateClass(){return this.captchaInput?this.captchaValid?"bg-green-100 text-green-700 border border-green-200":"bg-red-100 text-red-700 border border-red-200":"bg-gray-100 text-gray-400 border border-gray-200"},captchaIconClass(){return this.captchaInput?this.captchaValid?"mdi mdi-check-bold text-xl":"mdi mdi-close-thick text-xl":"mdi mdi-help-circle-outline text-xl"},canSubmit(){return this.email.trim().length>0&&this.password.length>0&&this.captchaValid&&!this.honeypot}},methods:{async onSubmit(){if(!this.honeypot){if(!this.captchaValid){this.captchaError="Incorrect captcha answer.";return}this.captchaError="";try{const i=await this.auth.login(this.email,this.password);if(i?.requiresVerification||this.auth.requiresVerification){this.$refs.toast.showToast("info","Please verify your email before logging in."),this.$router.push({name:"verify-prompt",query:{email:this.email}});return}if(i?.requires2FA)return;this.$refs.toast.showToast("success","Login successful!")}catch(i){this.$refs.toast.showToast("warning",i.message||"Invalid login credentials!"),this.genCaptcha(),this.captchaInput=""}}},forgotPassword(){this.$refs.toast.showToast("info","Please contact support to reset your password.")},detectCaps(i){i.getModifierState&&(this.capsOn=i.getModifierState("CapsLock"))},genCaptcha(){const i=(t,h)=>Math.floor(Math.random()*(h-t+1))+t;this.captchaA=i(10,49),this.captchaB=i(10,49),this.captchaInput="",this.captchaError=""},signInWithSchoolAccount(){try{this.auth.startGoogleLogin()}catch(i){this.$refs.toast.showToast("warning",i.message||"Unable to start Google sign-in")}},tryConsumeSso({suppressToast:i=!1}={}){if(!this._ssoHandled)try{this.auth.consumeSsoFromHash()&&(this._ssoHandled=!0,i||this.$refs.toast?.showToast("success","Signed in with school account"))}catch(t){this._ssoHandled=!0,i||this.$refs.toast?.showToast("warning",t.message||"Google sign-in failed")}}},components:{ToasterComponent:y},created(){this.genCaptcha()},mounted(){this.tryConsumeSso(),this.$nextTick(()=>this.tryConsumeSso({suppressToast:!0}))}},V={class:"min-h-screen relative overflow-hidden"},P={key:0,class:"absolute inset-0 z-50 grid place-items-center bg-black/40 backdrop-blur-md"},T={class:"relative z-10 min-h-screen flex items-center justify-center p-4"},j={class:"w-full max-w-md"},E={class:"group rounded-2xl bg-white/80 backdrop-blur-xl border border-white/40 shadow-2xl ring-1 ring-black/5 hover:ring-black/10 transition"},B={class:"p-6 sm:p-7"},L={class:"relative"},N={class:"space-y-2"},M={class:"relative"},O=["type"],q={key:0,class:"flex items-center gap-2 text-amber-600 text-xs"},U={class:"space-y-2"},D={class:"flex items-center justify-between"},H={class:"flex items-center gap-3"},F={class:"flex-1"},G={class:"w-full rounded-xl border border-gray-300/80 bg-white/70 px-3 py-2.5 text-gray-900 flex items-center justify-between"},z={class:"text-sm select-none"},W={key:0,class:"text-xs text-red-600"},K={class:"flex items-center justify-between"},R={class:"pt-1"},Y=["disabled"],J=["disabled"],Q={class:"text-center text-xs mt-3"},X={class:"px-6 sm:px-7 pb-6"},Z={class:"flex items-center justify-between text-[11px] text-gray-500"};function $(i,t,h,tt,a,r){const b=x("router-link"),v=x("ToasterComponent");return c(),o("div",V,[t[27]||(t[27]=n('<div class="absolute inset-0" data-v-c6209d82><div class="h-full w-full bg-cover bg-center" style="background-image:url(/images/bg.jpg)" data-v-c6209d82></div><div class="absolute inset-0 bg-gradient-to-b from-black/40 via-black/30 to-black/60" data-v-c6209d82></div><div class="absolute inset-0 backdrop-blur-sm" data-v-c6209d82></div><div class="absolute inset-0 bg-[radial-gradient(circle_at_20%_20%,_rgba(255,255,255,.08),_transparent_40%),radial-gradient(circle_at_80%_0,_rgba(255,255,255,.06),_transparent_35%),radial-gradient(circle_at_50%_100%,_rgba(255,255,255,.05),_transparent_45%)]" data-v-c6209d82></div></div>',1)),r.auth.isLoading?(c(),o("div",P,t[10]||(t[10]=[e("div",{class:"loader"},null,-1)]))):p("",!0),e("div",T,[e("div",j,[t[25]||(t[25]=n('<div class="mb-6 text-center" data-v-c6209d82><a href="index.html" class="inline-flex items-center justify-center" data-v-c6209d82><img src="'+C+'" alt="OSAS" class="h-14 w-auto" data-v-c6209d82></a><h1 class="mt-4 text-2xl font-extrabold tracking-wide text-white" data-v-c6209d82> Office of Student Affairs &amp; Services </h1><p class="mt-1 text-primary-text/90 text-sm" data-v-c6209d82>Serve. Support. Empower.</p></div>',1)),e("div",E,[e("div",B,[t[23]||(t[23]=n('<div class="mb-5 text-center" data-v-c6209d82><div class="inline-flex items-center gap-2" data-v-c6209d82><span class="inline-grid h-8 w-8 place-items-center rounded-full bg-primary/10" data-v-c6209d82><i class="mdi mdi-account-key text-primary text-xl" data-v-c6209d82></i></span><h2 class="text-lg font-bold text-gray-900" data-v-c6209d82>Sign In</h2></div><p class="text-xs text-gray-500 mt-2" data-v-c6209d82>Use your email and password</p></div>',1)),e("form",{onSubmit:t[9]||(t[9]=w((...s)=>r.onSubmit&&r.onSubmit(...s),["prevent"])),class:"space-y-4",novalidate:""},[l(e("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=s=>a.honeypot=s),class:"hidden",tabindex:"-1",autocomplete:"off","aria-hidden":"true"},null,512),[[u,a.honeypot]]),e("div",L,[t[11]||(t[11]=e("label",{class:"sr-only"},"Email",-1)),t[12]||(t[12]=e("div",{class:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3"},[e("i",{class:"mdi mdi-email-outline text-gray-400 text-xl"})],-1)),l(e("input",{class:"w-full rounded-xl border border-gray-300/80 bg-white/70 pl-11 pr-3 py-2.5 text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-4 focus:ring-primary/20 focus:border-primary transition disabled:opacity-60",type:"email",required:"",placeholder:"Email","onUpdate:modelValue":t[1]||(t[1]=s=>a.email=s),autocomplete:"email"},null,512),[[u,a.email,void 0,{trim:!0}]])]),e("div",N,[e("div",M,[t[13]||(t[13]=e("label",{class:"sr-only"},"Password",-1)),t[14]||(t[14]=e("div",{class:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3"},[e("i",{class:"mdi mdi-lock-outline text-gray-400 text-xl"})],-1)),l(e("input",{type:a.showPassword?"text":"password",class:"w-full rounded-xl border border-gray-300/80 bg-white/70 pl-11 pr-11 py-2.5 text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-4 focus:ring-primary/20 focus:border-primary transition disabled:opacity-60",required:"",placeholder:"Password","onUpdate:modelValue":t[2]||(t[2]=s=>a.password=s),onKeyup:t[3]||(t[3]=s=>r.detectCaps(s)),autocomplete:"current-password"},null,40,O),[[S,a.password]]),e("button",{type:"button",onClick:t[4]||(t[4]=s=>a.showPassword=!a.showPassword),class:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600"},[e("i",{class:m(a.showPassword?"mdi mdi-eye-off-outline":"mdi mdi-eye-outline")},null,2)])]),a.capsOn?(c(),o("div",q,t[15]||(t[15]=[e("i",{class:"mdi mdi-alert"},null,-1),e("span",null,"Caps Lock is ON",-1)]))):p("",!0)]),e("div",U,[e("div",D,[t[17]||(t[17]=e("label",{class:"text-sm font-medium text-gray-700"},"Captcha",-1)),e("button",{type:"button",onClick:t[5]||(t[5]=(...s)=>r.genCaptcha&&r.genCaptcha(...s)),class:"text-xs text-primary hover:underline inline-flex items-center gap-1"},t[16]||(t[16]=[e("i",{class:"mdi mdi-refresh"},null,-1),f(" Refresh ",-1)]))]),e("div",H,[e("div",F,[e("div",G,[e("span",z,d(a.captchaA)+" + "+d(a.captchaB)+" =",1),l(e("input",{class:"ml-3 w-24 text-right bg-transparent focus:outline-none",inputmode:"numeric",pattern:"[0-9]*",placeholder:"Answer","onUpdate:modelValue":t[6]||(t[6]=s=>a.captchaInput=s)},null,512),[[u,a.captchaInput,void 0,{trim:!0}]])])]),e("span",{class:m(["inline-flex h-9 w-9 items-center justify-center rounded-lg",r.captchaStateClass])},[e("i",{class:m(r.captchaIconClass)},null,2)],2)]),a.captchaError?(c(),o("p",W,d(a.captchaError),1)):p("",!0)]),e("div",K,[t[18]||(t[18]=e("span",{class:"text-sm text-gray-700"}," ",-1)),e("button",{type:"button",class:"text-sm text-primary hover:underline",onClick:t[7]||(t[7]=(...s)=>r.forgotPassword&&r.forgotPassword(...s))}," Forgot password? ")]),e("div",R,[e("button",{class:"w-full py-2.5 px-4 rounded-xl bg-primary text-white font-semibold tracking-wide shadow-md hover:shadow-lg hover:bg-tertiary transition disabled:opacity-60 disabled:cursor-not-allowed",type:"submit",disabled:!r.canSubmit||r.auth.isLoading},t[19]||(t[19]=[e("span",{class:"inline-flex items-center justify-center gap-2"},[e("i",{class:"mdi mdi-login-variant"}),e("span",null,"Log In")],-1)]),8,Y)]),t[22]||(t[22]=n('<div class="relative my-4" data-v-c6209d82><div class="absolute inset-0 flex items-center" data-v-c6209d82><span class="w-full border-t border-gray-200" data-v-c6209d82></span></div><div class="relative flex justify-center text-xs" data-v-c6209d82><span class="bg-white/80 px-2 text-gray-500" data-v-c6209d82>or continue with</span></div></div>',1)),e("div",null,[e("button",{type:"button",class:"w-full py-2.5 px-4 rounded-xl bg-white text-gray-800 font-semibold tracking-wide border border-gray-300/80 shadow-sm hover:shadow-md hover:bg-gray-50 transition disabled:opacity-60",disabled:r.auth.isLoading,onClick:t[8]||(t[8]=(...s)=>r.signInWithSchoolAccount&&r.signInWithSchoolAccount(...s))},t[20]||(t[20]=[e("span",{class:"inline-flex items-center justify-center gap-2"},[e("i",{class:"mdi mdi-google"}),e("span",null,"Sign in with School Account"),e("span",{class:"text-xs text-gray-500"},"(knp.edu.ph)")],-1)]),8,J)]),e("div",Q,[g(b,{to:"/register",class:"text-primary hover:underline"},{default:_(()=>t[21]||(t[21]=[f(" Don't have an account? ",-1),e("span",{class:"font-semibold"},"Register",-1)])),_:1,__:[21]})])],32)]),e("div",X,[e("div",Z,[t[24]||(t[24]=e("span",null,"OSAS Kiosk v1.0",-1)),e("span",null,"© "+d(new Date().getFullYear())+" Student Services",1)])])]),t[26]||(t[26]=e("div",{class:"mt-6 text-center text-xs text-gray-300"},[e("p",null,"By signing in, you agree to our Student Portal Guidelines.")],-1))])]),g(v,{ref:"toast"},null,512)])}const rt=I(A,[["render",$],["__scopeId","data-v-c6209d82"]]);export{rt as default};
