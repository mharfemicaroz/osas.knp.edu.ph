import{M as c,N as I,r as i}from"./index.DIg0rV2V.js";const o={async create(e){return(await c.post("/clubs",e)).data},async getById(e){return(await c.get(`/clubs/${e}`)).data},async updateById(e,a){return(await c.put(`/clubs/${e}`,a)).data},async delete(e){return(await c.delete(`/clubs/${e}`)).data},async list(e){return(await c.get("/clubs",{params:e})).data},async addUsers(e,a){return(await c.post(`/clubs/${e}/users`,{userIds:a})).data},async removeUser(e,a){return(await c.delete(`/clubs/${e}/users/${a}`)).data},async updateMember(e,a,u){const{data:d}=await c.patch(`/clubs/${e}/users/${a}`,u);return d}},$=I("club",()=>{const e=i({total:0,totalPages:1,currentPage:1,pageSize:10,data:[]}),a=i(!1),u=i(null),d=i(!1),n=i(null),p=async(t={},l=!1)=>{if(u.value=null,!(!l&&d.value))try{a.value=!0;const s=await o.list(t);Object.assign(e.value,{total:s.total||0,totalPages:s.totalPages||1,currentPage:t.page||1,pageSize:t.limit||10,data:s.data||[]}),d.value=!0}catch(s){u.value=s?.response?.message||"Failed to fetch clubs"}finally{a.value=!1}},f=async t=>{u.value=null;try{a.value=!0;const l=await o.getById(t);n.value=l}catch(l){u.value=l?.response?.message||"Failed to fetch club"}finally{a.value=!1}},y=async t=>{u.value=null;try{a.value=!0;const l=await o.create(t);e.value.data.push(l),e.value.total+=1}catch(l){u.value=l?.response?.message||"Failed to create club"}finally{a.value=!1}},b=async(t,l)=>{u.value=null;try{a.value=!0;const s=await o.updateById(t,l),r=e.value.data.findIndex(v=>v.id===t);r!==-1&&(e.value.data[r]=s),n.value?.id===t&&(n.value=s)}catch(s){u.value=s?.response?.message||"Failed to update club"}finally{a.value=!1}},g=async t=>{u.value=null;try{a.value=!0,await o.delete(t),e.value.data=e.value.data.filter(l=>l.id!==t),e.value.total-=1,n.value?.id===t&&(n.value=null)}catch(l){u.value=l?.response?.message||"Failed to delete club"}finally{a.value=!1}},m=async(t,l)=>{u.value=null;try{a.value=!0;const s=await o.addUsers(t,l),r=e.value.data.findIndex(v=>v.id===t);r!==-1&&(e.value.data[r]=s),n.value?.id===t&&(n.value=s)}catch(s){u.value=s?.response?.message||"Failed to add users to club"}finally{a.value=!1}},w=async(t,l)=>{u.value=null;try{a.value=!0,await o.removeUser(t,l),n.value?.id===t&&Array.isArray(n.value.users)&&(n.value.users=n.value.users.filter(r=>r.id!==l));const s=e.value.data.findIndex(r=>r.id===t);s!==-1&&Array.isArray(e.value.data[s].users)&&(e.value.data[s].users=e.value.data[s].users.filter(r=>r.id!==l))}catch(s){u.value=s?.response?.message||"Failed to remove user from club"}finally{a.value=!1}};async function h(t,l,s){try{a.value=!0;const r=await o.updateMember(t,l,{status:s});n.value=r}catch(r){throw u.value=r?.response?.data?.message||"Failed to update member status",r}finally{a.value=!1}}async function F(t,l,s){try{a.value=!0;const r=await o.updateMember(t,l,{role:s});n.value=r}catch(r){throw u.value=r?.response?.data?.message||"Failed to update member role",r}finally{a.value=!1}}return{clubs:e,selectedClub:n,isLoading:a,error:u,isLoaded:d,fetchAll:p,fetchById:f,create:y,updateById:b,deleteById:g,addUsersToClub:m,removeUserFromClub:w,updateMemberRole:F,updateMemberStatus:h,resetStore:()=>{e.value={total:0,totalPages:1,currentPage:1,pageSize:10,data:[]},n.value=null,d.value=!1,a.value=!1,u.value=null}}});export{$ as u};
