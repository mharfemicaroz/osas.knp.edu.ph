import{r as c,c as u,o as C,A as V,l as S,q as p,f as $,e as t,a as g,h as _,O as y,t as q,g as B,k as h}from"./index.BnmwlPkf.js";import{_ as G,a as T}from"./SectionMain.D81BgA1-.js";import{i as E,a as O,b as W,F}from"./index.CMbS6ORv.js";import{i as j}from"./index.Bn0EGYE8.js";import{u as J}from"./activityDesign.BZuSxOyh.js";import{u as H}from"./utilizationRequest.DwLeDHAo.js";import{u as I}from"./annualPlan.CdGgE31k.js";import{_ as Y}from"./_plugin-vue_export-helper.DlAUqK2U.js";import"./activityDesignService.BMqdURYS.js";import"./utilizationRequestService.B94mKcQ2.js";import"./liquidationFundService.CgDeB2MV.js";import"./ToasterComponent.DnGRu12L.js";const Z={class:"w-full space-y-4"},K={class:"flex items-center justify-between flex-wrap gap-3"},Q={class:"flex items-center gap-2"},X={class:"inline-flex items-center gap-2 px-3 py-1.5 rounded-full bg-blue-50 text-blue-700 border border-blue-200"},ee={class:"inline-flex items-center gap-2 px-3 py-1.5 rounded-full bg-emerald-50 text-emerald-700 border border-emerald-200"},te={class:"inline-flex items-center gap-2 px-3 py-1.5 rounded-full bg-amber-50 text-amber-700 border border-amber-200"},re={key:0,class:"w-full p-6 text-center rounded-xl border border-gray-200 bg-white shadow-sm"},ae={key:1,class:"w-full p-4 rounded-xl border border-red-200 bg-red-50 text-red-700"},se={key:2,class:"w-full rounded-xl overflow-hidden border border-gray-200 bg-white shadow"},oe="Asia/Manila",ie={__name:"CalendarActivityPage",setup(le){const l=J(),n=H(),d=I(),m=c(!0),b=c(!0),f=c(!0),D=u(()=>l.isLoading||n.isLoading||d.isLoading),w=u(()=>l.error||n.error||d.error),P={status:"approved",limit:1e3,officer:"true",order:"ASC",sort:"date_of_implementation"};C(async()=>{await Promise.allSettled([l.fetchAll(P,!0),n.fetchAll({status:"approved",limit:1e3,officer:"true",order:"ASC",sort:"start_at"},!0),d.fetchAll({status:"approved",limit:1e3,officer:"true",order:"ASC",sort:"approved_at"},!0)])});function L(a,e=[]){try{return JSON.parse(a||"[]")}catch{return e}}function v(a){return a==="AD"?{backgroundColor:"#2563eb",borderColor:"#1d4ed8"}:a==="UR"?{backgroundColor:"#059669",borderColor:"#047857"}:{backgroundColor:"#d97706",borderColor:"#b45309"}}const U=u(()=>{const a=[];if(m.value)for(const e of l.items.data){const r=e?.date_of_implementation||e?.approved_at||e?.created_at;if(!r)continue;const s=e?.club?.name?` • ${e.club.name}`:"",{backgroundColor:o,borderColor:i}=v("AD");a.push({id:`AD-${e.id}`,title:`Activity: ${e.name_of_activity||e.reference_code}${s}`,start:r,allDay:!0,extendedProps:{type:"Activity Design",ref:e.reference_code,club:e?.club},backgroundColor:o,borderColor:i})}if(b.value)for(const e of n.items.data){const r=e?.start_at||e?.approved_at||e?.created_at,s=e?.end_at||e?.start_at||e?.approved_at;if(!r)continue;const o=Array.isArray(e?.facilities)?e.facilities:L(e?.facilities),i=o?.length?` • ${o.join(", ")}`:"",x=e?.activity_design?.name_of_activity?` • ${e.activity_design.name_of_activity}`:"",{backgroundColor:N,borderColor:R}=v("UR");a.push({id:`UR-${e.id}`,title:`Utilization${x}${i}`,start:r,end:s,allDay:!e?.start_at||!e?.end_at,extendedProps:{type:"Utilization",ref:e.reference_code,facilities:o},backgroundColor:N,borderColor:R})}if(f.value)for(const e of d.items.data){const r=e?.approved_at||e?.submitted_at||e?.created_at;if(!r)continue;const s=e?.club?.name?` • ${e.club.name}`:"",o=e?.school_year?` • SY ${e.school_year}`:"",{backgroundColor:i,borderColor:x}=v("AP");a.push({id:`AP-${e.id}`,title:`Annual Plan Approved${s}${o}`,start:r,allDay:!0,extendedProps:{type:"Annual Plan",ref:e.reference_code},backgroundColor:i,borderColor:x})}return a});function M(a){const e=!!a.el.closest(".fc-list");e?(a.el.classList.remove("text-white"),a.el.classList.add("text-gray-900")):a.el.classList.add("rounded-md","shadow-sm","text-dark");const r=document.createElement("span");if(r.textContent=a.event.extendedProps?.type||"",e){r.className="mr-2 inline-block px-1.5 py-0.5 text-[10px] font-semibold rounded bg-slate-200 text-slate-700";const s=a.el.querySelector(".fc-list-event-title");(s?.querySelector("a")||s)?.prepend(r)}else r.className="px-1.5 py-0.5 text-[10px] font-semibold rounded mr-1 align-middle bg-white/20 text-white",a.el.prepend(r)}const A=c(!1),k=()=>{A.value=window.innerWidth<640};C(()=>{k(),window.addEventListener("resize",k)});const z=u(()=>({plugins:[E,O,j,W],initialView:"dayGridMonth",headerToolbar:A.value?{left:"prev,next",center:"title",right:"dayGridMonth"}:{left:"prev,next today",center:"title",right:"dayGridMonth,timeGridWeek,timeGridDay,listWeek"},height:"auto",handleWindowResize:!0,stickyHeaderDates:!0,dayMaxEvents:3,navLinks:!0,eventTimeFormat:{hour:"2-digit",minute:"2-digit",meridiem:!0},timeZone:oe,events:U.value,eventDidMount:M}));return(a,e)=>(p(),V(G,null,{default:S(()=>[$(T,null,{default:S(()=>[t("div",Z,[t("div",K,[e[6]||(e[6]=t("h1",{class:"text-xl font-semibold"},"Campus Activities Calendar",-1)),t("div",Q,[t("label",X,[_(t("input",{type:"checkbox","onUpdate:modelValue":e[0]||(e[0]=r=>m.value=r),class:"accent-blue-600"},null,512),[[y,m.value]]),e[3]||(e[3]=t("span",{class:"text-sm"},"Activity Designs",-1))]),t("label",ee,[_(t("input",{type:"checkbox","onUpdate:modelValue":e[1]||(e[1]=r=>b.value=r),class:"accent-emerald-600"},null,512),[[y,b.value]]),e[4]||(e[4]=t("span",{class:"text-sm"},"Utilizations",-1))]),t("label",te,[_(t("input",{type:"checkbox","onUpdate:modelValue":e[2]||(e[2]=r=>f.value=r),class:"accent-amber-600"},null,512),[[y,f.value]]),e[5]||(e[5]=t("span",{class:"text-sm"},"Annual Plans",-1))])])]),D.value?(p(),g("div",re," Loading approved events… ")):w.value?(p(),g("div",ae,q(w.value),1)):(p(),g("div",se,[$(B(F),{options:z.value},null,8,["options"])])),e[7]||(e[7]=t("div",{class:"grid grid-cols-1 md:grid-cols-3 gap-3"},[t("div",{class:"p-4 rounded-xl border bg-white shadow-sm border-blue-200"},[t("div",{class:"text-xs uppercase tracking-wide text-blue-600 mb-1"},"Legend"),t("div",{class:"flex items-center gap-2 text-sm"},[t("span",{class:"w-3 h-3 rounded-sm bg-blue-600"}),h(" Activity Design (approved)")])]),t("div",{class:"p-4 rounded-xl border bg-white shadow-sm border-emerald-200"},[t("div",{class:"text-xs uppercase tracking-wide text-emerald-600 mb-1"},"Legend"),t("div",{class:"flex items-center gap-2 text-sm"},[t("span",{class:"w-3 h-3 rounded-sm bg-emerald-600"}),h(" Utilization Request (approved)")])]),t("div",{class:"p-4 rounded-xl border bg-white shadow-sm border-amber-200"},[t("div",{class:"text-xs uppercase tracking-wide text-amber-600 mb-1"},"Legend"),t("div",{class:"flex items-center gap-2 text-sm"},[t("span",{class:"w-3 h-3 rounded-sm bg-amber-600"}),h(" Annual Plan (approved)")])])],-1))])]),_:1})]),_:1}))}},ye=Y(ie,[["__scopeId","data-v-32e68182"]]);export{ye as default};
