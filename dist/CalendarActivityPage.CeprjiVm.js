import{r as T,c as C,o as W,A as Y,l as M,q as S,f as L,e as l,a as E,h as I,P as N,t as J,g as K,k as R}from"./index.6qizARKY.js";import{_ as X,a as Z}from"./SectionMain.DpEcpuJe.js";import{D as Q,m as $,g as k,y as n,S as ee,V as te,C as P,s as ae,i as se,f as V,a as re,b as ne,N as ie,c as le,d as U,B as G,e as oe,h as F,j as de,_ as j,E as ce,k as B,l as ue,n as H,o as fe,p as me,q as pe,r as _,t as ge,u as ve,v as ye,F as he}from"./index.BMPgyHgS.js";import{u as be}from"./activityDesign.BZvN1bMC.js";import{u as xe}from"./utilizationRequest.CMwe97mx.js";import{u as we}from"./annualPlan.C2HXxaVu.js";import{_ as De}from"./_plugin-vue_export-helper.DlAUqK2U.js";import"./ToasterComponent.C0XXa3Ql.js";class Ce extends G{constructor(){super(...arguments),this.state={textId:k()}}render(){let{theme:t,dateEnv:a,options:r,viewApi:i}=this.context,{cellId:o,dayDate:u,todayRange:m}=this.props,{textId:d}=this.state,p=oe(u,m),g=r.listDayFormat?a.format(u,r.listDayFormat):"",v=r.listDaySideFormat?a.format(u,r.listDaySideFormat):"",y=Object.assign({date:a.toDate(u),view:i,textId:d,text:g,sideText:v,navLinkAttrs:F(this.context,u),sideNavLinkAttrs:F(this.context,u,"day",!1)},p);return n(P,{elTag:"tr",elClasses:["fc-list-day",...de(p,t)],elAttrs:{"data-date":V(u)},renderProps:y,generatorName:"dayHeaderContent",customGenerator:r.dayHeaderContent,defaultGenerator:Se,classNameGenerator:r.dayHeaderClassNames,didMount:r.dayHeaderDidMount,willUnmount:r.dayHeaderWillUnmount},h=>n("th",{scope:"colgroup",colSpan:3,id:o,"aria-labelledby":d},n(h,{elTag:"div",elClasses:["fc-list-day-cushion",t.getClass("tableCellShaded")]})))}}function Se(s){return n(j,null,s.text&&n("a",Object.assign({id:s.textId,className:"fc-list-day-text"},s.navLinkAttrs),s.text),s.sideText&&n("a",Object.assign({"aria-hidden":!0,className:"fc-list-day-side-text"},s.sideNavLinkAttrs),s.sideText))}const _e=B({hour:"numeric",minute:"2-digit",meridiem:"short"});class ke extends G{render(){let{props:t,context:a}=this,{options:r}=a,{seg:i,timeHeaderId:o,eventHeaderId:u,dateHeaderId:m}=t,d=r.eventTimeFormat||_e;return n(ce,Object.assign({},t,{elTag:"tr",elClasses:["fc-list-event",i.eventRange.def.url&&"fc-event-forced-url"],defaultGenerator:()=>Ae(i,a),seg:i,timeText:"",disableDragging:!0,disableResizing:!0}),(p,g)=>n(j,null,Te(i,d,a,o,m),n("td",{"aria-hidden":!0,className:"fc-list-event-graphic"},n("span",{className:"fc-list-event-dot",style:{borderColor:g.borderColor||g.backgroundColor}})),n(p,{elTag:"td",elClasses:["fc-list-event-title"],elAttrs:{headers:`${u} ${m}`}})))}}function Ae(s,t){let a=fe(s,t);return n("a",Object.assign({},a),s.eventRange.def.title)}function Te(s,t,a,r,i){let{options:o}=a;if(o.displayEventTime!==!1){let u=s.eventRange.def,m=s.eventRange.instance,d=!1,p;if(u.allDay?d=!0:ue(s.eventRange.range)?s.isStart?p=H(s,t,a,null,null,m.range.start,s.end):s.isEnd?p=H(s,t,a,null,null,s.start,m.range.end):d=!0:p=H(s,t,a),d){let g={text:a.options.allDayText,view:a.viewApi};return n(P,{elTag:"td",elClasses:["fc-list-event-time"],elAttrs:{headers:`${r} ${i}`},renderProps:g,generatorName:"allDayContent",customGenerator:o.allDayContent,defaultGenerator:Ee,classNameGenerator:o.allDayClassNames,didMount:o.allDayDidMount,willUnmount:o.allDayWillUnmount})}return n("td",{className:"fc-list-event-time"},p)}return null}function Ee(s){return s.text}class Ie extends Q{constructor(){super(...arguments),this.computeDateVars=$(Re),this.eventStoreToSegs=$(this._eventStoreToSegs),this.state={timeHeaderId:k(),eventHeaderId:k(),dateHeaderIdRoot:k()},this.setRootEl=t=>{t?this.context.registerInteractiveComponent(this,{el:t}):this.context.unregisterInteractiveComponent(this)}}render(){let{props:t,context:a}=this,{dayDates:r,dayRanges:i}=this.computeDateVars(t.dateProfile),o=this.eventStoreToSegs(t.eventStore,t.eventUiBases,i);return n(te,{elRef:this.setRootEl,elClasses:["fc-list",a.theme.getClass("table"),a.options.stickyHeaderDates!==!1?"fc-list-sticky":""],viewSpec:a.viewSpec},n(ee,{liquid:!t.isHeightAuto,overflowX:t.isHeightAuto?"visible":"hidden",overflowY:t.isHeightAuto?"visible":"auto"},o.length>0?this.renderSegList(o,r):this.renderEmptyMessage()))}renderEmptyMessage(){let{options:t,viewApi:a}=this.context,r={text:t.noEventsText,view:a};return n(P,{elTag:"div",elClasses:["fc-list-empty"],renderProps:r,generatorName:"noEventsContent",customGenerator:t.noEventsContent,defaultGenerator:Ne,classNameGenerator:t.noEventsClassNames,didMount:t.noEventsDidMount,willUnmount:t.noEventsWillUnmount},i=>n(i,{elTag:"div",elClasses:["fc-list-empty-cushion"]}))}renderSegList(t,a){let{theme:r,options:i}=this.context,{timeHeaderId:o,eventHeaderId:u,dateHeaderIdRoot:m}=this.state,d=He(t);return n(ie,{unit:"day"},(p,g)=>{let v=[];for(let y=0;y<d.length;y+=1){let h=d[y];if(h){let w=V(a[y]),c=m+"-"+w;v.push(n(Ce,{key:w,cellId:c,dayDate:a[y],todayRange:g})),h=re(h,i.eventOrder);for(let e of h)v.push(n(ke,Object.assign({key:w+":"+e.eventRange.instance.instanceId,seg:e,isDragging:!1,isResizing:!1,isDateSelecting:!1,isSelected:!1,timeHeaderId:o,eventHeaderId:u,dateHeaderId:c},ne(e,g,p))))}}return n("table",{className:"fc-list-table "+r.getClass("table")},n("thead",null,n("tr",null,n("th",{scope:"col",id:o},i.timeHint),n("th",{scope:"col","aria-hidden":!0}),n("th",{scope:"col",id:u},i.eventHint))),n("tbody",null,v))})}_eventStoreToSegs(t,a,r){return this.eventRangesToSegs(ae(t,a,this.props.dateProfile.activeRange,this.context.options.nextDayThreshold).fg,r)}eventRangesToSegs(t,a){let r=[];for(let i of t)r.push(...this.eventRangeToSegs(i,a));return r}eventRangeToSegs(t,a){let{dateEnv:r}=this.context,{nextDayThreshold:i}=this.context.options,o=t.range,u=t.def.allDay,m,d,p,g=[];for(m=0;m<a.length;m+=1)if(d=se(o,a[m]),d&&(p={component:this,eventRange:t,start:d.start,end:d.end,isStart:t.isStart&&d.start.valueOf()===o.start.valueOf(),isEnd:t.isEnd&&d.end.valueOf()===o.end.valueOf(),dayIndex:m},g.push(p),!p.isEnd&&!u&&m+1<a.length&&o.end<r.add(a[m+1].start,i))){p.end=o.end,p.isEnd=!0;break}return g}}function Ne(s){return s.text}function Re(s){let t=le(s.renderRange.start),a=s.renderRange.end,r=[],i=[];for(;t<a;)r.push(t),i.push({start:t,end:U(t,1)}),t=U(t,1);return{dayDates:r,dayRanges:i}}function He(s){let t=[],a,r;for(a=0;a<s.length;a+=1)r=s[a],(t[r.dayIndex]||(t[r.dayIndex]=[])).push(r);return t}var Pe=':root{--fc-list-event-dot-width:10px;--fc-list-event-hover-bg-color:#f5f5f5}.fc-theme-standard .fc-list{border:1px solid var(--fc-border-color)}.fc .fc-list-empty{align-items:center;background-color:var(--fc-neutral-bg-color);display:flex;height:100%;justify-content:center}.fc .fc-list-empty-cushion{margin:5em 0}.fc .fc-list-table{border-style:hidden;width:100%}.fc .fc-list-table tr>*{border-left:0;border-right:0}.fc .fc-list-sticky .fc-list-day>*{background:var(--fc-page-bg-color);position:sticky;top:0}.fc .fc-list-table thead{left:-10000px;position:absolute}.fc .fc-list-table tbody>tr:first-child th{border-top:0}.fc .fc-list-table th{padding:0}.fc .fc-list-day-cushion,.fc .fc-list-table td{padding:8px 14px}.fc .fc-list-day-cushion:after{clear:both;content:"";display:table}.fc-theme-standard .fc-list-day-cushion{background-color:var(--fc-neutral-bg-color)}.fc-direction-ltr .fc-list-day-text,.fc-direction-rtl .fc-list-day-side-text{float:left}.fc-direction-ltr .fc-list-day-side-text,.fc-direction-rtl .fc-list-day-text{float:right}.fc-direction-ltr .fc-list-table .fc-list-event-graphic{padding-right:0}.fc-direction-rtl .fc-list-table .fc-list-event-graphic{padding-left:0}.fc .fc-list-event.fc-event-forced-url{cursor:pointer}.fc .fc-list-event:hover td{background-color:var(--fc-list-event-hover-bg-color)}.fc .fc-list-event-graphic,.fc .fc-list-event-time{white-space:nowrap;width:1px}.fc .fc-list-event-dot{border:calc(var(--fc-list-event-dot-width)/2) solid var(--fc-event-border-color);border-radius:calc(var(--fc-list-event-dot-width)/2);box-sizing:content-box;display:inline-block;height:0;width:0}.fc .fc-list-event-title a{color:inherit;text-decoration:none}.fc .fc-list-event.fc-event-forced-url:hover a{text-decoration:underline}';me(Pe);const Me={listDayFormat:O,listDaySideFormat:O,noEventsClassNames:_,noEventsContent:_,noEventsDidMount:_,noEventsWillUnmount:_};function O(s){return s===!1?null:B(s)}var Le=pe({name:"@fullcalendar/list",optionRefiners:Me,views:{list:{component:Ie,buttonTextKey:"list",listDayFormat:{month:"long",day:"numeric",year:"numeric"}},listDay:{type:"list",duration:{days:1},listDayFormat:{weekday:"long"}},listWeek:{type:"list",duration:{weeks:1},listDayFormat:{weekday:"long"},listDaySideFormat:{month:"long",day:"numeric",year:"numeric"}},listMonth:{type:"list",duration:{month:1},listDaySideFormat:{weekday:"long"}},listYear:{type:"list",duration:{year:1},listDaySideFormat:{weekday:"long"}}}});const $e={class:"w-full space-y-4"},Ue={class:"flex items-center justify-between flex-wrap gap-3"},Fe={class:"flex items-center gap-2"},Oe={class:"inline-flex items-center gap-2 px-3 py-1.5 rounded-full bg-blue-50 text-blue-700 border border-blue-200"},Ve={class:"inline-flex items-center gap-2 px-3 py-1.5 rounded-full bg-emerald-50 text-emerald-700 border border-emerald-200"},Ge={class:"inline-flex items-center gap-2 px-3 py-1.5 rounded-full bg-amber-50 text-amber-700 border border-amber-200"},je={key:0,class:"w-full p-6 text-center rounded-xl border border-gray-200 bg-white shadow-sm"},Be={key:1,class:"w-full p-4 rounded-xl border border-red-200 bg-red-50 text-red-700"},ze={key:2,class:"w-full rounded-xl overflow-hidden border border-gray-200 bg-white shadow"},qe="Asia/Manila",We={__name:"CalendarActivityPage",setup(s){const t=be(),a=xe(),r=we(),i=T(!0),o=T(!0),u=T(!0),m=C(()=>t.isLoading||a.isLoading||r.isLoading),d=C(()=>t.error||a.error||r.error),p={status:"approved",limit:1e3,officer:"true",order:"ASC",sort:"date_of_implementation"};W(async()=>{await Promise.allSettled([t.fetchAll(p,!0),a.fetchAll({status:"approved",limit:1e3,officer:"true",order:"ASC",sort:"start_at"},!0),r.fetchAll({status:"approved",limit:1e3,officer:"true",order:"ASC",sort:"approved_at"},!0)])});function g(c,e=[]){try{return JSON.parse(c||"[]")}catch{return e}}function v(c){return c==="AD"?{backgroundColor:"#2563eb",borderColor:"#1d4ed8"}:c==="UR"?{backgroundColor:"#059669",borderColor:"#047857"}:{backgroundColor:"#d97706",borderColor:"#b45309"}}const y=C(()=>{const c=[];if(i.value)for(const e of t.items.data){const f=e?.date_of_implementation||e?.approved_at||e?.created_at;if(!f)continue;const b=e?.club?.name?` • ${e.club.name}`:"",{backgroundColor:x,borderColor:D}=v("AD");c.push({id:`AD-${e.id}`,title:`Activity: ${e.name_of_activity||e.reference_code}${b}`,start:f,allDay:!0,extendedProps:{type:"Activity Design",ref:e.reference_code,club:e?.club},backgroundColor:x,borderColor:D})}if(o.value)for(const e of a.items.data){const f=e?.start_at||e?.approved_at||e?.created_at,b=e?.end_at||e?.start_at||e?.approved_at;if(!f)continue;const x=Array.isArray(e?.facilities)?e.facilities:g(e?.facilities),D=x?.length?` • ${x.join(", ")}`:"",A=e?.activity_design?.name_of_activity?` • ${e.activity_design.name_of_activity}`:"",{backgroundColor:z,borderColor:q}=v("UR");c.push({id:`UR-${e.id}`,title:`Utilization${A}${D}`,start:f,end:b,allDay:!e?.start_at||!e?.end_at,extendedProps:{type:"Utilization",ref:e.reference_code,facilities:x},backgroundColor:z,borderColor:q})}if(u.value)for(const e of r.items.data){const f=e?.approved_at||e?.submitted_at||e?.created_at;if(!f)continue;const b=e?.club?.name?` • ${e.club.name}`:"",x=e?.school_year?` • SY ${e.school_year}`:"",{backgroundColor:D,borderColor:A}=v("AP");c.push({id:`AP-${e.id}`,title:`Annual Plan Approved${b}${x}`,start:f,allDay:!0,extendedProps:{type:"Annual Plan",ref:e.reference_code},backgroundColor:D,borderColor:A})}return c});function h(c){const e=!!c.el.closest(".fc-list");e?(c.el.classList.remove("text-white"),c.el.classList.add("text-gray-900")):c.el.classList.add("rounded-md","shadow-sm","text-white");const f=document.createElement("span");if(f.textContent=c.event.extendedProps?.type||"",e){f.className="mr-2 inline-block px-1.5 py-0.5 text-[10px] font-semibold rounded bg-slate-200 text-slate-700";const b=c.el.querySelector(".fc-list-event-title");(b?.querySelector("a")||b)?.prepend(f)}else f.className="px-1.5 py-0.5 text-[10px] font-semibold rounded mr-1 align-middle bg-white/20 text-white",c.el.prepend(f)}const w=C(()=>({plugins:[ge,ve,Le,ye],initialView:"dayGridMonth",headerToolbar:{left:"prev,next today",center:"title",right:"dayGridMonth,timeGridWeek,timeGridDay,listWeek"},height:"auto",stickyHeaderDates:!0,dayMaxEvents:3,navLinks:!0,eventTimeFormat:{hour:"2-digit",minute:"2-digit",meridiem:!0},timeZone:qe,events:y.value,eventDidMount:h}));return(c,e)=>(S(),Y(X,null,{default:M(()=>[L(Z,null,{default:M(()=>[l("div",$e,[l("div",Ue,[e[6]||(e[6]=l("h1",{class:"text-xl font-semibold"},"Campus Activities Calendar",-1)),l("div",Fe,[l("label",Oe,[I(l("input",{type:"checkbox","onUpdate:modelValue":e[0]||(e[0]=f=>i.value=f),class:"accent-blue-600"},null,512),[[N,i.value]]),e[3]||(e[3]=l("span",{class:"text-sm"},"Activity Designs",-1))]),l("label",Ve,[I(l("input",{type:"checkbox","onUpdate:modelValue":e[1]||(e[1]=f=>o.value=f),class:"accent-emerald-600"},null,512),[[N,o.value]]),e[4]||(e[4]=l("span",{class:"text-sm"},"Utilizations",-1))]),l("label",Ge,[I(l("input",{type:"checkbox","onUpdate:modelValue":e[2]||(e[2]=f=>u.value=f),class:"accent-amber-600"},null,512),[[N,u.value]]),e[5]||(e[5]=l("span",{class:"text-sm"},"Annual Plans",-1))])])]),m.value?(S(),E("div",je," Loading approved events… ")):d.value?(S(),E("div",Be,J(d.value),1)):(S(),E("div",ze,[L(K(he),{options:w.value},null,8,["options"])])),e[7]||(e[7]=l("div",{class:"grid grid-cols-1 md:grid-cols-3 gap-3"},[l("div",{class:"p-4 rounded-xl border bg-white shadow-sm border-blue-200"},[l("div",{class:"text-xs uppercase tracking-wide text-blue-600 mb-1"},"Legend"),l("div",{class:"flex items-center gap-2 text-sm"},[l("span",{class:"w-3 h-3 rounded-sm bg-blue-600"}),R(" Activity Design (approved)")])]),l("div",{class:"p-4 rounded-xl border bg-white shadow-sm border-emerald-200"},[l("div",{class:"text-xs uppercase tracking-wide text-emerald-600 mb-1"},"Legend"),l("div",{class:"flex items-center gap-2 text-sm"},[l("span",{class:"w-3 h-3 rounded-sm bg-emerald-600"}),R(" Utilization Request (approved)")])]),l("div",{class:"p-4 rounded-xl border bg-white shadow-sm border-amber-200"},[l("div",{class:"text-xs uppercase tracking-wide text-amber-600 mb-1"},"Legend"),l("div",{class:"flex items-center gap-2 text-sm"},[l("span",{class:"w-3 h-3 rounded-sm bg-amber-600"}),R(" Annual Plan (approved)")])])],-1))])]),_:1})]),_:1}))}},at=De(We,[["__scopeId","data-v-f3f2145d"]]);export{at as default};
