import{u as _t,r as E,o as ht,c as l,A as gt,l as H,q as i,f as _,e,h as D,a as n,F as B,B as j,t as m,C as $,g as u,k as x}from"./index.DXLBKEl1.js";import{_ as pt,a as xt,q as w,t as ft,r as yt,n as wt,i as Ct,j as Mt,s as F}from"./SectionMain.D69Bzbk-.js";import{_ as O,a as W,b as St}from"./LineChart.BFgGvHO6.js";import{u as At}from"./club.BZor3J-K.js";import{u as kt}from"./clubDoc.DdepibfL.js";import{u as Dt}from"./activityDesign.D68-Sd0K.js";import"./activityDesignService.BF6kKX3z.js";import"./utilizationRequestService.C5Cd7xEr.js";import"./liquidationFundService.CyhVA6_a.js";import"./ToasterComponent.uo-DQV0_.js";import"./_plugin-vue_export-helper.DlAUqK2U.js";const Bt={class:"p-3 mb-5 rounded-2xl border bg-white"},jt={class:"grid grid-cols-1 md:grid-cols-3 gap-2 text-sm"},$t=["value"],Ft=["value"],Ot=["value"],Wt={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4"},Yt={class:"rounded-2xl border bg-white shadow-sm p-4"},Tt={class:"flex items-center justify-between"},Nt={class:"w-5 h-5 text-blue-500",viewBox:"0 0 24 24"},It=["d"],Lt={class:"mt-2 text-2xl font-semibold text-gray-900"},Ut={class:"rounded-2xl border bg-white shadow-sm p-4"},Vt={class:"flex items-center justify-between"},zt={class:"w-5 h-5 text-emerald-600",viewBox:"0 0 24 24"},Et=["d"],Ht={class:"mt-2 text-2xl font-semibold text-gray-900"},Rt={class:"rounded-2xl border bg-white shadow-sm p-4"},Jt={class:"flex items-center justify-between"},Pt={class:"w-5 h-5 text-indigo-600",viewBox:"0 0 24 24"},qt=["d"],Gt={class:"mt-2 text-2xl font-semibold text-gray-900"},Kt={class:"rounded-2xl border bg-white shadow-sm p-4"},Qt={class:"flex items-center justify-between"},Xt={class:"w-5 h-5 text-amber-600",viewBox:"0 0 24 24"},Zt=["d"],te={class:"mt-2 text-2xl font-semibold text-gray-900"},ee={class:"rounded-2xl border bg-white shadow-sm p-4"},se={class:"flex items-center justify-between"},oe={class:"w-5 h-5 text-blue-600",viewBox:"0 0 24 24"},ae=["d"],le={class:"mt-2 text-2xl font-semibold text-gray-900"},ie={class:"mt-1 text-xs text-gray-500"},ne={class:"rounded-2xl border bg-white shadow-sm p-4"},de={class:"flex items-center justify-between"},re={class:"w-5 h-5 text-indigo-600",viewBox:"0 0 24 24"},ce=["d"],ue={class:"mt-2 text-2xl font-semibold text-gray-900"},me={class:"mt-6 grid grid-cols-1 xl:grid-cols-3 gap-6"},be={class:"rounded-2xl border bg-white shadow-sm"},ve={class:"px-4 py-3 border-b flex items-center justify-between"},_e={class:"text-sm font-semibold text-gray-800 flex items-center gap-2"},he={class:"w-4 h-4 text-emerald-600",viewBox:"0 0 24 24"},ge=["d"],pe={class:"p-4"},xe={class:"h-72"},fe={class:"rounded-2xl border bg-white shadow-sm"},ye={class:"px-4 py-3 border-b flex items-center justify-between"},we={class:"text-sm font-semibold text-gray-800 flex items-center gap-2"},Ce={class:"w-4 h-4 text-blue-600",viewBox:"0 0 24 24"},Me=["d"],Se={class:"p-4"},Ae={class:"h-72"},ke={class:"rounded-2xl border bg-white shadow-sm"},De={class:"px-4 py-3 border-b flex items-center justify-between"},Be={class:"text-sm font-semibold text-gray-800 flex items-center gap-2"},je={class:"w-4 h-4 text-blue-600",viewBox:"0 0 24 24"},$e=["d"],Fe={class:"p-4"},Oe={class:"h-72"},We={class:"rounded-2xl border bg-white shadow-sm"},Ye={class:"px-4 py-3 border-b flex items-center justify-between"},Te={class:"text-sm font-semibold text-gray-800 flex items-center gap-2"},Ne={class:"w-4 h-4 text-blue-600",viewBox:"0 0 24 24"},Ie=["d"],Le={class:"p-4"},Ue={class:"h-72"},Ve={class:"rounded-2xl border bg-white shadow-sm"},ze={class:"px-4 py-3 border-b flex items-center justify-between"},Ee={class:"text-sm font-semibold text-gray-800 flex items-center gap-2"},He={class:"w-4 h-4 text-emerald-600",viewBox:"0 0 24 24"},Re=["d"],Je={class:"p-4"},Pe={class:"h-72"},qe={class:"rounded-2xl border bg-white shadow-sm"},Ge={class:"px-4 py-3 border-b flex items-center justify-between"},Ke={class:"text-sm font-semibold text-gray-800 flex items-center gap-2"},Qe={class:"w-4 h-4 text-blue-600",viewBox:"0 0 24 24"},Xe=["d"],Ze={class:"p-4"},ts={class:"h-72"},es={class:"rounded-2xl border bg-white shadow-sm xl:col-span-3"},ss={class:"px-4 py-3 border-b flex items-center justify-between"},os={class:"text-sm font-semibold text-gray-800 flex items-center gap-2"},as={class:"w-4 h-4 text-indigo-600",viewBox:"0 0 24 24"},ls=["d"],is={class:"p-4"},ns={class:""},fs={__name:"StudentDashboardPage",setup(ds){const C=At(),M=kt(),R=_t(),S=Dt(),Y=E(!0);ht(async()=>{try{await Promise.all([C.fetchAll({page:1,limit:1e3,filters:{include:"users"}},!0),M.fetchAll({page:1,limit:2e3},!0),S.fetchAll({page:1,limit:2e3},!0)])}finally{Y.value=!1}});const T=l(()=>R.user?.id),J=l(()=>Array.isArray(C.clubs?.data)?C.clubs.data:[]),P=l(()=>Array.isArray(M.docs?.data)?M.docs.data:[]),q=l(()=>Array.isArray(S.items?.data)?S.items.data:[]),b=l(()=>{const o=T.value;return o?J.value.filter(t=>Array.isArray(t.users)&&t.users.some(s=>s.id===o)):[]}),N=l(()=>new Set(b.value.map(o=>o.id))),G=l(()=>b.value.length),K=l(()=>b.value.filter(o=>o.is_active!==!1).length),Q=l(()=>b.value.reduce((o,t)=>o+(Array.isArray(t.users)?t.users.length:0),0)),X=l(()=>{const o=N.value;return P.value.filter(t=>o.has(t.club_id)).length}),Z=["1st Semester","2nd Semester","Summer"],tt=l(()=>{const o=new Date().getFullYear();return Array.from({length:6},(t,s)=>`${o-s}-${o-s+1}`)}),h=E({school_year:"",semester:"",club_id:""}),et=o=>{const t=(o??"active").toString().trim().toLowerCase();return["pending","active","inactive"].includes(t)?t:"active"},d={blue:"rgba(59,130,246,0.85)",blueSoft:"rgba(59,130,246,0.15)",indigo:"rgba(99,102,241,0.85)",indigoSoft:"rgba(99,102,241,0.15)",emerald:"rgba(16,185,129,0.85)",emeraldSoft:"rgba(16,185,129,0.15)",amber:"rgba(245,158,11,0.85)",amberSoft:"rgba(245,158,11,0.15)",rose:"rgba(244,63,94,0.85)",roseSoft:"rgba(244,63,94,0.15)",slate:"rgba(100,116,139,0.85)",slateSoft:"rgba(100,116,139,0.15)"},I=[d.blue,d.indigo,d.emerald,d.amber,d.rose,d.slate],L=[d.blueSoft,d.indigoSoft,d.emeraldSoft,d.amberSoft,d.roseSoft,d.slateSoft],f=o=>I[o%I.length],A=o=>L[o%L.length],k=o=>{if(!o)return null;const t=new Date(o);return isNaN(t)?null:t},y=new Date,U=(()=>{const o=new Date,t=o.getDay()||7;return t!==1&&o.setHours(-24*(t-1)),o.setHours(0,0,0,0),o})(),st=(()=>{const o=new Date(U);return o.setDate(o.getDate()+6),o.setHours(23,59,59,999),o})(),ot=new Date(y.getFullYear(),y.getMonth(),1),at=new Date(y.getFullYear(),y.getMonth()+1,0,23,59,59,999),V=(o,t,s)=>{const a=k(o);return a&&a>=t&&a<=s},g=l(()=>{const o=N.value,t=h.value;return q.value.filter(s=>!(!o.has(s.club_id)||t.school_year&&s.school_year!==t.school_year||t.semester&&s.semester!==t.semester||t.club_id&&+s.club_id!=+t.club_id))}),lt=l(()=>g.value.filter(o=>V(o.date_of_implementation,U,st)).length),it=l(()=>g.value.filter(o=>V(o.date_of_implementation,ot,at)).length),nt=l(()=>g.value.filter(o=>{const t=k(o.date_of_implementation);if(!t)return!1;const s=(t-y)/864e5;return s>=0&&s<=30}).length),dt=l(()=>{const o={active:0,pending:0,inactive:0},t=T.value;for(const s of b.value){const a=(s.users||[]).find(r=>r.id===t),c=et(a?.UserClub?.status);o[c]=(o[c]||0)+1}return{labels:["Active","Pending","Inactive"],datasets:[{data:[o.active,o.pending,o.inactive],backgroundColor:[d.emerald,d.amber,d.rose],borderColor:["white","white","white"],borderWidth:2}]}}),rt=l(()=>{const o={};for(const s of b.value){const a=(s.category||"Uncategorized").trim();o[a]=(o[a]||0)+1}const t=Object.keys(o).sort((s,a)=>o[a]-o[s]);return{labels:t,datasets:[{label:"My Clubs",data:t.map(s=>o[s]),backgroundColor:t.map((s,a)=>A(a)),borderColor:t.map((s,a)=>f(a)),borderWidth:1.5}]}}),ct=l(()=>{const o=b.value.map(s=>({name:s.name||s.code||`Club ${s.id}`,count:Array.isArray(s.users)?s.users.length:0})).sort((s,a)=>a.count-s.count),t=o.map(s=>s.name);return{labels:t,datasets:[{label:"Members",data:o.map(s=>s.count),backgroundColor:t.map((s,a)=>A(a)),borderColor:t.map((s,a)=>f(a)),borderWidth:1.5}]}}),ut=l(()=>{const o={draft:0,pending:0,approved:0,rejected:0,cancelled:0};for(const s of g.value)o[s.status]=(o[s.status]||0)+1;const t=Object.keys(o);return{labels:t,datasets:[{data:t.map(s=>o[s]),backgroundColor:t.map((s,a)=>f(a)),borderColor:t.map(()=>"white"),borderWidth:2}]}}),mt=l(()=>{const o={Curricular:0,"Co-Curricular":0,"Extra-Curricular":0};for(const s of g.value)o[s.nature_of_activity]=(o[s.nature_of_activity]||0)+1;const t=Object.keys(o);return{labels:t,datasets:[{data:t.map(s=>o[s]),backgroundColor:t.map((s,a)=>f(a+1)),borderColor:t.map(()=>"white"),borderWidth:2}]}}),bt=l(()=>{const o=new Map;for(const a of g.value){const c=a.club?.name||`Club #${a.club_id}`;o.set(c,(o.get(c)||0)+1)}const t=[...o.entries()].map(([a,c])=>({name:a,count:c})).sort((a,c)=>c.count-a.count),s=t.map(a=>a.name);return{labels:s,datasets:[{label:"# Activities",data:t.map(a=>a.count),backgroundColor:s.map((a,c)=>A(c)),borderColor:s.map((a,c)=>f(c)),borderWidth:1.5}]}}),vt=l(()=>{const o=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],t=new Date,s=[];for(let r=11;r>=0;r--){const v=new Date(t.getFullYear(),t.getMonth()-r,1);s.push({key:`${v.getFullYear()}-${v.getMonth()}`,y:v.getFullYear(),m:v.getMonth(),v:0})}const a=new Map(s.map(r=>[r.key,r]));for(const r of g.value){const v=k(r.date_filed||r.created_at);if(!v)continue;const z=`${v.getFullYear()}-${v.getMonth()}`;a.has(z)&&a.get(z).v++}return{labels:s.map(r=>`${o[r.m]} ${String(r.y).slice(-2)}`),datasets:[{label:"My clubs’ activities filed",data:s.map(r=>r.v),borderColor:d.indigo,backgroundColor:d.indigoSoft,borderWidth:2,pointRadius:3,pointHoverRadius:4,tension:.3,fill:!0}]}}),p=l(()=>Y.value||C.isLoading||M.isLoading||S.isLoading);return(o,t)=>(i(),gt(pt,null,{default:H(()=>[_(xt,null,{default:H(()=>[t[24]||(t[24]=e("div",{class:"mb-4"},[e("h1",{class:"text-xl font-semibold text-gray-900"},"Student Dashboard"),e("p",{class:"text-sm text-gray-500"},"Your clubs and their activities—at a glance.")],-1)),e("div",Bt,[e("div",jt,[D(e("select",{"onUpdate:modelValue":t[0]||(t[0]=s=>h.value.school_year=s),class:"border rounded px-2 py-2"},[t[3]||(t[3]=e("option",{value:""},"All School Years",-1)),(i(!0),n(B,null,j(tt.value,s=>(i(),n("option",{key:s,value:s},m(s),9,$t))),128))],512),[[$,h.value.school_year]]),D(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>h.value.semester=s),class:"border rounded px-2 py-2"},[t[4]||(t[4]=e("option",{value:""},"All Semesters",-1)),(i(),n(B,null,j(Z,s=>e("option",{key:s,value:s},m(s),9,Ft)),64))],512),[[$,h.value.semester]]),D(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>h.value.club_id=s),class:"border rounded px-2 py-2"},[t[5]||(t[5]=e("option",{value:""},"All My Clubs",-1)),(i(!0),n(B,null,j(b.value,s=>(i(),n("option",{key:s.id,value:s.id},m(s.name||"Club "+s.id),9,Ot))),128))],512),[[$,h.value.club_id]])])]),e("div",Wt,[e("div",Yt,[e("div",Tt,[t[6]||(t[6]=e("div",{class:"text-sm text-gray-500"},"My Clubs",-1)),(i(),n("svg",Nt,[e("path",{d:u(w)},null,8,It)]))]),e("div",Lt,m(G.value),1),t[7]||(t[7]=e("div",{class:"mt-1 text-xs text-gray-500"},"You’re a member of these clubs",-1))]),e("div",Ut,[e("div",Vt,[t[8]||(t[8]=e("div",{class:"text-sm text-gray-500"},"Active Memberships",-1)),(i(),n("svg",zt,[e("path",{d:u(ft)},null,8,Et)]))]),e("div",Ht,m(K.value),1),t[9]||(t[9]=e("div",{class:"mt-1 text-xs text-gray-500"},"Clubs currently active",-1))]),e("div",Rt,[e("div",Jt,[t[10]||(t[10]=e("div",{class:"text-sm text-gray-500"},"Members in My Clubs",-1)),(i(),n("svg",Pt,[e("path",{d:u(yt)},null,8,qt)]))]),e("div",Gt,m(Q.value),1),t[11]||(t[11]=e("div",{class:"mt-1 text-xs text-gray-500"},"Total membership size",-1))]),e("div",Kt,[e("div",Qt,[t[12]||(t[12]=e("div",{class:"text-sm text-gray-500"},"Club Documents",-1)),(i(),n("svg",Xt,[e("path",{d:u(wt)},null,8,Zt)]))]),e("div",te,m(X.value),1),t[13]||(t[13]=e("div",{class:"mt-1 text-xs text-gray-500"},"Across your clubs",-1))]),e("div",ee,[e("div",se,[t[14]||(t[14]=e("div",{class:"text-sm text-gray-500"},"Activities This Week",-1)),(i(),n("svg",oe,[e("path",{d:u(Ct)},null,8,ae)]))]),e("div",le,m(lt.value),1),e("div",ie,"This Month: "+m(it.value),1)]),e("div",ne,[e("div",de,[t[15]||(t[15]=e("div",{class:"text-sm text-gray-500"},"Upcoming (30 Days)",-1)),(i(),n("svg",re,[e("path",{d:u(Mt)},null,8,ce)]))]),e("div",ue,m(nt.value),1),t[16]||(t[16]=e("div",{class:"mt-1 text-xs text-gray-500"},"Implementation dates ahead",-1))])]),e("div",me,[e("div",be,[e("div",ve,[e("h3",_e,[(i(),n("svg",he,[e("path",{d:u(F)},null,8,ge)])),t[17]||(t[17]=x(" My Membership Status ",-1))])]),e("div",pe,[e("div",xe,[_(O,{data:dt.value,loading:p.value},null,8,["data","loading"])])])]),e("div",fe,[e("div",ye,[e("h3",we,[(i(),n("svg",Ce,[e("path",{d:u(w)},null,8,Me)])),t[18]||(t[18]=x(" My Clubs by Category ",-1))])]),e("div",Se,[e("div",Ae,[_(W,{data:rt.value,loading:p.value},null,8,["data","loading"])])])]),e("div",ke,[e("div",De,[e("h3",Be,[(i(),n("svg",je,[e("path",{d:u(w)},null,8,$e)])),t[19]||(t[19]=x(" Members by My Club ",-1))])]),e("div",Fe,[e("div",Oe,[_(W,{data:ct.value,loading:p.value,horizontal:!0},null,8,["data","loading"])])])]),e("div",We,[e("div",Ye,[e("h3",Te,[(i(),n("svg",Ne,[e("path",{d:u(F)},null,8,Ie)])),t[20]||(t[20]=x(" Activities by Status (My Clubs) ",-1))])]),e("div",Le,[e("div",Ue,[_(O,{data:ut.value,loading:p.value},null,8,["data","loading"])])])]),e("div",Ve,[e("div",ze,[e("h3",Ee,[(i(),n("svg",He,[e("path",{d:u(F)},null,8,Re)])),t[21]||(t[21]=x(" Activities by Nature (My Clubs) ",-1))])]),e("div",Je,[e("div",Pe,[_(O,{data:mt.value,loading:p.value},null,8,["data","loading"])])])]),e("div",qe,[e("div",Ge,[e("h3",Ke,[(i(),n("svg",Qe,[e("path",{d:u(w)},null,8,Xe)])),t[22]||(t[22]=x(" Activities by My Club ",-1))])]),e("div",Ze,[e("div",ts,[_(W,{data:bt.value,loading:p.value,horizontal:!0},null,8,["data","loading"])])])]),e("div",es,[e("div",ss,[e("h3",os,[(i(),n("svg",as,[e("path",{d:u(w)},null,8,ls)])),t[23]||(t[23]=x(" My Clubs’ Activity Trend (Monthly) ",-1))])]),e("div",is,[e("div",ns,[_(St,{data:vt.value,loading:p.value},null,8,["data","loading"])])])])])]),_:1,__:[24]})]),_:1}))}};export{fs as default};
