import{r as d,o as h,s as w,x as k,a as i,e as t,t as l,j as C,d as y,q as o}from"./index.CE3HtnZL.js";import{u as p}from"./utilizationRequestService.mGIlY9hl.js";import{Q as q}from"./browser.D7uE4X8y.js";const N={class:"min-h-screen bg-gray-50 flex items-center justify-center p-4"},U={class:"w-full max-w-2xl bg-white rounded-2xl shadow border p-5"},z={key:0,class:"text-sm text-gray-600"},L={key:1,class:"text-sm text-rose-600"},D={key:2,class:"text-sm text-gray-600"},R={key:3,class:"space-y-3"},S={class:"flex items-center gap-2 text-sm"},V={class:"grid grid-cols-1 md:grid-cols-2 gap-2 text-sm"},B={class:"font-medium"},I={class:"font-medium"},Q={class:"font-medium"},j={class:"font-medium"},A={class:"pt-3 border-t flex items-center gap-3"},T=["src"],E={class:"flex-1 min-w-0"},F={class:"text-sm truncate"},M={class:"mt-2 flex items-center gap-2"},P={key:0,class:"text-[11px] text-emerald-600"},H={__name:"VerifyUtilizationPage",setup(K){const x=w(),v=d(!1),n=d(""),a=d(null),r=d(""),u=d(""),m=d(!1);function _(s){return/^[0-9]+$/.test(String(s||"").trim())}async function g(s){if(n.value="",a.value=null,!s){n.value="Missing id parameter";return}try{if(v.value=!0,_(s))a.value=await p.getById(s);else{const e=await p.list({q:s,limit:1,page:1});a.value=Array.isArray(e?.data)&&e.data.length?e.data[0]:null}a.value||(n.value="No matching Utilization Request found")}catch(e){n.value=e?.response?.data?.message||e?.message||"Failed to verify"}finally{v.value=!1}}function c(s){const e=String(s||"").toLowerCase();return e==="approved"||e==="completed"?"emerald":e==="pending"?"amber":e==="rejected"||e==="cancelled"?"rose":"zinc"}h(()=>{r.value=window.location.href,f(),g(x.query.id)}),k(()=>x.query.id,s=>{g(s),r.value=window.location.href,f()});async function f(){try{u.value=await q.toDataURL(r.value,{margin:0,width:140})}catch{u.value=""}}async function b(){try{if(navigator.clipboard?.writeText)await navigator.clipboard.writeText(r.value);else{const s=document.createElement("textarea");s.value=r.value,document.body.appendChild(s),s.select(),document.execCommand("copy"),document.body.removeChild(s)}m.value=!0,setTimeout(()=>m.value=!1,1500)}catch{}}return(s,e)=>(o(),i("div",N,[t("div",U,[e[6]||(e[6]=t("div",{class:"mb-4"},[t("h1",{class:"text-lg font-semibold"},"Verify: Utilization Request"),t("p",{class:"text-xs text-gray-500"},"Public verification page")],-1)),v.value?(o(),i("div",z,"Loading…")):n.value?(o(),i("div",L,l(n.value),1)):a.value?(o(),i("div",R,[t("div",S,[t("span",{class:C(["px-2 py-0.5 rounded-full text-xs",{"bg-emerald-100 text-emerald-700":c(a.value.status)==="emerald","bg-amber-100 text-amber-700":c(a.value.status)==="amber","bg-rose-100 text-rose-700":c(a.value.status)==="rose","bg-gray-200 text-gray-700":c(a.value.status)==="zinc"}])},l((a.value.status||"").toUpperCase()||"UNKNOWN"),3),e[0]||(e[0]=t("span",{class:"text-gray-500"},"Status",-1))]),t("div",V,[t("div",null,[e[1]||(e[1]=t("div",{class:"text-gray-500"},"Reference",-1)),t("div",B,l(a.value.reference_code||"—"),1)]),t("div",null,[e[2]||(e[2]=t("div",{class:"text-gray-500"},"ID",-1)),t("div",I,l(a.value.id),1)]),t("div",null,[e[3]||(e[3]=t("div",{class:"text-gray-500"},"Activity Design",-1)),t("div",Q,l(a.value?.activity_design?.name_of_activity||"—"),1)]),t("div",null,[e[4]||(e[4]=t("div",{class:"text-gray-500"},"Facility",-1)),t("div",j,l(a.value?.facilities&&a.value.facilities[0]?.name||"—"),1)])]),t("div",A,[u.value?(o(),i("img",{key:0,src:u.value,alt:"QR",class:"w-24 h-24 border rounded"},null,8,T)):y("",!0),t("div",E,[e[5]||(e[5]=t("div",{class:"text-xs text-gray-500 mb-1"},"Verification Link",-1)),t("div",F,l(r.value),1),t("div",M,[t("button",{class:"px-3 py-1.5 text-xs bg-blue-600 text-white rounded",onClick:b},"Copy Link"),m.value?(o(),i("span",P,"Copied!")):y("",!0)])])])])):(o(),i("div",D,"No data."))])]))}};export{H as default};
