import{c as y,u as te,z as le,r as R,o as J,x as ne,G as oe,a as r,d as c,q as i,e as l,t as m,h as C,k as W,v as Q,j as H,C as L,g as d,F as U,B as D,E as re,f as V,A as T,l as _,M as ue,S as G}from"./index.BfTMC2Bg.js";import{u as de,v as ce,y as me,af as ve,a9 as pe,aa as fe,z as be,A as ge,_ as ye,a as we,M as X,L as xe,K as _e}from"./SectionMain.CdN9JbDZ.js";import{_ as ke,a as Z}from"./SectionTitleLineWithButton.DMuhpn7E.js";import{_ as he,B as Ce,a as $e}from"./Badge.BIldjo8d.js";import{u as ae}from"./club.OATnHn6U.js";import{u as se}from"./grievance.Cwfn5j7l.js";import{u as ie}from"./clubScope.s43G-XX6.js";import{_ as q}from"./IconifyButton.D9w-nnrD.js";import"./appContext.CENcNP6E.js";import"./activityDesignService.BZUYSqkj.js";import"./utilizationRequestService.C4JHNbve.js";import"./liquidationFundService.uX5sZ-vg.js";import"./ToasterComponent.875IY_cI.js";import"./_plugin-vue_export-helper.DlAUqK2U.js";const Se={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/30 p-4"},Re={class:"w-full max-w-3xl bg-white rounded-lg shadow-lg p-4"},Ae={class:"flex items-center justify-between"},Be={class:"font-semibold text-lg"},je={class:"mt-3 grid grid-cols-1 md:grid-cols-2 gap-3 text-sm"},Ve={class:"md:col-span-2"},Te=["disabled"],Ue={key:0,class:"text-red-600 text-[11px] mt-0.5"},De=["disabled"],Ee=["value"],Ie={key:0,class:"text-red-600 text-[11px] mt-0.5"},Me=["value"],ze={class:"md:col-span-2"},qe=["disabled"],Le={key:0,class:"text-red-600 text-[11px] mt-0.5"},Ne={key:0,class:"md:col-span-2 grid grid-cols-1 md:grid-cols-2 gap-3"},Fe=["value"],Pe=["value"],Ge={key:1,class:"md:col-span-2"},We={class:"flex justify-end gap-1.5 mt-4"},Oe={key:0,class:"px-3 py-1.5 bg-blue-600 text-white rounded text-xs"},Ke={class:"mt-4 border-t pt-3"},Qe={class:"flex items-center justify-between"},Ye=["disabled"],He={key:0,class:"mt-2 grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-3"},Je=["title"],Xe={class:"mt-1"},Ze=["src"],et={class:"mt-2 flex justify-between items-center"},tt=["href"],lt=["onClick"],at={key:1,class:"mt-2 grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-3"},st=["title"],it={class:"mt-1"},nt=["src"],ot={class:"mt-2 flex justify-end items-center"},rt=["onClick"],ut={key:2,class:"text-xs text-gray-500 mt-2"},ee={__name:"GrievanceFormModal",props:{modelValue:{type:Boolean,default:!1},mode:{type:String,default:"create"},initial:{type:Object,default:()=>({id:null,title:"",description:"",club_id:"",filed_by_user_id:"",assigned_to_user_id:"",status:"submitted",resolution_notes:""})}},emits:["update:modelValue","submit"],setup(p,{emit:f}){const k=p,$=f,A=y({get:()=>k.modelValue,set:v=>$("update:modelValue",v)}),S=te(),x=ae(),b=le(),E=y(()=>S.user?.id||null),N=y(()=>String(S.user?.role||"").toLowerCase()),g=y(()=>["admin","manager"].includes(N.value)),{isClub:B,activeClubId:h}=ie(),o=R({...k.initial}),s=R({}),n=R(!1),u=R([]),I=se();J(async()=>{(!Array.isArray(x.clubs?.data)||!x.clubs.data.length)&&await x.fetchAll({page:1,limit:200,officer:!0},!0),(!Array.isArray(b.users?.data)||!b.users.data.length)&&await b.fetchAll({page:1,limit:200},!0),B.value&&h.value&&!o.value.club_id&&(o.value.club_id=Number(h.value))}),ne(()=>k.initial,v=>{o.value={...v},!o.value.filed_by_user_id&&E.value&&(o.value.filed_by_user_id=E.value),!o.value.club_id&&B.value&&h.value&&(o.value.club_id=Number(h.value)),s.value={}},{immediate:!0});const O=["submitted","in_review","resolved","rejected"],M=y(()=>{if(k.mode==="create"||g.value)return!1;const v=String(o.value.filed_by_user_id||"")===String(S.user?.id||""),t=String(o.value.status||"")==="submitted";return!(v&&t)}),F=()=>{if(s.value={},o.value.title?.trim()||(s.value.title="Title is required"),o.value.description?.trim()||(s.value.description="Description is required"),o.value.club_id||(s.value.club_id="Club is required"),Object.keys(s.value).length)return;const v={...o.value};!o.value.id&&u.value.length&&(v.attachments=u.value.map(t=>({data:t.data,filename:t.filename,mime:t.mime}))),$("submit",v)},j=y(()=>!!o.value?.id),z=y(()=>!M.value),P=y(()=>{const v=o.value?.attachments;if(!v)return[];try{return Array.isArray(v)?v:JSON.parse(v||"[]")}catch{return[]}}),Y=async v=>{const t=v.target?.files?.[0];if(v.target.value="",!!t&&z.value){if(!j.value){const a=new FileReader;a.onload=()=>{u.value.push({data:a.result,filename:t.name,mime:t.type})},a.readAsDataURL(t);return}try{n.value=!0;const a=await I.uploadAttachment(o.value.id,t);o.value={...a}}finally{n.value=!1}}},K=async v=>{if(!z.value)return;if(!j.value){typeof v=="number"&&u.value.splice(v,1);return}const t=String(v),a=await I.deleteAttachment(o.value.id,t);o.value={...a}};return(v,t)=>{const a=oe("pending-click");return A.value?(i(),r("div",Se,[l("div",Re,[l("div",Ae,[l("h3",Be,m(p.mode==="create"?"File Grievance":"Edit Grievance"),1),l("button",{class:"text-gray-500 hover:text-gray-800",onClick:t[0]||(t[0]=e=>A.value=!1)},"✕")]),l("div",je,[l("div",Ve,[t[9]||(t[9]=l("label",{class:"block mb-0.5"},[W("Title "),l("span",{class:"text-red-500"},"*")],-1)),C(l("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>o.value.title=e),class:H(["w-full border rounded px-2 py-1.5",s.value.title?"border-red-500":""]),disabled:M.value,placeholder:"e.g., Complaint about equipment request"},null,10,Te),[[Q,o.value.title]]),s.value.title?(i(),r("p",Ue,m(s.value.title),1)):c("",!0)]),l("div",null,[t[11]||(t[11]=l("label",{class:"block mb-0.5"},[W("Club "),l("span",{class:"text-red-500"},"*")],-1)),C(l("select",{"onUpdate:modelValue":t[2]||(t[2]=e=>o.value.club_id=e),class:"w-full border rounded px-2 py-1.5",disabled:M.value||d(B)&&!!d(h)},[t[10]||(t[10]=l("option",{value:""},"Select club…",-1)),(i(!0),r(U,null,D(d(B)&&d(h)?(d(x).clubs.data||[]).filter(e=>Number(e.id)===Number(d(h))):d(x).clubs.data||[],e=>(i(),r("option",{key:e.id,value:e.id},m(e.name),9,Ee))),128))],8,De),[[L,o.value.club_id]]),s.value.club_id?(i(),r("p",Ie,m(s.value.club_id),1)):c("",!0)]),l("div",null,[t[12]||(t[12]=l("label",{class:"block mb-0.5"},"Filed By",-1)),C(l("select",{"onUpdate:modelValue":t[3]||(t[3]=e=>o.value.filed_by_user_id=e),class:"w-full border rounded px-2 py-1.5",disabled:!0},[l("option",{value:d(S).user?.id},m(d(S).user?.first_name)+" "+m(d(S).user?.last_name),9,Me)],512),[[L,o.value.filed_by_user_id]])]),l("div",ze,[t[13]||(t[13]=l("label",{class:"block mb-0.5"},[W("Description "),l("span",{class:"text-red-500"},"*")],-1)),C(l("textarea",{"onUpdate:modelValue":t[4]||(t[4]=e=>o.value.description=e),rows:"5",class:H(["w-full border rounded px-2 py-1.5",s.value.description?"border-red-500":""]),placeholder:"Describe the issue, when it happened, and any context",disabled:M.value},null,10,qe),[[Q,o.value.description]]),s.value.description?(i(),r("p",Le,m(s.value.description),1)):c("",!0)]),g.value?(i(),r("div",Ne,[l("div",null,[t[14]||(t[14]=l("label",{class:"block mb-0.5"},"Status",-1)),C(l("select",{"onUpdate:modelValue":t[5]||(t[5]=e=>o.value.status=e),class:"w-full border rounded px-2 py-1.5"},[(i(),r(U,null,D(O,e=>l("option",{key:e,value:e},m(e),9,Fe)),64))],512),[[L,o.value.status]])]),l("div",null,[t[16]||(t[16]=l("label",{class:"block mb-0.5"},"Assigned To",-1)),C(l("select",{"onUpdate:modelValue":t[6]||(t[6]=e=>o.value.assigned_to_user_id=e),class:"w-full border rounded px-2 py-1.5"},[t[15]||(t[15]=l("option",{value:""},"— Unassigned —",-1)),(i(!0),r(U,null,D(d(b).users.data||[],e=>(i(),r("option",{key:e.id,value:e.id},m(e.first_name)+" "+m(e.last_name)+" ("+m(e.username)+") ",9,Pe))),128))],512),[[L,o.value.assigned_to_user_id]])])])):c("",!0),g.value?(i(),r("div",Ge,[t[17]||(t[17]=l("label",{class:"block mb-0.5"},"Resolution Notes",-1)),C(l("textarea",{"onUpdate:modelValue":t[7]||(t[7]=e=>o.value.resolution_notes=e),rows:"3",class:"w-full border rounded px-2 py-1.5",placeholder:"Steps taken, resolution, or decision (visible to moderators)"},null,512),[[Q,o.value.resolution_notes]])])):c("",!0)]),l("div",We,[l("button",{class:"px-3 py-1.5 bg-gray-200 rounded text-xs",onClick:t[8]||(t[8]=e=>A.value=!1)},"Close"),M.value?c("",!0):C((i(),r("button",Oe,[W(m(p.mode==="create"?"File Grievance":"Save Changes"),1)])),[[a,F]])]),l("div",Ke,[l("div",Qe,[t[18]||(t[18]=l("h4",{class:"font-medium text-sm"},"Attachments",-1)),l("label",{class:H(["inline-flex items-center gap-2 px-3 py-1.5 bg-indigo-600 text-white rounded text-xs cursor-pointer disabled:opacity-60",{"opacity-60 pointer-events-none":n.value||!z.value}])},[l("span",null,m(n.value?"Uploading…":j.value?"Upload":"Add File"),1),l("input",{type:"file",class:"hidden",disabled:n.value||!z.value,onChange:Y,accept:".png,.jpg,.jpeg,.webp,.pdf,.docx,.xlsx,application/pdf,application/vnd.openxmlformats-officedocument.wordprocessingml.document,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,image/png,image/jpeg,image/webp"},null,40,Ye)],2)]),j.value&&P.value.length?(i(),r("div",He,[(i(!0),r(U,null,D(P.value,e=>(i(),r("div",{key:e.id,class:"border rounded p-2 bg-gray-50"},[l("div",{class:"text-xs font-medium truncate",title:e.filename||e.name},m(e.filename||e.name||"Attachment"),9,Je),l("div",Xe,[String(e?.mime||"").startsWith("image/")&&e.data?.startsWith("data:")?(i(),r("img",{key:0,src:e.data,class:"w-full h-24 object-contain border rounded"},null,8,Ze)):c("",!0)]),l("div",et,[e.data?.startsWith("data:")?(i(),r("a",{key:0,href:e.data,target:"_blank",class:"text-xs text-blue-600"},"Open",8,tt)):c("",!0),z.value?(i(),r("button",{key:1,class:"text-xs text-red-600",onClick:w=>K(e.id)},"Remove",8,lt)):c("",!0)])]))),128))])):c("",!0),!j.value&&u.value.length?(i(),r("div",at,[(i(!0),r(U,null,D(u.value,(e,w)=>(i(),r("div",{key:w,class:"border rounded p-2 bg-gray-50"},[l("div",{class:"text-xs font-medium truncate",title:e.filename},m(e.filename),9,st),l("div",it,[String(e?.mime||"").startsWith("image/")&&e.data?.startsWith("data:")?(i(),r("img",{key:0,src:e.data,class:"w-full h-24 object-contain border rounded"},null,8,nt)):c("",!0)]),l("div",ot,[l("button",{class:"text-xs text-red-600",onClick:xt=>K(w)},"Remove",8,rt)])]))),128))])):c("",!0),j.value&&!P.value.length||!j.value&&!u.value.length?(i(),r("div",ut,"No attachments yet.")):c("",!0)])])])):c("",!0)}}},dt={class:"flex items-center gap-1 md:gap-2"},ct=["aria-expanded"],mt={style:{width:"18px",height:"18px"},viewBox:"0 0 24 24","aria-hidden":"true"},vt=["d"],pt={__name:"GrievanceRowActions",props:{row:{type:Object,required:!0},moderator:{type:Boolean,default:!1}},emits:["attachments","edit","view","markInReview","resolve","reject","delete"],setup(p,{emit:f}){const k=p,$=y(()=>String(k.row?.status||"").toLowerCase()),A=y(()=>$.value==="submitted"),S=y(()=>!0),x=y(()=>k.moderator&&$.value==="submitted"),b=y(()=>k.moderator&&$.value==="in_review"),E=y(()=>k.moderator&&$.value==="in_review"),N=y(()=>k.moderator),g=R(!1),B=R(null),h=R(null),o=s=>{if(!g.value)return;const n=B.value,u=h.value;n&&!n.contains(s.target)&&u&&!u.contains(s.target)&&(g.value=!1)};return J(()=>document.addEventListener("click",o)),re(()=>document.removeEventListener("click",o)),(s,n)=>(i(),r("div",dt,[V(q,{"icon-path":d(de),color:"text-indigo-600",label:"Attachments",tooltip:"Attachments",size:"sm",onClick:n[0]||(n[0]=u=>s.$emit("attachments",p.row))},null,8,["icon-path"]),S.value?(i(),T(q,{key:0,"icon-path":d(ce),color:"text-gray-700",label:"View",tooltip:"View",size:"sm",onClick:n[1]||(n[1]=u=>s.$emit("view",p.row))},null,8,["icon-path"])):c("",!0),A.value?(i(),T(q,{key:1,"icon-path":d(me),color:"text-amber-600",label:"Edit",tooltip:"Edit",size:"sm",onClick:n[2]||(n[2]=u=>s.$emit("edit",p.row))},null,8,["icon-path"])):c("",!0),x.value?(i(),T(q,{key:2,"icon-path":d(ve),color:"text-blue-600",label:"In Review",tooltip:"Mark In Review",size:"sm",onClick:n[3]||(n[3]=u=>s.$emit("markInReview",p.row))},null,8,["icon-path"])):c("",!0),b.value?(i(),T(q,{key:3,"icon-path":d(pe),color:"text-emerald-600",label:"Resolve",tooltip:"Resolve",size:"sm",onClick:n[4]||(n[4]=u=>s.$emit("resolve",p.row))},null,8,["icon-path"])):c("",!0),E.value?(i(),T(q,{key:4,"icon-path":d(fe),color:"text-rose-600",label:"Reject",tooltip:"Reject",size:"sm",onClick:n[5]||(n[5]=u=>s.$emit("reject",p.row))},null,8,["icon-path"])):c("",!0),N.value?(i(),T(q,{key:5,"icon-path":d(be),color:"text-red-600",label:"Delete",tooltip:"Delete",size:"sm",onClick:n[6]||(n[6]=u=>s.$emit("delete",p.row))},null,8,["icon-path"])):c("",!0),l("div",{class:"relative md:hidden",ref_key:"btnRef",ref:h},[l("button",{class:"inline-flex items-center justify-center rounded-xl p-1.5 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-offset-1","aria-expanded":g.value,"aria-haspopup":"menu",title:"More",onClick:n[7]||(n[7]=u=>g.value=!g.value)},[(i(),r("svg",mt,[l("path",{d:d(ge)},null,8,vt)]))],8,ct),g.value?(i(),r("div",{key:0,ref_key:"menuRef",ref:B,role:"menu",class:"absolute right-0 z-20 mt-1 w-44 overflow-hidden rounded-xl border bg-white shadow-lg"},[l("button",{role:"menuitem",class:"w-full px-3 py-2 text-left text-sm hover:bg-gray-50",onClick:n[8]||(n[8]=u=>{g.value=!1,s.$emit("attachments",p.row)})},"Attachments"),S.value?(i(),r("button",{key:0,role:"menuitem",class:"w-full px-3 py-2 text-left text-sm hover:bg-gray-50",onClick:n[9]||(n[9]=u=>{g.value=!1,s.$emit("view",p.row)})},"View")):c("",!0),A.value?(i(),r("button",{key:1,role:"menuitem",class:"w-full px-3 py-2 text-left text-sm hover:bg-gray-50",onClick:n[10]||(n[10]=u=>{g.value=!1,s.$emit("edit",p.row)})},"Edit")):c("",!0),x.value?(i(),r("button",{key:2,role:"menuitem",class:"w-full px-3 py-2 text-left text-sm hover:bg-gray-50",onClick:n[11]||(n[11]=u=>{g.value=!1,s.$emit("markInReview",p.row)})},"Mark In Review")):c("",!0),b.value?(i(),r("button",{key:3,role:"menuitem",class:"w-full px-3 py-2 text-left text-sm hover:bg-gray-50",onClick:n[12]||(n[12]=u=>{g.value=!1,s.$emit("resolve",p.row)})},"Resolve")):c("",!0),E.value?(i(),r("button",{key:4,role:"menuitem",class:"w-full px-3 py-2 text-left text-sm text-rose-600 hover:bg-rose-50",onClick:n[13]||(n[13]=u=>{g.value=!1,s.$emit("reject",p.row)})},"Reject")):c("",!0),N.value?(i(),r("button",{key:5,role:"menuitem",class:"w-full px-3 py-2 text-left text-sm text-red-600 hover:bg-red-50",onClick:n[14]||(n[14]=u=>{g.value=!1,s.$emit("delete",p.row)})},"Delete")):c("",!0)],512)):c("",!0)],512)]))}},ft={class:"grid grid-cols-1 md:grid-cols-4 gap-2 mb-3"},bt=["value"],gt=["value"],yt=["value"],wt={class:"flex justify-end"},Et={__name:"GrievancesPage",setup(p){const f=se(),k=te(),$=ae(),A=le(),S=y(()=>String(k.user?.role||"").toLowerCase()),x=y(()=>["admin","manager"].includes(S.value)),b=R({page:1,limit:10,q:"",status:"",club_id:"",filed_by_user_id:""}),E=["submitted","in_review","resolved","rejected"],N=t=>{switch(String(t||"").toLowerCase()){case"submitted":return"amber";case"in_review":return"blue";case"resolved":return"emerald";case"rejected":return"red";default:return"gray"}},g=y(()=>({total:f.items.total||0,totalPages:f.items.totalPages||1,currentPage:f.items.currentPage||1,pageSize:f.items.pageSize||10,data:f.items.data||[]})),{isClub:B,activeClubId:h,withClub:o}=ie(),s=async(t={},a=!0)=>{b.value={...b.value,...t};const e=o({...b.value});["q","status","club_id","filed_by_user_id"].forEach(w=>{(e[w]===""||e[w]==null)&&delete e[w]}),await f.fetchAll(e,a)};J(async()=>{await Promise.all([s({page:1,limit:10,club_id:B?h:""}),$.fetchAll({page:1,limit:200,officer:!0},!0),A.fetchAll({page:1,limit:200},!0)])});const n=[{key:"reference_code",label:"Ref Code",sortable:!0,width:140},{key:"title",label:"Title",sortable:!0,minWidth:220},{key:"club_id",label:"Club",sortable:!1},{key:"filed_by_user_id",label:"Filed By",sortable:!1},{key:"assigned_to_user_id",label:"Assignee",sortable:!1},{key:"status",label:"Status",sortable:!0,width:120},{key:"created_at",label:"Created",sortable:!0,width:160},{key:"updated_at",label:"Updated",sortable:!0,width:160},{key:"resolved_at",label:"Resolved",sortable:!0,width:160}],u=R(!1),I=R(!1),O=R(null),M=()=>{u.value=!0},F=async t=>{await f.fetchById(t.id);const a=f.selected||t;O.value={id:a.id,title:a.title||"",description:a.description||"",club_id:a.club_id||"",filed_by_user_id:a.filed_by_user_id||"",assigned_to_user_id:a.assigned_to_user_id||"",status:a.status||"submitted",resolution_notes:a.resolution_notes||""},I.value=!0},j=async t=>{await f.create(t),u.value=!1,await s({},!0)},z=async t=>{const{id:a,...e}=t;await f.updateById(a,e),I.value=!1,await s({},!0)},P=async t=>{!x.value||!(await G.fire({title:"Mark as In Review?",text:"This will move the grievance into review.",icon:"question",showCancelButton:!0,confirmButtonText:"Yes",cancelButtonText:"Cancel"})).isConfirmed||(await f.updateById(t.id,{status:"in_review"}),await s({},!0))},Y=async t=>{!x.value||!(await G.fire({title:"Resolve grievance?",text:"This will mark the grievance as resolved.",icon:"question",showCancelButton:!0,confirmButtonText:"Resolve",cancelButtonText:"Cancel"})).isConfirmed||(await f.updateById(t.id,{status:"resolved"}),await s({},!0))},K=async t=>{!x.value||!(await G.fire({title:"Reject grievance?",text:"This will mark the grievance as rejected.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Reject",cancelButtonText:"Cancel"})).isConfirmed||(await f.updateById(t.id,{status:"rejected"}),await s({},!0))},v=async t=>{if(!t?.id)return;(await G.fire({title:"Delete grievance?",text:"This cannot be undone.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Yes, delete it",cancelButtonText:"Cancel"})).isConfirmed&&(await f.deleteById(t.id),await s({},!0),await G.fire("Deleted","The grievance has been deleted.","success"))};return(t,a)=>(i(),T(ye,null,{default:_(()=>[V(we,null,{default:_(()=>[V(ke,{icon:d(X),title:"Grievances",main:""},{default:_(()=>[V(Z,{icon:d(xe),small:"",onClick:a[0]||(a[0]=e=>s({},!0))},null,8,["icon"]),(i(),T(Z,{key:0,icon:d(_e),color:"contrast",label:"New",onClick:M},null,8,["icon"]))]),_:1},8,["icon"]),l("div",ft,[C(l("input",{"onUpdate:modelValue":a[1]||(a[1]=e=>b.value.q=e),class:"border rounded px-2 py-1.5 text-sm",placeholder:"Search…",onKeyup:a[2]||(a[2]=ue(e=>s({page:1}),["enter"]))},null,544),[[Q,b.value.q]]),C(l("select",{"onUpdate:modelValue":a[3]||(a[3]=e=>b.value.status=e),class:"border rounded px-2 py-1.5 text-sm",onChange:a[4]||(a[4]=e=>s({page:1}))},[a[11]||(a[11]=l("option",{value:""},"All statuses",-1)),(i(),r(U,null,D(E,e=>l("option",{key:e,value:e},m(e),9,bt)),64))],544),[[L,b.value.status]]),C(l("select",{"onUpdate:modelValue":a[5]||(a[5]=e=>b.value.club_id=e),class:"border rounded px-2 py-1.5 text-sm",onChange:a[6]||(a[6]=e=>s({page:1}))},[a[12]||(a[12]=l("option",{value:""},"All clubs",-1)),(i(!0),r(U,null,D(d($).clubs.data||[],e=>(i(),r("option",{key:e.id,value:e.id},m(e.name),9,gt))),128))],544),[[L,b.value.club_id]]),C(l("select",{"onUpdate:modelValue":a[7]||(a[7]=e=>b.value.filed_by_user_id=e),class:"border rounded px-2 py-1.5 text-sm",onChange:a[8]||(a[8]=e=>s({page:1}))},[a[13]||(a[13]=l("option",{value:""},"Any filer",-1)),(i(!0),r(U,null,D(d(A).users.data||[],e=>(i(),r("option",{key:e.id,value:e.id},m(e.first_name)+" "+m(e.last_name),9,yt))),128))],544),[[L,b.value.filed_by_user_id]])]),d(f).error?(i(),T(he,{key:0,color:"danger",icon:d(X)},{default:_(()=>[W(m(d(f).error),1)]),_:1},8,["icon"])):c("",!0),V(Ce,{columns:n,data:g.value,loading:d(f).isLoading,onQueryChange:s},{"cell-club_id":_(({row:e})=>[l("span",null,m(e.club?.name||(d($).clubs.data||[]).find(w=>w.id===e.club_id)?.name||""),1)]),"cell-filed_by_user_id":_(({row:e})=>[l("span",null,m(e.filed_by?.first_name||"")+" "+m(e.filed_by?.last_name||""),1)]),"cell-assigned_to_user_id":_(({row:e})=>[l("span",null,m(e.assignee?e.assignee.first_name+" "+e.assignee.last_name:"—"),1)]),"cell-status":_(({row:e})=>[V($e,{text:e.status,tone:N(e.status)},null,8,["text","tone"])]),"cell-created_at":_(({row:e})=>[l("span",null,m(e.created_at?new Date(e.created_at).toLocaleString():"—"),1)]),"cell-updated_at":_(({row:e})=>[l("span",null,m(e.updated_at?new Date(e.updated_at).toLocaleString():"—"),1)]),"cell-resolved_at":_(({row:e})=>[l("span",null,m(e.resolved_at?new Date(e.resolved_at).toLocaleString():"—"),1)]),"cell-actions":_(({row:e})=>[l("div",wt,[V(pt,{row:e,moderator:x.value,onAttachments:w=>F(e),onView:w=>F(e),onEdit:w=>F(e),onMarkInReview:w=>P(e),onResolve:w=>Y(e),onReject:w=>K(e),onDelete:w=>v(e)},null,8,["row","moderator","onAttachments","onView","onEdit","onMarkInReview","onResolve","onReject","onDelete"])])]),footer:_(()=>a[14]||(a[14]=[l("div",null,null,-1)])),_:1},8,["data","loading"]),V(ee,{modelValue:u.value,"onUpdate:modelValue":a[9]||(a[9]=e=>u.value=e),mode:"create",initial:{},onSubmit:j},null,8,["modelValue"]),V(ee,{modelValue:I.value,"onUpdate:modelValue":a[10]||(a[10]=e=>I.value=e),mode:"edit",initial:O.value,onSubmit:z},null,8,["modelValue","initial"])]),_:1})]),_:1}))}};export{Et as default};
