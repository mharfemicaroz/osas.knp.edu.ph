import{O as i,r as c}from"./index.DeYqkDTV.js";import{af as r}from"./SectionMain.C35ph8xB.js";const b=i("annualPlan",()=>{const u=c({total:0,totalPages:1,currentPage:1,pageSize:10,data:[]}),l=c(!1),s=c(null),v=c(!1),n=c(null),o=t=>{if(!t?.id)return;const a=u.value.data.findIndex(e=>e.id===t.id);a!==-1&&(u.value.data[a]=t)};return{items:u,selected:n,isLoading:l,error:s,isLoaded:v,fetchAll:async(t={},a=!1)=>{if(s.value=null,!(!a&&v.value))try{l.value=!0;const e=await r.list(t);Object.assign(u.value,{total:e.total||0,totalPages:e.totalPages||1,currentPage:t.page||1,pageSize:t.limit||10,data:e.data||[]}),v.value=!0}catch(e){s.value=e?.response?.data?.message||e?.response?.message||e?.message||"Failed to fetch annual plans"}finally{l.value=!1}},fetchById:async t=>{s.value=null;try{l.value=!0;const a=await r.getById(t);n.value=a,o(a)}catch(a){s.value=a?.response?.data?.message||a?.response?.message||a?.message||"Failed to fetch annual plan"}finally{l.value=!1}},create:async t=>{s.value=null;try{l.value=!0;const a=await r.create(t);return u.value.data.push(a),u.value.total+=1,a}catch(a){throw s.value=a?.response?.data?.message||a?.response?.message||a?.message||"Failed to create annual plan",a}finally{l.value=!1}},updateById:async(t,a)=>{s.value=null;try{l.value=!0;const e=await r.updateById(t,a);return o(e),n.value?.id===t&&(n.value=e),e}catch(e){throw s.value=e?.response?.data?.message||e?.response?.message||e?.message||"Failed to update annual plan",e}finally{l.value=!1}},deleteById:async t=>{s.value=null;try{l.value=!0,await r.delete(t),u.value.data=u.value.data.filter(a=>a.id!==t),u.value.total=Math.max(0,u.value.total-1),n.value?.id===t&&(n.value=null)}catch(a){s.value=a?.response?.data?.message||a?.response?.message||a?.message||"Failed to delete annual plan"}finally{l.value=!1}},submit:async t=>{s.value=null;try{l.value=!0;const a=await r.submit(t);return o(a),n.value?.id===t&&(n.value=a),a}catch(a){throw s.value=a?.response?.data?.message||a?.response?.message||a?.message||"Failed to submit annual plan",a}finally{l.value=!1}},approve:async(t,a)=>{s.value=null;try{l.value=!0;const e=await r.approve(t,{remarks:a});return o(e),n.value?.id===t&&(n.value=e),e}catch(e){throw s.value=e?.response?.data?.message||e?.response?.message||e?.message||"Failed to approve annual plan",e}finally{l.value=!1}},reject:async(t,a)=>{s.value=null;try{l.value=!0;const e=await r.reject(t,{remarks:a});return o(e),n.value?.id===t&&(n.value=e),e}catch(e){throw s.value=e?.response?.data?.message||e?.response?.message||e?.message||"Failed to reject annual plan",e}finally{l.value=!1}},cancel:async(t,a)=>{s.value=null;try{l.value=!0;const e=await r.cancel(t,{remarks:a});return o(e),n.value?.id===t&&(n.value=e),e}catch(e){throw s.value=e?.response?.data?.message||e?.response?.message||e?.message||"Failed to cancel annual plan",e}finally{l.value=!1}},uploadAttachment:async(t,a)=>{s.value=null;try{l.value=!0;const e=await r.uploadAttachment(t,a);return o(e),n.value?.id===t&&(n.value=e),e}catch(e){throw s.value=e?.response?.data?.message||e?.response?.message||e?.message||"Failed to upload attachment",e}finally{l.value=!1}},deleteAttachment:async(t,a)=>{s.value=null;try{l.value=!0;const e=await r.deleteAttachment(t,a);return o(e),n.value?.id===t&&(n.value=e),e}catch(e){throw s.value=e?.response?.data?.message||e?.response?.message||e?.message||"Failed to delete attachment",e}finally{l.value=!1}},resetStore:()=>{u.value={total:0,totalPages:1,currentPage:1,pageSize:10,data:[]},n.value=null,v.value=!1,l.value=!1,s.value=null}}});export{b as u};
