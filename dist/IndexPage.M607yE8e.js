import{z as ke,r as Bt,o as Be,c as l,A as je,l as jt,p as $e,q as r,f as x,e,h as P,a as c,F as et,B as st,t as u,C as N,g as v,j as ot,k as w}from"./index.w1fTWaRQ.js";import{_ as Fe,a as Me,m as De,b as $t,c as Le,d as Oe,e as We,f as Ft,g as at,h as Ye,i as Re,j as Ue,k as Pe,l as Ne,n as Te,o as qe,p as it,q as J,r as lt,s as j}from"./SectionMain.Co2y8BLV.js";import{_ as $,a as nt,b as dt}from"./LineChart.CSv_eibf.js";import{u as ze}from"./club.CZEs4jG_.js";import{u as Ee}from"./clubDoc.DWTPIkNa.js";import{u as Ve}from"./activityDesign.DQYQQrXQ.js";import{u as He}from"./annualPlan.CNmvSRSj.js";import{u as Ge}from"./liquidationFund.CD6UNGyx.js";import{u as Ie}from"./utilizationRequest.DqqE8-G-.js";import{u as Je}from"./grievance.CjFSQqzy.js";import"./appContext.Db1VNKoe.js";import"./activityDesignService.DKPfTybd.js";import"./utilizationRequestService.BsNdNhg3.js";import"./liquidationFundService.n_EUG0wO.js";import"./_plugin-vue_export-helper.DlAUqK2U.js";import"./ToasterComponent.C4X8owM8.js";const Ke={class:"p-3 mb-5 rounded-2xl border bg-white"},Qe={class:"grid grid-cols-1 md:grid-cols-5 gap-2 text-sm"},Xe=["value"],Ze=["value"],ts=["value"],es={class:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-4 gap-4"},ss={class:"flex items-center justify-between"},os={class:"w-5 h-5 text-blue-500",viewBox:"0 0 24 24"},as=["d"],is={class:"mt-2 text-2xl font-semibold text-gray-900"},ls={class:"flex items-center justify-between"},ns={class:"w-5 h-5 text-emerald-600",viewBox:"0 0 24 24"},ds=["d"],rs={class:"mt-2 text-2xl font-semibold text-gray-900"},cs=["d"],us={class:"flex items-center justify-between"},vs={class:"w-5 h-5 text-indigo-600",viewBox:"0 0 24 24"},ms=["d"],ps={class:"mt-2 text-2xl font-semibold text-gray-900"},hs={class:"flex items-center justify-between"},_s={class:"w-5 h-5 text-amber-600",viewBox:"0 0 24 24"},gs=["d"],xs={class:"mt-2 text-2xl font-semibold text-gray-900"},bs={class:"flex items-center justify-between"},fs={class:"w-5 h-5 text-rose-600",viewBox:"0 0 24 24"},ys=["d"],ws={class:"mt-2 text-2xl font-semibold text-gray-900"},As={class:"flex items-center justify-between"},Cs={class:"w-5 h-5 text-slate-600",viewBox:"0 0 24 24"},Ss=["d"],ks={class:"mt-2 text-2xl font-semibold text-gray-900"},Bs={class:"rounded-2xl border bg-white shadow-sm p-4"},js={class:"flex items-center justify-between"},$s={class:"w-5 h-5 text-blue-600",viewBox:"0 0 24 24"},Fs=["d"],Ms={class:"mt-2 text-2xl font-semibold text-gray-900"},Ds={class:"mt-1 text-xs text-gray-500"},Ls={class:"rounded-2xl border bg-white shadow-sm p-4"},Os={class:"flex items-center justify-between"},Ws={class:"w-5 h-5 text-indigo-600",viewBox:"0 0 24 24"},Ys=["d"],Rs={class:"mt-2 text-2xl font-semibold text-gray-900"},Us={class:"rounded-2xl border bg-white shadow-sm p-4"},Ps={class:"flex items-center justify-between"},Ns={class:"w-5 h-5 text-emerald-600",viewBox:"0 0 24 24"},Ts=["d"],qs={class:"mt-2 text-2xl font-semibold text-gray-900"},zs={class:"mt-1 text-xs text-gray-500"},Es={class:"rounded-2xl border bg-white shadow-sm p-4"},Vs={class:"flex items-center justify-between"},Hs={class:"w-5 h-5 text-blue-600",viewBox:"0 0 24 24"},Gs=["d"],Is={class:"mt-2 text-2xl font-semibold text-gray-900"},Js={class:"mt-1 text-xs text-gray-500"},Ks={class:"rounded-2xl border bg-white shadow-sm p-4"},Qs={class:"flex items-center justify-between"},Xs={class:"w-5 h-5 text-emerald-600",viewBox:"0 0 24 24"},Zs=["d"],to={class:"mt-2 text-2xl font-semibold text-gray-900"},eo={class:"rounded-2xl border bg-white shadow-sm p-4"},so={class:"flex items-center justify-between"},oo={class:"w-5 h-5 text-amber-600",viewBox:"0 0 24 24"},ao=["d"],io={class:"mt-2 text-2xl font-semibold text-gray-900"},lo={class:"mt-1 text-xs text-gray-500"},no={class:"rounded-2xl border bg-white shadow-sm p-4"},ro={class:"flex items-center justify-between"},co={class:"w-5 h-5 text-emerald-600",viewBox:"0 0 24 24"},uo=["d"],vo={class:"mt-2 text-2xl font-semibold text-gray-900"},mo={class:"mt-1 text-xs text-gray-500"},po={class:"rounded-2xl border bg-white shadow-sm p-4"},ho={class:"flex items-center justify-between"},_o={class:"w-5 h-5 text-indigo-600",viewBox:"0 0 24 24"},go=["d"],xo={class:"mt-1 text-xs text-gray-500"},bo={class:"rounded-2xl border bg-white shadow-sm p-4"},fo={class:"flex items-center justify-between"},yo={class:"w-5 h-5 text-blue-600",viewBox:"0 0 24 24"},wo=["d"],Ao={class:"mt-2 text-2xl font-semibold text-gray-900"},Co={class:"mt-1 text-xs text-gray-500"},So={class:"rounded-2xl border bg-white shadow-sm p-4"},ko={class:"flex items-center justify-between"},Bo={class:"w-5 h-5 text-rose-600",viewBox:"0 0 24 24"},jo=["d"],$o={class:"mt-2 text-2xl font-semibold text-gray-900"},Fo={class:"rounded-2xl border bg-white shadow-sm p-4"},Mo={class:"flex items-center justify-between"},Do={class:"w-5 h-5 text-slate-600",viewBox:"0 0 24 24"},Lo=["d"],Oo={class:"mt-2 text-2xl font-semibold text-gray-900"},Wo={class:"mt-1 text-xs text-gray-500"},Yo={class:"rounded-2xl border bg-white shadow-sm p-4"},Ro={class:"flex items-center justify-between"},Uo={class:"w-5 h-5 text-amber-600",viewBox:"0 0 24 24"},Po=["d"],No={class:"mt-2 text-2xl font-semibold text-gray-900"},To={class:"mt-1 text-xs text-gray-500"},qo={class:"rounded-2xl border bg-white shadow-sm p-4"},zo={class:"flex items-center justify-between"},Eo={class:"w-5 h-5 text-indigo-600",viewBox:"0 0 24 24"},Vo=["d"],Ho={class:"mt-2 text-2xl font-semibold text-gray-900"},Go={class:"rounded-2xl border bg-white shadow-sm p-4"},Io={class:"flex items-center justify-between"},Jo={class:"w-5 h-5 text-rose-600",viewBox:"0 0 24 24"},Ko=["d"],Qo={class:"mt-2 text-2xl font-semibold text-gray-900"},Xo={class:"mt-1 text-xs text-gray-500"},Zo={class:"rounded-2xl border bg-white shadow-sm p-4"},ta={class:"flex items-center justify-between"},ea={class:"w-5 h-5 text-slate-600",viewBox:"0 0 24 24"},sa=["d"],oa={class:"mt-2 text-2xl font-semibold text-gray-900"},aa={class:"rounded-2xl border bg-white shadow-sm p-4"},ia={class:"flex items-center justify-between"},la={class:"w-5 h-5 text-emerald-600",viewBox:"0 0 24 24"},na=["d"],da={class:"mt-2 text-2xl font-semibold text-gray-900"},ra={class:"mt-6 grid grid-cols-1 xl:grid-cols-3 gap-6"},ca={class:"rounded-2xl border bg-white shadow-sm"},ua={class:"px-4 py-3 border-b flex items-center justify-between"},va={class:"text-sm font-semibold text-gray-800 flex items-center gap-2"},ma={class:"w-4 h-4 text-slate-600",viewBox:"0 0 24 24"},pa=["d"],ha={class:"p-4"},_a={class:"h-72"},ga={class:"rounded-2xl border bg-white shadow-sm xl:col-span-2"},xa={class:"px-4 py-3 border-b flex items-center justify-between"},ba={class:"text-sm font-semibold text-gray-800 flex items-center gap-2"},fa={class:"w-4 h-4 text-blue-600",viewBox:"0 0 24 24"},ya=["d"],wa={class:"p-4"},Aa={class:"rounded-2xl border bg-white shadow-sm"},Ca={class:"px-4 py-3 border-b flex items-center justify-between"},Sa={class:"text-sm font-semibold text-gray-800 flex items-center gap-2"},ka={class:"w-4 h-4 text-blue-600",viewBox:"0 0 24 24"},Ba=["d"],ja={class:"p-4"},$a={class:"h-72"},Fa={class:"rounded-2xl border bg-white shadow-sm"},Ma={class:"px-4 py-3 border-b flex items-center justify-between"},Da={class:"text-sm font-semibold text-gray-800 flex items-center gap-2"},La={class:"w-4 h-4 text-emerald-600",viewBox:"0 0 24 24"},Oa=["d"],Wa={class:"p-4"},Ya={class:"h-72"},Ra={class:"rounded-2xl border bg-white shadow-sm"},Ua={class:"px-4 py-3 border-b flex items-center justify-between"},Pa={class:"text-sm font-semibold text-gray-800 flex items-center gap-2"},Na={class:"w-4 h-4 text-indigo-600",viewBox:"0 0 24 24"},Ta=["d"],qa={class:"p-4"},za={class:"h-72"},Ea={class:"rounded-2xl border bg-white shadow-sm xl:col-span-2"},Va={class:"px-4 py-3 border-b flex items-center justify-between"},Ha={class:"text-sm font-semibold text-gray-800 flex items-center gap-2"},Ga={class:"w-4 h-4 text-blue-600",viewBox:"0 0 24 24"},Ia=["d"],Ja={class:"p-4"},Ka={class:"rounded-2xl border bg-white shadow-sm xl:col-span-3"},Qa={class:"px-4 py-3 border-b flex items-center justify-between"},Xa={class:"text-sm font-semibold text-gray-800 flex items-center gap-2"},Za={class:"w-4 h-4 text-emerald-600",viewBox:"0 0 24 24"},ti=["d"],ei={class:"p-4 grid grid-cols-1 lg:grid-cols-3 gap-4"},si={class:"h-64"},oi={class:"h-64"},ai={class:"h-64"},ii={class:"rounded-2xl border bg-white shadow-sm"},li={class:"px-4 py-3 border-b flex items-center justify-between"},ni={class:"text-sm font-semibold text-gray-800 flex items-center gap-2"},di={class:"w-4 h-4 text-rose-600",viewBox:"0 0 24 24"},ri=["d"],ci={class:"p-4"},ui={class:"h-72"},vi={class:"rounded-2xl border bg-white shadow-sm"},mi={class:"px-4 py-3 border-b flex items-center justify-between"},pi={class:"text-sm font-semibold text-gray-800 flex items-center gap-2"},hi={class:"w-4 h-4 text-amber-600",viewBox:"0 0 24 24"},_i=["d"],gi={class:"p-4"},xi={class:"h-80"},bi={class:"rounded-2xl border bg-white shadow-sm"},fi={class:"px-4 py-3 border-b flex items-center justify-between"},yi={class:"text-sm font-semibold text-gray-800 flex items-center gap-2"},wi={class:"w-4 h-4 text-amber-600",viewBox:"0 0 24 24"},Ai=["d"],Ci={class:"p-4"},Si={class:"h-72"},ki={class:"rounded-2xl border bg-white shadow-sm"},Bi={class:"px-4 py-3 border-b flex items-center justify-between"},ji={class:"text-sm font-semibold text-gray-800 flex items-center gap-2"},$i={class:"w-4 h-4 text-emerald-600",viewBox:"0 0 24 24"},Fi=["d"],Mi={class:"p-4"},Di={class:"h-72"},Li={class:"rounded-2xl border bg-white shadow-sm"},Oi={class:"px-4 py-3 border-b flex items-center justify-between"},Wi={class:"text-sm font-semibold text-gray-800 flex items-center gap-2"},Yi={class:"w-4 h-4 text-indigo-600",viewBox:"0 0 24 24"},Ri=["d"],Ui={class:"p-4"},Pi={class:"h-72"},ol={__name:"IndexPage",setup(Ni){const Mt=$e(),F=ze(),W=Ee(),Y=ke(),T=Ve(),q=He(),z=Ge(),E=Ie(),V=Je(),rt=Bt(!0);Be(async()=>{try{await Promise.all([F.fetchAll({page:1,limit:100,filters:{include:"users"}},!0),W.fetchAll({page:1,limit:100},!0),Y.fetchAll({page:1,limit:100},!0),T.fetchAll({page:1,limit:100},!0),q.fetchAll({page:1,limit:100,status:"approved"},!0),z.fetchAll({page:1,limit:100},!0),E.fetchAll({page:1,limit:100},!0),V.fetchAll({page:1,limit:100},!0)])}finally{rt.value=!1}});const M=l(()=>Array.isArray(F.clubs?.data)?F.clubs.data:[]),Dt=l(()=>Array.isArray(W.docs?.data)?W.docs.data:[]),ct=l(()=>Array.isArray(Y.users?.data)?Y.users.data:[]),K=l(()=>Array.isArray(T.items?.data)?T.items.data:[]),Lt=l(()=>Array.isArray(q.items?.data)?q.items.data:[]),C=l(()=>Array.isArray(z.items?.data)?z.items.data:[]),D=l(()=>Array.isArray(E.items?.data)?E.items.data:[]),Q=l(()=>Array.isArray(V.items?.data)?V.items.data:[]),H=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],_=s=>Number.isFinite(+s)?(+s).toLocaleString():"0",L=s=>{const t=Number(s);return Number.isFinite(t)?t.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}):"0.00"},G=(s,t)=>{const o=Number(s),i=Number(t);return!Number.isFinite(o)||!Number.isFinite(i)||i<=0?"0%":`${(o/i*100).toFixed(1)}%`},S=s=>{if(!s)return null;const t=new Date(s);return isNaN(t)?null:t},Ot=(s,t)=>{const o=S(s),i=S(t);return!o||!i?null:Math.round((o-i)/864e5)},p={blue:"rgba(59,130,246,0.85)",blueSoft:"rgba(59,130,246,0.15)",indigo:"rgba(99,102,241,0.85)",indigoSoft:"rgba(99,102,241,0.15)",emerald:"rgba(16,185,129,0.85)",emeraldSoft:"rgba(16,185,129,0.15)",amber:"rgba(245,158,11,0.85)",amberSoft:"rgba(245,158,11,0.15)",rose:"rgba(244,63,94,0.85)",roseSoft:"rgba(244,63,94,0.15)",slate:"rgba(100,116,139,0.85)",slateSoft:"rgba(100,116,139,0.15)"},ut=[p.blue,p.indigo,p.emerald,p.amber,p.rose,p.slate],vt=[p.blueSoft,p.indigoSoft,p.emeraldSoft,p.amberSoft,p.roseSoft,p.slateSoft],f=s=>ut[s%ut.length],R=s=>vt[s%vt.length],Wt=["1st Semester","2nd Semester","Summer"],Yt=l(()=>{const s=new Date().getFullYear();return Array.from({length:8},(t,o)=>`${s-o}-${s-o+1}`)}),y=Bt({school_year:"",semester:"",office_department:"",nature_of_activity:"",status:""}),m=l(()=>{const s=y.value;return K.value.filter(t=>!(s.school_year&&t.school_year!==s.school_year||s.semester&&t.semester!==s.semester||s.office_department&&t.office_department!==s.office_department||s.nature_of_activity&&t.nature_of_activity!==s.nature_of_activity||s.status&&t.status!==s.status))}),mt=l(()=>F.clubs?.total||M.value.length||0);l(()=>M.value.filter(s=>s.is_active!==!1).length);const pt=l(()=>Y.users?.total||ct.value.length||0);l(()=>W.docs?.total||Dt.value.length||0);const ht=l(()=>m.value.length),X=l(()=>m.value.filter(s=>s.status==="approved").length),_t=l(()=>m.value.filter(s=>s.status==="pending").length),gt=l(()=>m.value.filter(s=>s.status==="rejected").length),xt=l(()=>m.value.filter(s=>s.status==="cancelled").length),Rt=l(()=>X.value+gt.value+xt.value+_t.value),Ut=l(()=>G(X.value,Rt.value)),k=l(()=>{const s=y.value,t=K.value,o=["1st Semester","2nd Semester","Summer"],i=(h,A)=>{let B=o.indexOf(A);return B<=0?{sy:`${+h.split("-")[0]-1}-${+h.split("-")[0]}`,sem:"Summer"}:{sy:h,sem:o[B-1]}};let n=h=>!0,a=h=>!0;if(s.semester&&s.school_year){const h=i(s.school_year,s.semester);n=A=>A.school_year===s.school_year&&A.semester===s.semester,a=A=>A.school_year===h.sy&&A.semester===h.sem}else if(s.school_year){const h=+s.school_year.split("-")[0],A=`${h-1}-${h}`;n=B=>B.school_year===s.school_year,a=B=>B.school_year===A}else{const h=new Date().getFullYear(),A=`${h}-${h+1}`,B=`${h-1}-${h}`;n=tt=>tt.school_year===A,a=tt=>tt.school_year===B}const d=t.filter(h=>n(h)&&h.status==="approved").length,g=t.filter(h=>a(h)&&h.status==="approved").length,kt=d-g,Se=g>0?kt/g*100:d>0?100:0;return{curr:d,prev:g,deltaAbs:kt,deltaPct:Se}}),U=new Date,bt=(()=>{const s=new Date,t=s.getDay()||7;return t!==1&&s.setHours(-24*(t-1)),s.setHours(0,0,0,0),s})(),Pt=(()=>{const s=new Date(bt);return s.setDate(s.getDate()+6),s.setHours(23,59,59,999),s})(),ft=(s,t,o)=>{const i=S(s);return i&&i>=t&&i<=o},Nt=l(()=>m.value.filter(s=>ft(s.date_of_implementation,bt,Pt)).length),Tt=new Date(U.getFullYear(),U.getMonth(),1),qt=new Date(U.getFullYear(),U.getMonth()+1,0,23,59,59,999),zt=l(()=>m.value.filter(s=>ft(s.date_of_implementation,Tt,qt)).length),Et=l(()=>m.value.filter(s=>{const t=S(s.date_of_implementation);if(!t)return!1;const o=(t-U)/864e5;return o>=0&&o<=30}).length),yt=l(()=>m.value.reduce((s,t)=>s+(+t.proposed_budget||0),0)),Vt=l(()=>m.value.length?yt.value/m.value.length:0),Ht=l(()=>m.value.filter(s=>s.annual_plan_id!=null)),wt=l(()=>Ht.value.length),Gt=l(()=>G(wt.value,ht.value)),It=l(()=>Lt.value.length),At=l(()=>C.value.length),Jt=l(()=>C.value.filter(s=>s.status==="completed").length),Kt=l(()=>G(Jt.value,At.value)),Qt=l(()=>C.value.reduce((s,t)=>s+(+t.total_sources_amount||0),0)),Xt=l(()=>C.value.reduce((s,t)=>s+(+t.total_uses_amount||0),0)),Zt=l(()=>C.value.reduce((s,t)=>s+(+t.total_cash_on_hand||0),0)),te=l(()=>{const s=new Map;for(const t of K.value)s.set(t.id,t);return s}),I=l(()=>{let s=0;for(const t of C.value){const o=te.value.get(t.activity_design_id);if(!o)continue;const i=+o.proposed_budget||0,n=+t.total_uses_amount||0;s+=n-i}return s}),ee=l(()=>{const s=m.value.filter(o=>o.status==="approved"&&o.approved_at&&o.date_filed);return s.length?s.reduce((o,i)=>o+(Ot(i.approved_at,i.date_filed)??0),0)/s.length:0}),Ct=l(()=>D.value.length),se=l(()=>D.value.filter(s=>s.status==="approved").length),oe=l(()=>G(se.value,Ct.value)),ae=l(()=>D.value.filter(s=>s.availability_status==="conflict").length);l(()=>{const s=D.value.filter(o=>Number.isFinite(+o.duration_minutes));return s.length?s.reduce((o,i)=>o+(+i.duration_minutes||0),0)/s.length/60:0});const ie=l(()=>new Set(m.value.map(t=>t.club_id)).size),le=l(()=>{const s=new Set;for(const t of M.value)if(Array.isArray(t.users))for(const o of t.users)o?.id!=null&&s.add(o.id);return s}),ne=l(()=>{const s=pt.value||0,t=le.value.size;return Math.max(0,s-t)}),de=l(()=>M.value.filter(s=>!Array.isArray(s.users)||s.users.length===0).length),re=l(()=>{const s=mt.value||M.value.length||1;return m.value.length/s}),ce=l(()=>{const s={};for(const o of ct.value){const i=String(o.role||"unknown");s[i]=(s[i]||0)+1}const t=Object.keys(s);return{labels:t,datasets:[{data:t.map(o=>s[o]),backgroundColor:t.map((o,i)=>f(i)),borderColor:t.map(()=>"white"),borderWidth:2}]}}),ue=l(()=>{const s=M.value.map(i=>({name:i.name||`Club #${i.id}`,count:Array.isArray(i.users)?i.users.length:0})).sort((i,n)=>n.count-i.count).slice(0,10),t=s.map(i=>i.name),o=s.map(i=>i.count);return{labels:t,datasets:[{label:"# Members",data:o,backgroundColor:t.map((i,n)=>R(n)),borderColor:t.map((i,n)=>f(n)),borderWidth:1.5}]}}),ve=l(()=>{const s=new Date,t=[];for(let a=11;a>=0;a--){const d=new Date(s.getFullYear(),s.getMonth()-a,1);t.push({key:`${d.getFullYear()}-${d.getMonth()}`,y:d.getFullYear(),m:d.getMonth(),v:0})}const o=new Map(t.map(a=>[a.key,a]));for(const a of C.value){const d=S(a.date_filed||a.created_at);if(!d)continue;const g=`${d.getFullYear()}-${d.getMonth()}`;o.has(g)&&o.get(g).v++}const i=t.map(a=>`${H[a.m]} ${String(a.y).slice(-2)}`),n=t.map(a=>a.v);return{labels:i,datasets:[{label:"Liquidations filed",data:n,borderColor:p.emerald,backgroundColor:p.emeraldSoft,borderWidth:2,pointRadius:3,pointHoverRadius:4,tension:.3,fill:!0}]}}),me=l(()=>{const s=new Date,t=[];for(let a=11;a>=0;a--){const d=new Date(s.getFullYear(),s.getMonth()-a,1);t.push({key:`${d.getFullYear()}-${d.getMonth()}`,y:d.getFullYear(),m:d.getMonth(),v:0})}const o=new Map(t.map(a=>[a.key,a]));for(const a of D.value){const d=S(a.created_at);if(!d)continue;const g=`${d.getFullYear()}-${d.getMonth()}`;o.has(g)&&o.get(g).v++}const i=t.map(a=>`${H[a.m]} ${String(a.y).slice(-2)}`),n=t.map(a=>a.v);return{labels:i,datasets:[{label:"Utilization requests",data:n,borderColor:p.blue,backgroundColor:p.blueSoft,borderWidth:2,pointRadius:3,pointHoverRadius:4,tension:.3,fill:!0}]}}),St=l(()=>Q.value.length),Z=l(()=>{const s={};for(const t of Q.value){const o=String(t.status||"unknown").toLowerCase();s[o]=(s[o]||0)+1}return s}),pe=l(()=>{const s=Z.value,t=(s.resolved||0)+(s.closed||0),o=St.value;return Math.max(0,o-t)}),he=l(()=>{const s=Object.keys(Z.value);return{labels:s,datasets:[{data:s.map(t=>Z.value[t]),backgroundColor:s.map((t,o)=>f(o)),borderColor:s.map(()=>"white"),borderWidth:2}]}}),_e=l(()=>{const s=new Date,t=[];for(let a=11;a>=0;a--){const d=new Date(s.getFullYear(),s.getMonth()-a,1);t.push({key:`${d.getFullYear()}-${d.getMonth()}`,y:d.getFullYear(),m:d.getMonth(),v:0})}const o=new Map(t.map(a=>[a.key,a]));for(const a of Q.value){const d=S(a.created_at);if(!d)continue;const g=`${d.getFullYear()}-${d.getMonth()}`;o.has(g)&&o.get(g).v++}const i=t.map(a=>`${H[a.m]} ${String(a.y).slice(-2)}`),n=t.map(a=>a.v);return{labels:i,datasets:[{label:"Grievances filed",data:n,borderColor:p.rose,backgroundColor:p.roseSoft,borderWidth:2,pointRadius:3,pointHoverRadius:4,tension:.3,fill:!0}]}}),O=(s={})=>{Mt.push({name:"activity-designs",query:{...y.value,...s}})},ge=l(()=>{const s={draft:0,pending:0,approved:0,rejected:0,cancelled:0};for(const o of m.value)s[o.status]=(s[o.status]||0)+1;const t=Object.keys(s);return{labels:t,datasets:[{data:t.map(o=>s[o]),backgroundColor:t.map((o,i)=>f(i)),borderColor:t.map(()=>"white"),borderWidth:2}]}}),xe=l(()=>{const s={Curricular:0,"Co-Curricular":0,"Extra-Curricular":0};for(const o of m.value)s[o.nature_of_activity]=(s[o.nature_of_activity]||0)+1;const t=Object.keys(s);return{labels:t,datasets:[{data:t.map(o=>s[o]),backgroundColor:t.map((o,i)=>f(i+1)),borderColor:t.map(()=>"white"),borderWidth:2}]}}),be=l(()=>{const s={"1st Semester":0,"2nd Semester":0,Summer:0};for(const o of m.value)s[o.semester]=(s[o.semester]||0)+1;const t=Object.keys(s);return{labels:t,datasets:[{data:t.map(o=>s[o]),backgroundColor:t.map((o,i)=>f(i+2)),borderColor:t.map(()=>"white"),borderWidth:2}]}});l(()=>{const s=m.value.filter(o=>o.status==="approved").length,t=m.value.length-s;return{labels:["Approved","Not Approved"],datasets:[{data:[s,t],backgroundColor:[p.emerald,p.rose],borderColor:["white","white"],borderWidth:2}]}});const fe=l(()=>{const s=["draft","pending","approved","rejected","cancelled","completed"],t=Object.fromEntries(s.map(o=>[o,0]));for(const o of C.value)t[o.status]=(t[o.status]||0)+1;return{labels:s,datasets:[{data:s.map(o=>t[o]||0),backgroundColor:s.map((o,i)=>f(i)),borderColor:s.map(()=>"white"),borderWidth:2}]}}),ye=l(()=>{const s=["pending-check","available","conflict","reserved","maintenance","unknown"],t=Object.fromEntries(s.map(o=>[o,0]));for(const o of D.value)t[o.availability_status]=(t[o.availability_status]||0)+1;return{labels:s,datasets:[{data:s.map(o=>t[o]),backgroundColor:s.map((o,i)=>f(i)),borderColor:s.map(()=>"white"),borderWidth:2}]}}),we=l(()=>{const s=["contribution","payment_from_fines","solicitations","donations","other_sources","current_available_funds"],t=Object.fromEntries(s.map(i=>[i,0])),o=(i,n)=>{try{return JSON.parse(i||"")??n}catch{return n}};for(const i of C.value){const n=o(i.sources_of_fund,{});for(const a of s)t[a]+=+n[a]||0}return{labels:s,datasets:[{data:s.map(i=>t[i]),backgroundColor:s.map((i,n)=>f(n)),borderColor:s.map(()=>"white"),borderWidth:2}]}}),Ae=l(()=>{const s=new Map;for(const n of m.value){const a=n.club?.name||`Club #${n.club_id}`;s.set(a,(s.get(a)||0)+1)}const t=[...s.entries()].map(([n,a])=>({name:n,count:a})).sort((n,a)=>a.count-n.count).slice(0,10),o=t.map(n=>n.name),i=t.map(n=>n.count);return{labels:o,datasets:[{label:"# Activities",data:i,backgroundColor:o.map((n,a)=>R(a)),borderColor:o.map((n,a)=>f(a)),borderWidth:1.5}]}});l(()=>{const s=new Map;for(const n of m.value){const a=n.club?.name||`Club #${n.club_id}`;s.set(a,(s.get(a)||0)+(+n.proposed_budget||0))}const t=[...s.entries()].map(([n,a])=>({name:n,sum:a})).sort((n,a)=>a.sum-n.sum).slice(0,10),o=t.map(n=>n.name),i=t.map(n=>n.sum);return{labels:o,datasets:[{label:"Proposed Budget",data:i,backgroundColor:o.map((n,a)=>R(a)),borderColor:o.map((n,a)=>f(a)),borderWidth:1.5}]}});const Ce=l(()=>{const s={};for(const o of m.value){const i=o.office_department||"—";s[i]=(s[i]||0)+1}const t=Object.keys(s).sort((o,i)=>s[i]-s[o]).slice(0,12);return{labels:t,datasets:[{label:"# Activities",data:t.map(o=>s[o]),backgroundColor:t.map((o,i)=>R(i)),borderColor:t.map((o,i)=>f(i)),borderWidth:1.5}]}});l(()=>{const t=[...new Set(m.value.map(a=>a.club?.name||`Club #${a.club_id}`))].slice(0,12),o=["draft","pending","approved","rejected","cancelled"],i=Object.fromEntries(o.map(a=>[a,Array(t.length).fill(0)]));for(const a of m.value){const d=a.club?.name||`Club #${a.club_id}`,g=t.indexOf(d);g<0||(i[a.status][g]+=1)}const n=o.map((a,d)=>({label:a,data:i[a],backgroundColor:R(d),borderColor:f(d),borderWidth:1.2}));return{labels:t,datasets:n,stacked:!0}}),l(()=>{const s=new Date,t=[];for(let a=11;a>=0;a--){const d=new Date(s.getFullYear(),s.getMonth()-a,1);t.push({key:`${d.getFullYear()}-${d.getMonth()}`,y:d.getFullYear(),m:d.getMonth(),v:0})}const o=new Map(t.map(a=>[a.key,a]));for(const a of m.value){const d=S(a.date_filed||a.created_at);if(!d)continue;const g=`${d.getFullYear()}-${d.getMonth()}`;o.has(g)&&o.get(g).v++}const i=t.map(a=>`${H[a.m]} ${String(a.y).slice(-2)}`),n=t.map(a=>a.v);return{labels:i,datasets:[{label:"Activities filed",data:n,borderColor:p.indigo,backgroundColor:p.indigoSoft,borderWidth:2,pointRadius:3,pointHoverRadius:4,tension:.3,fill:!0}]}});const b=l(()=>rt.value||F.isLoading||W.isLoading||Y.isLoading||T.isLoading||q.isLoading||z.isLoading||E.isLoading||V.isLoading);return(s,t)=>(r(),je(Fe,null,{default:jt(()=>[x(Me,null,{default:jt(()=>[t[61]||(t[61]=e("div",{class:"mb-4"},[e("h1",{class:"text-xl font-semibold text-gray-900"},"Dashboard"),e("p",{class:"text-sm text-gray-500"},"Key metrics & trends across activities, funds, utilization, and clubs. ")],-1)),e("div",Ke,[e("div",Qe,[P(e("select",{"onUpdate:modelValue":t[0]||(t[0]=o=>y.value.school_year=o),class:"border rounded px-2 py-2"},[t[11]||(t[11]=e("option",{value:""},"All School Years",-1)),(r(!0),c(et,null,st(Yt.value,o=>(r(),c("option",{key:o,value:o},u(o),9,Xe))),128))],512),[[N,y.value.school_year]]),P(e("select",{"onUpdate:modelValue":t[1]||(t[1]=o=>y.value.semester=o),class:"border rounded px-2 py-2"},[t[12]||(t[12]=e("option",{value:""},"All Semesters",-1)),(r(),c(et,null,st(Wt,o=>e("option",{key:o,value:o},u(o),9,Ze)),64))],512),[[N,y.value.semester]]),P(e("select",{"onUpdate:modelValue":t[2]||(t[2]=o=>y.value.office_department=o),class:"border rounded px-2 py-2"},[t[13]||(t[13]=e("option",{value:""},"All Clubs",-1)),(r(!0),c(et,null,st(v(F).clubs.data||[],o=>(r(),c("option",{key:o.name,value:o.name},u(o.name),9,ts))),128))],512),[[N,y.value.office_department]]),P(e("select",{"onUpdate:modelValue":t[3]||(t[3]=o=>y.value.nature_of_activity=o),class:"border rounded px-2 py-2"},t[14]||(t[14]=[e("option",{value:""},"All Natures",-1),e("option",null,"Curricular",-1),e("option",null,"Co-Curricular",-1),e("option",null,"Extra-Curricular",-1)]),512),[[N,y.value.nature_of_activity]]),P(e("select",{"onUpdate:modelValue":t[4]||(t[4]=o=>y.value.status=o),class:"border rounded px-2 py-2"},t[15]||(t[15]=[e("option",{value:""},"All Statuses",-1),e("option",null,"draft",-1),e("option",null,"pending",-1),e("option",null,"approved",-1),e("option",null,"rejected",-1),e("option",null,"cancelled",-1)]),512),[[N,y.value.status]])])]),e("div",es,[e("div",{class:"rounded-2xl border bg-white shadow-sm p-4 cursor-pointer hover:shadow",onClick:t[5]||(t[5]=o=>O())},[e("div",ss,[t[16]||(t[16]=e("div",{class:"text-sm text-gray-500"},"Total Activities Filed",-1)),(r(),c("svg",os,[e("path",{d:v(De)},null,8,as)]))]),e("div",is,u(_(ht.value)),1),t[17]||(t[17]=e("div",{class:"mt-1 text-xs text-gray-500"},"Filtered by controls above",-1))]),e("div",{class:"rounded-2xl border bg-white shadow-sm p-4 cursor-pointer hover:shadow",onClick:t[6]||(t[6]=o=>O({status:"approved"}))},[e("div",ls,[t[18]||(t[18]=e("div",{class:"text-sm text-gray-500"},"Approved Activities",-1)),(r(),c("svg",ns,[e("path",{d:v($t)},null,8,ds)]))]),e("div",rs,u(_(X.value)),1),e("div",{class:ot(["mt-1 text-xs flex items-center gap-1",k.value.deltaAbs>=0?"text-emerald-600":"text-rose-600"])},[(r(),c("svg",{class:ot(["w-3.5 h-3.5",k.value.deltaAbs>=0?"text-emerald-600":"text-rose-600"]),viewBox:"0 0 24 24"},[e("path",{d:k.value.deltaAbs>=0?v(Le):v(Oe)},null,8,cs)],2)),e("span",null,u(k.value.deltaAbs>=0?"+":"")+u(k.value.deltaAbs),1),e("span",null,"("+u(k.value.deltaPct.toFixed?k.value.deltaPct.toFixed(1):k.value.deltaPct)+"%) vs prev",1)],2)]),e("div",{class:"rounded-2xl border bg-white shadow-sm p-4 cursor-pointer hover:shadow",onClick:t[7]||(t[7]=o=>O())},[e("div",us,[t[19]||(t[19]=e("div",{class:"text-sm text-gray-500"},"Approval Rate",-1)),(r(),c("svg",vs,[e("path",{d:v(We)},null,8,ms)]))]),e("div",ps,u(Ut.value),1),t[20]||(t[20]=e("div",{class:"mt-1 text-xs text-gray-500"},"On approved/pending/rejected/cancelled",-1))]),e("div",{class:"rounded-2xl border bg-white shadow-sm p-4 cursor-pointer hover:shadow",onClick:t[8]||(t[8]=o=>O({status:"pending"}))},[e("div",hs,[t[21]||(t[21]=e("div",{class:"text-sm text-gray-500"},"Pending Activities",-1)),(r(),c("svg",_s,[e("path",{d:v(Ft)},null,8,gs)]))]),e("div",xs,u(_(_t.value)),1),t[22]||(t[22]=e("div",{class:"mt-1 text-xs text-gray-500"},"Awaiting decision",-1))]),e("div",{class:"rounded-2xl border bg-white shadow-sm p-4 cursor-pointer hover:shadow",onClick:t[9]||(t[9]=o=>O({status:"rejected"}))},[e("div",bs,[t[23]||(t[23]=e("div",{class:"text-sm text-gray-500"},"Rejected",-1)),(r(),c("svg",fs,[e("path",{d:v(at)},null,8,ys)]))]),e("div",ws,u(_(gt.value)),1),t[24]||(t[24]=e("div",{class:"mt-1 text-xs text-gray-500"},"Decisions: reject",-1))]),e("div",{class:"rounded-2xl border bg-white shadow-sm p-4 cursor-pointer hover:shadow",onClick:t[10]||(t[10]=o=>O({status:"cancelled"}))},[e("div",As,[t[25]||(t[25]=e("div",{class:"text-sm text-gray-500"},"Cancelled",-1)),(r(),c("svg",Cs,[e("path",{d:v(Ye)},null,8,Ss)]))]),e("div",ks,u(_(xt.value)),1),t[26]||(t[26]=e("div",{class:"mt-1 text-xs text-gray-500"},"Withdrawn activities",-1))]),e("div",Bs,[e("div",js,[t[27]||(t[27]=e("div",{class:"text-sm text-gray-500"},"Activities This Week",-1)),(r(),c("svg",$s,[e("path",{d:v(Re)},null,8,Fs)]))]),e("div",Ms,u(_(Nt.value)),1),e("div",Ds,"This Month: "+u(_(zt.value)),1)]),e("div",Ls,[e("div",Os,[t[28]||(t[28]=e("div",{class:"text-sm text-gray-500"},"Upcoming (30 Days)",-1)),(r(),c("svg",Ws,[e("path",{d:v(Ue)},null,8,Ys)]))]),e("div",Rs,u(_(Et.value)),1),t[29]||(t[29]=e("div",{class:"mt-1 text-xs text-gray-500"},"Implementation dates ahead",-1))]),e("div",Us,[e("div",Ps,[t[30]||(t[30]=e("div",{class:"text-sm text-gray-500"},"Total Proposed Budget",-1)),(r(),c("svg",Ns,[e("path",{d:v(Pe)},null,8,Ts)]))]),e("div",qs,"₱"+u(L(yt.value)),1),e("div",zs,"Average: ₱"+u(L(Vt.value)),1)]),e("div",Es,[e("div",Vs,[t[31]||(t[31]=e("div",{class:"text-sm text-gray-500"},"Activities w/ Plan Link",-1)),(r(),c("svg",Hs,[e("path",{d:v(Ne)},null,8,Gs)]))]),e("div",Is,u(_(wt.value)),1),e("div",Js,"Share: "+u(Gt.value),1)]),e("div",Ks,[e("div",Qs,[t[32]||(t[32]=e("div",{class:"text-sm text-gray-500"},"Approved Annual Plans",-1)),(r(),c("svg",Xs,[e("path",{d:v($t)},null,8,Zs)]))]),e("div",to,u(_(It.value)),1),t[33]||(t[33]=e("div",{class:"mt-1 text-xs text-gray-500"},"Loaded items",-1))]),e("div",eo,[e("div",so,[t[34]||(t[34]=e("div",{class:"text-sm text-gray-500"},"Liquidations Filed",-1)),(r(),c("svg",oo,[e("path",{d:v(Te)},null,8,ao)]))]),e("div",io,u(_(At.value)),1),e("div",lo,"Completion: "+u(Kt.value),1)]),e("div",no,[e("div",ro,[t[35]||(t[35]=e("div",{class:"text-sm text-gray-500"},"Cash on Hand",-1)),(r(),c("svg",co,[e("path",{d:v(qe)},null,8,uo)]))]),e("div",vo,"₱"+u(L(Zt.value)),1),e("div",mo,"Sources: ₱"+u(L(Qt.value))+" • Uses: ₱"+u(L(Xt.value)),1)]),e("div",po,[e("div",ho,[t[36]||(t[36]=e("div",{class:"text-sm text-gray-500"},"Budget Variance",-1)),(r(),c("svg",_o,[e("path",{d:v(it)},null,8,go)]))]),e("div",{class:ot(["mt-2 text-2xl font-semibold",I.value>=0?"text-rose-600":"text-emerald-600"])},u(I.value>=0?"+":"-")+"₱"+u(L(Math.abs(I.value))),3),e("div",xo,u(I.value>=0?"Overspend":"Underspend")+" vs proposed",1)]),e("div",bo,[e("div",fo,[t[37]||(t[37]=e("div",{class:"text-sm text-gray-500"},"Facility Requests",-1)),(r(),c("svg",yo,[e("path",{d:v(J)},null,8,wo)]))]),e("div",Ao,u(_(Ct.value)),1),e("div",Co,"Approval Rate: "+u(oe.value),1)]),e("div",So,[e("div",ko,[t[38]||(t[38]=e("div",{class:"text-sm text-gray-500"},"Conflicts Detected",-1)),(r(),c("svg",Bo,[e("path",{d:v(at)},null,8,jo)]))]),e("div",$o,u(_(ae.value)),1),t[39]||(t[39]=e("div",{class:"mt-1 text-xs text-gray-500"},"Schedule overlaps",-1))]),e("div",Fo,[e("div",Mo,[t[40]||(t[40]=e("div",{class:"text-sm text-gray-500"},"Users Without Clubs",-1)),(r(),c("svg",Do,[e("path",{d:v(lt)},null,8,Lo)]))]),e("div",Oo,u(_(ne.value)),1),e("div",Wo,"Out of "+u(_(pt.value))+" users",1)]),e("div",Yo,[e("div",Ro,[t[41]||(t[41]=e("div",{class:"text-sm text-gray-500"},"Clubs Without Members",-1)),(r(),c("svg",Uo,[e("path",{d:v(lt)},null,8,Po)]))]),e("div",No,u(_(de.value)),1),e("div",To,"Total clubs: "+u(_(mt.value)),1)]),e("div",qo,[e("div",zo,[t[42]||(t[42]=e("div",{class:"text-sm text-gray-500"},"Avg Activities / Club",-1)),(r(),c("svg",Eo,[e("path",{d:v(it)},null,8,Vo)]))]),e("div",Ho,u((re.value||0).toFixed(2)),1),t[43]||(t[43]=e("div",{class:"mt-1 text-xs text-gray-500"},"Based on current filter",-1))]),e("div",Go,[e("div",Io,[t[44]||(t[44]=e("div",{class:"text-sm text-gray-500"},"Grievances Filed",-1)),(r(),c("svg",Jo,[e("path",{d:v(at)},null,8,Ko)]))]),e("div",Qo,u(_(St.value)),1),e("div",Xo,"Open: "+u(_(pe.value)),1)]),e("div",Zo,[e("div",ta,[t[45]||(t[45]=e("div",{class:"text-sm text-gray-500"},"Avg Approval Time",-1)),(r(),c("svg",ea,[e("path",{d:v(Ft)},null,8,sa)]))]),e("div",oa,u((ee.value||0).toFixed(1))+" days ",1),t[46]||(t[46]=e("div",{class:"mt-1 text-xs text-gray-500"},"Approved activities only",-1))]),e("div",aa,[e("div",ia,[t[47]||(t[47]=e("div",{class:"text-sm text-gray-500"},"Distinct Clubs Active",-1)),(r(),c("svg",la,[e("path",{d:v(lt)},null,8,na)]))]),e("div",da,u(_(ie.value)),1),t[48]||(t[48]=e("div",{class:"mt-1 text-xs text-gray-500"},"With ≥ 1 filtered activity",-1))])]),e("div",ra,[e("div",ca,[e("div",ua,[e("h3",va,[(r(),c("svg",ma,[e("path",{d:v(j)},null,8,pa)])),t[49]||(t[49]=w(" Users by Role ",-1))])]),e("div",ha,[e("div",_a,[x($,{data:ce.value,loading:b.value},null,8,["data","loading"])])])]),e("div",ga,[e("div",xa,[e("h3",ba,[(r(),c("svg",fa,[e("path",{d:v(J)},null,8,ya)])),t[50]||(t[50]=w(" Top Clubs by # of Members ",-1))])]),e("div",wa,[e("div",null,[x(nt,{data:ue.value,loading:b.value,horizontal:!0},null,8,["data","loading"])])])]),e("div",Aa,[e("div",Ca,[e("h3",Sa,[(r(),c("svg",ka,[e("path",{d:v(j)},null,8,Ba)])),t[51]||(t[51]=w(" Activities by Status ",-1))])]),e("div",ja,[e("div",$a,[x($,{data:ge.value,loading:b.value},null,8,["data","loading"])])])]),e("div",Fa,[e("div",Ma,[e("h3",Da,[(r(),c("svg",La,[e("path",{d:v(j)},null,8,Oa)])),t[52]||(t[52]=w(" Activities by Nature ",-1))])]),e("div",Wa,[e("div",Ya,[x($,{data:xe.value,loading:b.value},null,8,["data","loading"])])])]),e("div",Ra,[e("div",Ua,[e("h3",Pa,[(r(),c("svg",Na,[e("path",{d:v(j)},null,8,Ta)])),t[53]||(t[53]=w(" Activities by Semester ",-1))])]),e("div",qa,[e("div",za,[x($,{data:be.value,loading:b.value},null,8,["data","loading"])])])]),e("div",Ea,[e("div",Va,[e("h3",Ha,[(r(),c("svg",Ga,[e("path",{d:v(J)},null,8,Ia)])),t[54]||(t[54]=w(" Top Clubs by # of Activities ",-1))])]),e("div",Ja,[e("div",null,[x(nt,{data:Ae.value,loading:b.value,horizontal:!0},null,8,["data","loading"])])])]),e("div",Ka,[e("div",Qa,[e("h3",Xa,[(r(),c("svg",Za,[e("path",{d:v(it)},null,8,ti)])),t[55]||(t[55]=w(" Filing Trends (12 months) ",-1))])]),e("div",ei,[e("div",si,[x(dt,{data:ve.value,loading:b.value},null,8,["data","loading"])]),e("div",oi,[x(dt,{data:me.value,loading:b.value},null,8,["data","loading"])]),e("div",ai,[x(dt,{data:_e.value,loading:b.value},null,8,["data","loading"])])])]),e("div",ii,[e("div",li,[e("h3",ni,[(r(),c("svg",di,[e("path",{d:v(j)},null,8,ri)])),t[56]||(t[56]=w(" Grievances by Status ",-1))])]),e("div",ci,[e("div",ui,[x($,{data:he.value,loading:b.value},null,8,["data","loading"])])])]),e("div",vi,[e("div",mi,[e("h3",pi,[(r(),c("svg",hi,[e("path",{d:v(J)},null,8,_i)])),t[57]||(t[57]=w(" Office / Department by # Activities ",-1))])]),e("div",gi,[e("div",xi,[x(nt,{data:Ce.value,loading:b.value,horizontal:!0},null,8,["data","loading"])])])]),e("div",bi,[e("div",fi,[e("h3",yi,[(r(),c("svg",wi,[e("path",{d:v(j)},null,8,Ai)])),t[58]||(t[58]=w(" Liquidation by Status ",-1))])]),e("div",Ci,[e("div",Si,[x($,{data:fe.value,loading:b.value},null,8,["data","loading"])])])]),e("div",ki,[e("div",Bi,[e("h3",ji,[(r(),c("svg",$i,[e("path",{d:v(j)},null,8,Fi)])),t[59]||(t[59]=w(" Liquidation by Source ",-1))])]),e("div",Mi,[e("div",Di,[x($,{data:we.value,loading:b.value},null,8,["data","loading"])])])]),e("div",Li,[e("div",Oi,[e("h3",Wi,[(r(),c("svg",Yi,[e("path",{d:v(j)},null,8,Ri)])),t[60]||(t[60]=w(" Utilization by Availability ",-1))])]),e("div",Ui,[e("div",Pi,[x($,{data:ye.value,loading:b.value},null,8,["data","loading"])])])])])]),_:1,__:[61]})]),_:1}))}};export{ol as default};
