import{O as m,r as c}from"./index.BiRlO2qs.js";import{l as u}from"./liquidationFundService.DAvk-OsF.js";const j=m("liquidationFund",()=>{const r=c({total:0,totalPages:1,currentPage:1,pageSize:10,data:[]}),l=c(!1),s=c(null),d=c(!1),n=c(null),v=c(new Set),f=a=>v.value.has(a),i=async(a,t)=>{a!=null&&v.value.add(a);try{return await t()}finally{a!=null&&v.value.delete(a)}},o=a=>{if(!a?.id)return;const t=r.value.data.findIndex(e=>e.id===a.id);t!==-1&&(r.value.data[t]=a)};return{items:r,selected:n,isActing:f,isLoading:l,error:s,isLoaded:d,fetchAll:async(a={},t=!1)=>{if(s.value=null,!(!t&&d.value))try{l.value=!0;const e=await u.list(a);Object.assign(r.value,{total:e.total||e.count||0,totalPages:e.totalPages||Math.max(1,Math.ceil((e.total||0)/(a.limit||10))),currentPage:a.page||1,pageSize:a.limit||10,data:e.data||e.rows||[]}),d.value=!0}catch(e){s.value=e?.response?.data?.message||e?.response?.message||e?.message||"Failed to fetch liquidation funds"}finally{l.value=!1}},fetchById:async a=>{s.value=null;try{l.value=!0;const t=await u.getById(a);n.value=t,o(t)}catch(t){s.value=t?.response?.data?.message||t?.response?.message||t?.message||"Failed to fetch liquidation fund"}finally{l.value=!1}},create:async a=>{s.value=null;try{l.value=!0;const t=await u.create(a);return r.value.data.unshift(t),r.value.total+=1,t}catch(t){throw s.value=t?.response?.data?.message||t?.response?.message||t?.message||"Failed to create liquidation fund",t}finally{l.value=!1}},updateById:async(a,t)=>{s.value=null;try{l.value=!0;const e=await i(a,()=>u.updateById(a,t));return o(e),n.value?.id===a&&(n.value=e),e}catch(e){throw s.value=e?.response?.data?.message||e?.response?.message||e?.message||"Failed to update liquidation fund",e}finally{l.value=!1}},deleteById:async a=>{s.value=null;try{l.value=!0,await i(a,()=>u.delete(a)),r.value.data=r.value.data.filter(t=>t.id!==a),r.value.total=Math.max(0,r.value.total-1),n.value?.id===a&&(n.value=null)}catch(t){s.value=t?.response?.data?.message||t?.response?.message||t?.message||"Failed to delete liquidation fund"}finally{l.value=!1}},submit:async a=>{s.value=null;try{l.value=!0;const t=await i(a,()=>u.submit(a));return o(t),n.value?.id===a&&(n.value=t),t}catch(t){throw s.value=t?.response?.data?.message||t?.response?.message||t?.message||"Failed to submit liquidation fund",t}finally{l.value=!1}},approve:async(a,t)=>{s.value=null;try{l.value=!0;const e=await i(a,()=>u.approve(a,{remarks:t}));return o(e),n.value?.id===a&&(n.value=e),e}catch(e){throw s.value=e?.response?.data?.message||e?.response?.message||e?.message||"Failed to approve liquidation fund",e}finally{l.value=!1}},reject:async(a,t)=>{s.value=null;try{l.value=!0;const e=await i(a,()=>u.reject(a,{remarks:t}));return o(e),n.value?.id===a&&(n.value=e),e}catch(e){throw s.value=e?.response?.data?.message||e?.response?.message||e?.message||"Failed to reject liquidation fund",e}finally{l.value=!1}},cancel:async(a,t)=>{s.value=null;try{l.value=!0;const e=await i(a,()=>u.cancel(a,{remarks:t}));return o(e),n.value?.id===a&&(n.value=e),e}catch(e){throw s.value=e?.response?.data?.message||e?.response?.message||e?.message||"Failed to cancel liquidation fund",e}finally{l.value=!1}},uploadAttachment:async(a,t)=>{s.value=null;try{l.value=!0;const e=await u.uploadAttachment(a,t);return o(e),n.value?.id===a&&(n.value=e),e}catch(e){throw s.value=e?.response?.data?.message||e?.response?.message||e?.message||"Failed to upload attachment",e}finally{l.value=!1}},deleteAttachment:async(a,t)=>{s.value=null;try{l.value=!0;const e=await u.deleteAttachment(a,t);return o(e),n.value?.id===a&&(n.value=e),e}catch(e){throw s.value=e?.response?.data?.message||e?.response?.message||e?.message||"Failed to delete attachment",e}finally{l.value=!1}},sendEmail:async(a,t)=>{s.value=null;try{return l.value=!0,await u.sendEmail(a,t)}catch(e){throw s.value=e?.response?.data?.message||e?.response?.message||e?.message||"Failed to send email",e}finally{l.value=!1}},resetStore:()=>{r.value={total:0,totalPages:1,currentPage:1,pageSize:10,data:[]},n.value=null,d.value=!1,l.value=!1,s.value=null}}});export{j as u};
