import{r as d,c as m,o as V,A as W,l as z,q as f,f as C,e as t,a as k,h as A,O as $,t as I,g as O,k as S}from"./index.B2BJlPrj.js";import{_ as j,a as F}from"./SectionMain.s34g72MP.js";import{i as J,a as H,b as Y,F as Z}from"./index.ChATc3j1.js";import{i as K,_ as Q}from"./EventDetailsModal.2wuOXw4r.js";import{u as X}from"./activityDesign.BcIdXbsi.js";import{u as ee}from"./utilizationRequest.Kbl0ZoSb.js";import{u as te}from"./annualPlan.ClXQPjyh.js";import{u as re}from"./clubScope.CETggc0L.js";import{_ as oe}from"./_plugin-vue_export-helper.DlAUqK2U.js";import"./appContext.CIeM8cBO.js";import"./activityDesignService.BcUtml_x.js";import"./utilizationRequestService.BKx4uH5b.js";import"./liquidationFundService.8vrYsrq0.js";import"./ToasterComponent.BcndTp7k.js";const se={class:"w-full space-y-4"},ae={class:"flex items-center justify-between flex-wrap gap-3"},le={class:"flex items-center gap-2"},ne={class:"inline-flex items-center gap-2 px-3 py-1.5 rounded-full bg-blue-50 text-blue-700 border border-blue-200"},ie={class:"inline-flex items-center gap-2 px-3 py-1.5 rounded-full bg-emerald-50 text-emerald-700 border border-emerald-200"},de={class:"inline-flex items-center gap-2 px-3 py-1.5 rounded-full bg-amber-50 text-amber-700 border border-amber-200"},ce={key:0,class:"w-full p-6 text-center rounded-xl border border-gray-200 bg-white shadow-sm"},ue={key:1,class:"w-full p-4 rounded-xl border border-red-200 bg-red-50 text-red-700"},pe={key:2,class:"w-full rounded-xl overflow-hidden border border-gray-200 bg-white shadow"},me="Asia/Manila",fe={__name:"CalendarActivityPage",setup(be){const c=X(),u=ee(),p=te(),b=d(!0),v=d(!0),x=d(!0),g=d(!1),D=d(null),E=m(()=>c.isLoading||u.isLoading||p.isLoading),P=m(()=>c.error||u.error||p.error),{withClub:y}=re(),N=y({status:"approved",limit:1e3,officer:"true",order:"ASC",sort:"date_of_implementation"});V(async()=>{await Promise.allSettled([c.fetchAll(N,!0),u.fetchAll(y({status:"approved",limit:1e3,officer:"true",order:"ASC",sort:"start_at"}),!0),p.fetchAll(y({status:"approved",limit:1e3,officer:"true",order:"ASC",sort:"approved_at"}),!0)])});function R(r,e=[]){try{return JSON.parse(r||"[]")}catch{return e}}function _(r){return r==="AD"?{backgroundColor:"#1e40af",borderColor:"#1e3a8a",textColor:"#ffffff"}:r==="UR"?{backgroundColor:"#047857",borderColor:"#065f46",textColor:"#ffffff"}:{backgroundColor:"#b45309",borderColor:"#92400e",textColor:"#ffffff"}}const T=m(()=>{const r=[];if(b.value)for(const e of c.items.data){const o=e?.date_of_implementation||e?.approved_at||e?.created_at;if(!o)continue;const s=e?.club?.name?` • ${e.club.name}`:"",{backgroundColor:l,borderColor:n,textColor:a}=_("AD");r.push({id:`AD-${e.id}`,title:`Activity: ${e.name_of_activity||e.reference_code}${s}`,start:o,allDay:!0,extendedProps:{type:"Activity Design",ref:e.reference_code,club:e?.club,record:e},backgroundColor:l,borderColor:n,textColor:a})}if(v.value)for(const e of u.items.data){const o=e?.start_at||e?.approved_at||e?.created_at,s=e?.end_at||e?.start_at||e?.approved_at;if(!o)continue;const l=Array.isArray(e?.facilities)?e.facilities:R(e?.facilities),n=l?.length?` • ${l.join(", ")}`:"",a=e?.activity_design?.name_of_activity?` • ${e.activity_design.name_of_activity}`:"",{backgroundColor:i,borderColor:h,textColor:w}=_("UR");r.push({id:`UR-${e.id}`,title:`Utilization${a}${n}`,start:o,end:s,allDay:!e?.start_at||!e?.end_at,extendedProps:{type:"Utilization",ref:e.reference_code,facilities:l,record:e},backgroundColor:i,borderColor:h,textColor:w})}if(x.value)for(const e of p.items.data){const o=e?.approved_at||e?.submitted_at||e?.created_at;if(!o)continue;const s=e?.club?.name?` • ${e.club.name}`:"",l=e?.school_year?` • SY ${e.school_year}`:"",{backgroundColor:n,borderColor:a,textColor:i}=_("AP");r.push({id:`AP-${e.id}`,title:`Annual Plan Approved${s}${l}`,start:o,allDay:!0,extendedProps:{type:"Annual Plan",ref:e.reference_code,club:e?.club,record:e},backgroundColor:n,borderColor:a,textColor:i})}return r});function q(r){const e=!!r.el.closest(".fc-list"),o=(r.event.backgroundColor||"").trim().toLowerCase(),s=o.startsWith("#")?o.slice(1):null;let l=!0;if(s&&(s.length===6||s.length===3)){const a=s.length===3?s.split("").map(M=>M+M).join(""):s,i=parseInt(a.slice(0,2),16),h=parseInt(a.slice(2,4),16),w=parseInt(a.slice(4,6),16);l=(.299*i+.587*h+.114*w)/255<.6}e?(r.el.classList.remove("text-white"),r.el.classList.add("text-gray-900")):(r.el.classList.add("rounded-md","shadow-sm"),r.el.classList.remove("text-white","text-gray-900"),r.el.classList.add(l?"text-white":"text-gray-900"));const n=document.createElement("span");if(n.textContent=r.event.extendedProps?.type||"",e){n.className="mr-2 inline-block px-1.5 py-0.5 text-[10px] font-semibold rounded bg-slate-200 text-slate-700";const a=r.el.querySelector(".fc-list-event-title");(a?.querySelector("a")||a)?.prepend(n)}else n.className=`px-1.5 py-0.5 text-[10px] font-semibold rounded mr-1 align-middle ${l?"bg-white/20 text-white":"bg-black/10 text-gray-900"}`,r.el.prepend(n)}const L=d(!1),U=()=>{L.value=window.innerWidth<640};V(()=>{U(),window.addEventListener("resize",U)});function B(r){try{const e=r?.event;D.value={id:e?.id,title:e?.title,start:e?.start,end:e?.end,allDay:e?.allDay,backgroundColor:e?.backgroundColor,borderColor:e?.borderColor,textColor:e?.textColor,extendedProps:{...e?.extendedProps||{}}},g.value=!0}catch{}}const G=m(()=>({plugins:[J,H,K,Y],initialView:"dayGridMonth",headerToolbar:L.value?{left:"prev,next",center:"title",right:"dayGridMonth"}:{left:"prev,next today",center:"title",right:"dayGridMonth,timeGridWeek,timeGridDay,listWeek"},height:"auto",handleWindowResize:!0,stickyHeaderDates:!0,dayMaxEvents:3,navLinks:!0,eventDisplay:"block",eventTimeFormat:{hour:"2-digit",minute:"2-digit",meridiem:!0},timeZone:me,events:T.value,eventDidMount:q,eventClick:B}));return(r,e)=>(f(),W(j,null,{default:z(()=>[C(F,null,{default:z(()=>[t("div",se,[t("div",ae,[e[7]||(e[7]=t("h1",{class:"text-xl font-semibold"},"Campus Activities Calendar",-1)),t("div",le,[t("label",ne,[A(t("input",{type:"checkbox","onUpdate:modelValue":e[0]||(e[0]=o=>b.value=o),class:"accent-blue-600"},null,512),[[$,b.value]]),e[4]||(e[4]=t("span",{class:"text-sm"},"Activity Designs",-1))]),t("label",ie,[A(t("input",{type:"checkbox","onUpdate:modelValue":e[1]||(e[1]=o=>v.value=o),class:"accent-emerald-600"},null,512),[[$,v.value]]),e[5]||(e[5]=t("span",{class:"text-sm"},"Utilizations",-1))]),t("label",de,[A(t("input",{type:"checkbox","onUpdate:modelValue":e[2]||(e[2]=o=>x.value=o),class:"accent-amber-600"},null,512),[[$,x.value]]),e[6]||(e[6]=t("span",{class:"text-sm"},"Annual Plans",-1))])])]),E.value?(f(),k("div",ce," Loading approved events… ")):P.value?(f(),k("div",ue,I(P.value),1)):(f(),k("div",pe,[C(O(Z),{options:G.value},null,8,["options"])])),C(Q,{modelValue:g.value,"onUpdate:modelValue":e[3]||(e[3]=o=>g.value=o),event:D.value},null,8,["modelValue","event"]),e[8]||(e[8]=t("div",{class:"grid grid-cols-1 md:grid-cols-3 gap-3"},[t("div",{class:"p-4 rounded-xl border bg-white shadow-sm border-blue-200"},[t("div",{class:"text-xs uppercase tracking-wide text-blue-600 mb-1"},"Legend"),t("div",{class:"flex items-center gap-2 text-sm"},[t("span",{class:"w-3 h-3 rounded-sm bg-blue-600"}),S(" Activity Design (approved)")])]),t("div",{class:"p-4 rounded-xl border bg-white shadow-sm border-emerald-200"},[t("div",{class:"text-xs uppercase tracking-wide text-emerald-600 mb-1"},"Legend"),t("div",{class:"flex items-center gap-2 text-sm"},[t("span",{class:"w-3 h-3 rounded-sm bg-emerald-600"}),S(" Utilization Request (approved)")])]),t("div",{class:"p-4 rounded-xl border bg-white shadow-sm border-amber-200"},[t("div",{class:"text-xs uppercase tracking-wide text-amber-600 mb-1"},"Legend"),t("div",{class:"flex items-center gap-2 text-sm"},[t("span",{class:"w-3 h-3 rounded-sm bg-amber-600"}),S(" Annual Plan (approved)")])])],-1))])]),_:1})]),_:1}))}},Ue=oe(fe,[["__scopeId","data-v-061683a9"]]);export{Ue as default};
