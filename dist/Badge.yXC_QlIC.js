import{r as k,x as O,A as B,q as s,l as H,e as i,h as de,P as Se,$ as ce,T as fe,c as S,L as j,D as Be,E as X,o as me,a as o,W as _,d as p,f as P,F as w,B as T,j as N,t as M,g as x,v as Ae,_ as Ve,w as Q,a3 as Pe,a0 as Me,H as Le}from"./index.B0nDbTtE.js";import{a as $,c as ze,b as Ee}from"./SectionTitleLineWithButton.npj7wZyd.js";import{ak as Te,al as re,V as je,y as G,am as Ne,an as De,ao as Fe,ap as Ie,a0 as Oe}from"./SectionMain.UXk0-_90.js";import{_ as Ue}from"./_plugin-vue_export-helper.DlAUqK2U.js";const Re={class:"checkbox"},ue={__name:"TableCheckboxCell",props:{type:{type:String,default:"td"},modelValue:Boolean},emits:["update:modelValue"],setup(r,{emit:d}){const f=r,v=d,c=k(f.modelValue);return O(c,g=>{v("update:modelValue",g)}),O(()=>f.modelValue,g=>{c.value=g}),(g,m)=>(s(),B(ce(r.type),{class:"lg:w-1"},{default:H(()=>[i("label",Re,[de(i("input",{"onUpdate:modelValue":m[0]||(m[0]=u=>c.value=u),type:"checkbox"},null,512),[[Se,c.value]]),m[1]||(m[1]=i("span",{class:"check"},null,-1))])]),_:1}))}},We=Object.assign({name:"BaseButtons"},{__name:"BaseButtons",props:{noWrap:{type:Boolean,default:!1},type:{type:String,default:"justify-start"},classAddon:{type:String,default:"mr-3 last:mr-0 mb-3"},mb:{type:String,default:"-mb-3"}},setup(r){const d=r,f=fe(),v=S(()=>{const c=!!f.default,g=["flex","items-center",d.type,d.noWrap?"flex-nowrap":"flex-wrap"];d.mb&&g.push(d.mb);const m=c?f.default().map(u=>u&&u.children&&typeof u.children=="object"?j(u,{},u.children.map(h=>j(h,{class:[d.classAddon]}))):j(u,{class:[d.classAddon]})):null;return j("div",{class:g},m)});return(c,g)=>(s(),B(ce(v.value)))}}),qe={class:"relative space-y-2"},He={class:"flex items-center justify-between"},Je={class:"w-full border-collapse bg-white min-w-full"},Ke={class:"bg-white text-gray-700 text-sm border-b"},Qe={key:0,class:"p-2 w-10 text-center"},Ge={class:"flex items-center justify-between"},Xe={class:"font-medium"},Ye={class:"flex items-center gap-2"},Ze={key:0,class:"mt-1 p-2 border rounded bg-white shadow-md"},et=["onUpdate:modelValue","onInput"],tt={key:1,class:"px-2 py-1 text-right w-1 whitespace-nowrap"},lt={key:0},at=["colspan"],st={key:0,class:"p-2 w-10 text-center","data-label":"Select"},nt=["data-label"],ot={class:"py-1 text-sm"},it=["disabled","onClick"],rt={key:0,class:"w-4 h-4",viewBox:"0 0 24 24"},ut=["d"],dt={class:"truncate"},ct={key:0},ft={key:1},mt={key:1,class:"px-4 py-2 whitespace-nowrap","data-label":"Action"},pt={key:1,class:"border-t text-sm font-semibold bg-gray-50"},vt={key:0,class:"p-2 w-10"},gt=["data-label"],yt={key:0},ht={key:1,class:"px-4 py-2"},bt={class:"p-3 border rounded-lg bg-white text-sm flex flex-col sm:flex-row sm:justify-between sm:items-center"},kt={class:"mb-2 sm:mb-0"},wt={class:"flex flex-wrap items-center gap-2"},xt=["value"],_t={__name:"BaseTable",props:{columns:{type:Array,default:()=>[]},data:{type:Object,default:()=>({total:0,totalPages:1,currentPage:1,pageSize:10,data:[]})},checkable:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},showAction:{type:Boolean,default:!0}},emits:["query-change","selected","sort","filter","edit"],setup(r,{emit:d}){const f=r,v=d,c=k(null),g=Be.useLoading(),m=k(null);O(()=>f.loading,t=>{t?m.value||(m.value=g.show({container:c.value,canCancel:!1,isFullPage:!1,color:"#3b82f6",opacity:.8})):m.value&&(m.value.hide(),m.value=null)},{immediate:!0}),X(()=>{m.value&&(m.value.hide(),m.value=null)});const u=k(f.data.currentPage||1),h=k(f.data.pageSize||10),z=k(null),E=k("desc"),A=k({}),U=k({}),L=k(new Set),D=k(null),Y=k({top:"0px",left:"0px",minWidth:"176px"});O(()=>f.data.currentPage,t=>u.value=t||1),O(()=>f.data.pageSize,t=>h.value=t||10);const C=S(()=>f.data||{total:0,totalPages:1,currentPage:1,pageSize:10,data:[]}),J=S(()=>C.value.data.filter(t=>Object.keys(A.value).every(a=>A.value[a]?t[a]?.toString().toLowerCase().includes(A.value[a].toLowerCase()):!0))),pe=S(()=>L.value.size===J.value.length&&J.value.length>0),R=S(()=>C.value.totalPages||Math.ceil(C.value.total/h.value)||1),ve=S(()=>{const t=R.value,a=u.value,e=2,l=[];if(t<=7)for(let n=1;n<=t;n++)l.push(n);else{l.push(1);let n=Math.max(2,a-e),b=Math.min(t-1,a+e);n>2&&l.push("...");for(let y=n;y<=b;y++)l.push(y);b<t-1&&l.push("..."),l.push(t)}return l}),F=()=>{v("query-change",{page:u.value,limit:h.value,sort:z.value,order:E.value,filters:A.value})},W=t=>{t>=1&&t<=R.value&&(u.value=t,F())},ge=t=>{h.value=Number(t.target.value),u.value=1,F()},Z=t=>{z.value===t?E.value=E.value==="asc"?"desc":"asc":(z.value=t,E.value="desc"),v("sort",{key:z.value,order:E.value}),F()},ee=t=>{U.value[t]=!U.value[t]},te=(t,a)=>{A.value[t]=a,v("filter",A.value),F()},ye=t=>{t?L.value=new Set(J.value.map(a=>a.id)):L.value.clear(),v("selected",Array.from(L.value))},he=(t,a)=>{t?L.value.add(a.id):L.value.delete(a.id),v("selected",Array.from(L.value))},le=t=>v("edit",t),ae=(t,a)=>`${t.id??t._key??JSON.stringify(t)}:${a?.key??"actions"}`,be=(t,a)=>D.value===ae(t,a),ke=(t,a,e)=>{const l=ae(t,a);if(D.value===l){D.value=null;return}try{const n=e?.currentTarget||e?.target;if(n&&typeof n.getBoundingClientRect=="function"){const b=n.getBoundingClientRect(),y=176,ie=6,_e=window.innerWidth||document.documentElement.clientWidth,Ce=window.innerHeight||document.documentElement.clientHeight;let $e=Math.min(_e-y-8,Math.max(8,b.right-y)),K=b.bottom+ie;K+240>Ce&&b.top>240&&(K=Math.max(8,b.top-ie-240)),Y.value={position:"fixed",top:`${K}px`,left:`${$e}px`,minWidth:`${y}px`}}}catch{}D.value=l},se=()=>{D.value=null},I=(t,a)=>typeof t?.visible=="function"?!!t.visible(a):typeof t?.visible=="boolean"?t.visible:!0,q=(t,a)=>typeof t?.disabled=="function"?!!t.disabled(a):typeof t?.disabled=="boolean"?t.disabled:!1,we=t=>{const a=String(t?.tone||"").toLowerCase();return a==="danger"?"text-red-600 hover:bg-red-50":a==="warning"?"text-amber-700 hover:bg-amber-50":a==="success"?"text-emerald-700 hover:bg-emerald-50":""},ne=async(t,a)=>{t&&(t.confirm&&!window.confirm(typeof t.confirm=="string"?t.confirm:"Are you sure?")||(typeof t.onClick=="function"?t.onClick(a):typeof t.emit=="string"&&v(t.emit,a),se()))};let V=null;me(()=>{typeof window<"u"&&(V=()=>{se()},window.addEventListener("click",V),window.addEventListener("resize",V),window.addEventListener("scroll",V,!0))}),X(()=>{V&&typeof window<"u"&&(window.removeEventListener("click",V),window.removeEventListener("resize",V),window.removeEventListener("scroll",V,!0),V=null)});const oe=S(()=>{const t={};return f.columns.forEach(a=>{if(a.aggregate){let e=0;C.value.data.forEach(l=>{const n=parseFloat(l[a.key]);isNaN(n)||(e+=n)}),t[a.key]=e}}),t}),xe=S(()=>f.columns.some(t=>t.aggregate));return(t,a)=>(s(),o("div",qe,[i("div",He,[i("div",null,[_(t.$slots,"toolbar-left",{},void 0,!0)]),i("div",null,[_(t.$slots,"toolbar-right",{},void 0,!0)])]),i("div",{ref_key:"tableContainer",ref:c,class:"table-container relative rounded-lg border border-gray-200 shadow-sm bg-white"},[i("table",Je,[i("thead",Ke,[i("tr",null,[r.checkable?(s(),o("th",Qe,[P(ue,{modelValue:pe.value,"onUpdate:modelValue":ye},null,8,["modelValue"])])):p("",!0),(s(!0),o(w,null,T(r.columns,e=>(s(),o("th",{key:e.key,class:N(["px-4 py-2 text-left",e.key==="actions"||e.isAction?"whitespace-nowrap":"whitespace-normal break-words"])},[_(t.$slots,`header-${e.key}`,{column:e,sort:{key:z.value,order:E.value,toggle:()=>Z(e.key)},filter:{value:A.value[e.key]||"",set:l=>te(e.key,l),open:!!U.value[e.key],toggle:()=>ee(e.key)}},()=>[i("div",Ge,[i("span",Xe,M(e.label),1),i("div",Ye,[e.sortable?(s(),B($,{key:0,icon:z.value===e.key?E.value==="asc"?x(Te):x(re):x(re),small:"",onClick:l=>Z(e.key)},null,8,["icon","onClick"])):p("",!0),e.filterable?(s(),B($,{key:1,icon:x(je),small:"",onClick:l=>ee(e.key)},null,8,["icon","onClick"])):p("",!0)])]),P(Ve,{name:"fade"},{default:H(()=>[U.value[e.key]?(s(),o("div",Ze,[de(i("input",{"onUpdate:modelValue":l=>A.value[e.key]=l,class:"w-full px-2 py-1 text-xs border rounded",placeholder:"Filter...",onInput:l=>te(e.key,l.target.value)},null,40,et),[[Ae,A.value[e.key]]])])):p("",!0)]),_:2},1024)],!0)],2))),128)),r.showAction?(s(),o("th",tt)):p("",!0)])]),i("tbody",null,[!C.value.data.length&&!r.loading?(s(),o("tr",lt,[i("td",{colspan:r.columns.length+(r.checkable?1:0)+(r.showAction?1:0),class:"p-6"},[_(t.$slots,"empty",{},()=>[a[4]||(a[4]=i("div",{class:"text-center text-sm text-gray-500"},"No data to display.",-1))],!0)],8,at)])):p("",!0),(s(!0),o(w,null,T(C.value.data,e=>(s(),o("tr",{key:e.id??e._key??JSON.stringify(e),class:"border-t text-sm hover:bg-gray-50"},[r.checkable?(s(),o("td",st,[P(ue,{modelValue:L.value.has(e.id),"onUpdate:modelValue":l=>he(l,e)},null,8,["modelValue","onUpdate:modelValue"])])):p("",!0),(s(!0),o(w,null,T(r.columns,l=>(s(),o("td",{key:l.key,class:N(["px-4 py-2 align-top",l.key==="actions"||l.isAction?"whitespace-nowrap":"whitespace-normal break-words"]),"data-label":l.label},[_(t.$slots,`cell-${l.key}`,{row:e,value:e[l.key],column:l},()=>[l.key==="actions"||l.isAction?(s(),o("div",{key:0,class:"relative flex items-center justify-end gap-1 select-none",onClick:a[1]||(a[1]=Q(()=>{},["stop"]))},[Array.isArray(l.actions)&&l.actions.length?(s(),o(w,{key:0},[l.actions.filter(n=>I(n,e)).length?(s(),o(w,{key:0},[(s(!0),o(w,null,T(l.actions.filter(n=>I(n,e)),(n,b)=>(s(),o(w,{key:"p-"+b},[n.primary&&b===l.actions.findIndex(y=>I(y,e)&&y.primary)||!l.actions.some(y=>I(y,e)&&y.primary)&&b===0?(s(),B($,{key:0,class:"hidden sm:inline-flex",icon:n.icon||x(G),label:n.showLabel?n.label:"",small:"",title:n.tooltip||n.label,disabled:q(n,e),onClick:y=>ne(n,e)},null,8,["icon","label","title","disabled","onClick"])):p("",!0)],64))),128)),P($,{icon:x(Ne),small:"",title:"More actions",onClick:Q(n=>ke(e,l,n),["stop"])},null,8,["icon","onClick"]),(s(),B(Me,{to:"body"},[be(e,l)?(s(),o("div",{key:0,style:Pe(Y.value),class:"fixed z-[9999] w-44 rounded-md border bg-white shadow-lg",onClick:a[0]||(a[0]=Q(()=>{},["stop"]))},[i("ul",ot,[(s(!0),o(w,null,T(l.actions.filter(n=>I(n,e)),(n,b)=>(s(),o("li",{key:"m-"+b},[i("button",{class:N(["w-full text-left px-3 py-2 hover:bg-gray-50 flex items-center gap-2",[we(n),q(n,e)?"opacity-50 cursor-not-allowed":""]]),disabled:q(n,e),onClick:y=>!q(n,e)&&ne(n,e)},[n.icon?(s(),o("svg",rt,[i("path",{d:n.icon},null,8,ut)])):p("",!0),i("span",dt,M(n.label),1)],10,it)]))),128))])],4)):p("",!0)]))],64)):p("",!0)],64)):(s(),B($,{key:1,icon:x(G),small:"",title:"Edit",onClick:n=>le(e)},null,8,["icon","onClick"]))])):(s(),o(w,{key:1},[l.formatter?(s(),o("span",ct,M(l.formatter(e[l.key],e)),1)):(s(),o("span",ft,M(e[l.key]??"-"),1))],64))],!0)],10,nt))),128)),r.showAction?(s(),o("td",mt,[_(t.$slots,"cell-actions",{row:e},()=>[P(We,null,{default:H(()=>[P($,{icon:x(G),small:"",onClick:l=>le(e)},null,8,["icon","onClick"])]),_:2},1024)],!0)])):p("",!0)]))),128)),xe.value?(s(),o("tr",pt,[r.checkable?(s(),o("td",vt)):p("",!0),(s(!0),o(w,null,T(r.columns,e=>(s(),o("td",{key:e.key,class:N(["px-4 py-2",e.key==="actions"||e.isAction?"whitespace-nowrap":"whitespace-normal break-words"]),"data-label":e.label},[_(t.$slots,`aggregate-${e.key}`,{value:oe.value[e.key],column:e},()=>[e.aggregate?(s(),o("span",yt,M(oe.value[e.key]),1)):p("",!0)],!0)],10,gt))),128)),r.showAction?(s(),o("td",ht)):p("",!0)])):p("",!0)])]),r.loading?_(t.$slots,"loading-overlay",{key:0},void 0,!0):p("",!0)],512),_(t.$slots,"pagination",{page:u.value,pageSize:h.value,total:C.value.total,totalPages:R.value,goToPage:W,setPageSize:e=>{h.value=e,u.value=1,F()}},()=>[i("div",bt,[i("span",kt,M(C.value.total?(u.value-1)*h.value+1:0)+" - "+M(Math.min(u.value*h.value,C.value.total))+" of "+M(C.value.total)+" items ",1),i("div",wt,[P($,{icon:x(De),small:"",disabled:u.value===1,onClick:a[2]||(a[2]=e=>W(u.value-1))},null,8,["icon","disabled"]),(s(!0),o(w,null,T(ve.value,(e,l)=>(s(),B($,{key:l,active:e!=="..."&&e===u.value,label:e,small:"",disabled:e==="...",onClick:n=>e!=="..."&&W(e)},null,8,["active","label","disabled","onClick"]))),128)),P($,{icon:x(Fe),small:"",disabled:u.value===R.value,onClick:a[3]||(a[3]=e=>W(u.value+1))},null,8,["icon","disabled"]),i("select",{class:"border p-1 text-sm rounded",onChange:ge,value:h.value},a[5]||(a[5]=[i("option",{value:"5"},"5 / page",-1),i("option",{value:"10"},"10 / page",-1),i("option",{value:"20"},"20 / page",-1)]),40,xt)])])],!0)]))}},Mt=Ue(_t,[["__scopeId","data-v-55e2369a"]]),Ct=Le({name:"BaseLevel",props:{mobile:Boolean,type:{type:String,default:"justify-between"}},render(){const r=[this.type,"items-center"],d=["flex"],f=["block","md:flex"],v=["flex","items-center","justify-center"];return j("div",{class:r.concat(this.mobile?d:f)},this.$slots.default().map((c,g)=>{const m=!this.mobile&&this.$slots.default().length>g+1?v.concat(["mb-6","md:mb-0"]):v;return j("div",{class:m},[c])}))}}),$t={class:"flex flex-col md:flex-row items-center"},St={class:"text-center md:text-left md:py-2"},Lt={__name:"NotificationBar",props:{icon:{type:String,default:null},outline:Boolean,color:{type:String,required:!0},autoClose:{type:Number,default:5}},setup(r){const d=r,f=S(()=>d.outline?ze[d.color]:Ee[d.color]),v=k(!1);let c=null;const g=()=>{c&&(clearTimeout(c),c=null),v.value=!0},m=fe(),u=S(()=>m.right);return me(()=>{d.autoClose>0&&(c=setTimeout(()=>{g()},d.autoClose*1e3))}),X(()=>{c&&(clearTimeout(c),c=null)}),(h,z)=>v.value?p("",!0):(s(),o("div",{key:0,class:N([f.value,"px-3 py-6 md:py-3 mb-6 last:mb-0 border rounded-lg transition-colors duration-150"])},[P(Ct,null,{default:H(()=>[i("div",$t,[r.icon?(s(),B(Ie,{key:0,path:r.icon,w:"w-10 md:w-5",h:"h-10 md:h-5",size:"24",class:"md:mr-2"},null,8,["path"])):p("",!0),i("span",St,[_(h.$slots,"default")])]),u.value?_(h.$slots,"right",{key:0}):(s(),B($,{key:1,icon:x(Oe),small:"","rounded-full":"",color:"white",onClick:g},null,8,["icon"]))]),_:3})],2))}},zt={__name:"Badge",props:{text:{type:String,required:!0},tone:{type:String,default:"gray"}},setup(r){const d={blue:"bg-blue-50 text-blue-700 ring-blue-200",indigo:"bg-indigo-50 text-indigo-700 ring-indigo-200",emerald:"bg-emerald-50 text-emerald-700 ring-emerald-200",red:"bg-red-50 text-red-700 ring-red-200",gray:"bg-gray-100 text-gray-700 ring-gray-200",amber:"bg-amber-50 text-amber-700 ring-amber-200"};return(f,v)=>(s(),o("span",{class:N(["inline-flex items-center rounded-full px-2 py-[2px] text-[11px] ring-1",d[r.tone]||d.gray])},M(r.text),3))}};export{Mt as B,Lt as _,zt as a};
