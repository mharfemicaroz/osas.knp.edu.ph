import{_ as T,a as Y,q as p,t as E,r as F,n as G,s as O}from"./SectionMain.fMhQq8Wq.js";import{a as A,_ as H}from"./DoughnutChart.W8qMB62k.js";import{u as J}from"./club.CSizmTH7.js";import{u as K}from"./clubDoc.CLHnzEKO.js";import{z as Q,u as R,r as X,o as Z,c as i,A as tt,l as B,q as r,f as x,e as s,a as c,g as u,t as _,k as y}from"./index.BoABrvm7.js";import"./ToasterComponent.CMTvAW6n.js";import"./_plugin-vue_export-helper.DlAUqK2U.js";const st={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4"},et={class:"rounded-2xl border bg-white shadow-sm p-4"},ot={class:"flex items-center justify-between"},at={style:{width:"20px",height:"20px"},viewBox:"0 0 24 24",class:"text-blue-500"},lt=["d"],it={class:"mt-2 text-2xl font-semibold text-gray-900"},rt={class:"rounded-2xl border bg-white shadow-sm p-4"},dt={class:"flex items-center justify-between"},nt={style:{width:"20px",height:"20px"},viewBox:"0 0 24 24",class:"text-emerald-600"},ct=["d"],ut={class:"mt-2 text-2xl font-semibold text-gray-900"},mt={class:"rounded-2xl border bg-white shadow-sm p-4"},bt={class:"flex items-center justify-between"},gt={style:{width:"20px",height:"20px"},viewBox:"0 0 24 24",class:"text-indigo-600"},ht=["d"],xt={class:"mt-2 text-2xl font-semibold text-gray-900"},_t={class:"rounded-2xl border bg-white shadow-sm p-4"},vt={class:"flex items-center justify-between"},pt={style:{width:"20px",height:"20px"},viewBox:"0 0 24 24",class:"text-amber-600"},yt=["d"],ft={class:"mt-2 text-2xl font-semibold text-gray-900"},wt={class:"mt-6 grid grid-cols-1 lg:grid-cols-3 gap-6"},Ct={class:"rounded-2xl border bg-white shadow-sm"},St={class:"px-4 py-3 border-b flex items-center justify-between"},Mt={class:"text-sm font-semibold text-gray-800 flex items-center gap-2"},At={style:{width:"18px",height:"18px"},viewBox:"0 0 24 24",class:"text-blue-600"},Bt=["d"],kt={class:"p-4"},Dt={class:"h-72"},jt={class:"rounded-2xl border bg-white shadow-sm"},It={class:"px-4 py-3 border-b flex items-center justify-between"},zt={class:"text-sm font-semibold text-gray-800 flex items-center gap-2"},Lt={style:{width:"18px",height:"18px"},viewBox:"0 0 24 24",class:"text-emerald-600"},$t=["d"],Nt={class:"p-4"},Pt={class:"h-72"},Ut={class:"rounded-2xl border bg-white shadow-sm"},Vt={class:"px-4 py-3 border-b flex items-center justify-between"},Wt={class:"text-sm font-semibold text-gray-800 flex items-center gap-2"},qt={style:{width:"18px",height:"18px"},viewBox:"0 0 24 24",class:"text-blue-600"},Tt=["d"],Yt={class:"p-4"},Et={class:"h-72"},Xt={__name:"StudentDashboardPage",setup(Ft){const g=J(),h=K();Q();const k=R(),f=X(!0);Z(async()=>{try{await Promise.all([g.fetchAll({page:1,limit:1e3,filters:{include:"users"}},!0),h.fetchAll({page:1,limit:2e3},!0)])}finally{f.value=!1}});const w=i(()=>k.user?.id),D=i(()=>Array.isArray(g.clubs?.data)?g.clubs.data:[]),j=i(()=>Array.isArray(h.docs?.data)?h.docs.data:[]),d=i(()=>{const e=w.value;return e?D.value.filter(t=>Array.isArray(t.users)&&t.users.some(n=>n.id===e)):[]}),I=i(()=>d.value.length),z=i(()=>d.value.filter(e=>e.is_active!==!1).length),L=i(()=>d.value.reduce((e,t)=>e+(Array.isArray(t.users)?t.users.length:0),0)),$=i(()=>{const e=new Set(d.value.map(t=>t.id));return j.value.filter(t=>e.has(t.club_id)).length}),N=e=>{const t=(e??"active").toString().trim().toLowerCase();return["pending","active","inactive"].includes(t)?t:"active"},a={blue:"rgba(59,130,246,0.85)",blueSoft:"rgba(59,130,246,0.15)",indigo:"rgba(99,102,241,0.85)",indigoSoft:"rgba(99,102,241,0.15)",emerald:"rgba(16,185,129,0.85)",emeraldSoft:"rgba(16,185,129,0.15)",amber:"rgba(245,158,11,0.85)",amberSoft:"rgba(245,158,11,0.15)",rose:"rgba(244,63,94,0.85)",roseSoft:"rgba(244,63,94,0.15)",slate:"rgba(100,116,139,0.85)",slateSoft:"rgba(100,116,139,0.15)"},C=e=>t=>e[t%e.length],P=[a.blue,a.indigo,a.emerald,a.amber,a.rose,a.slate],U=[a.blueSoft,a.indigoSoft,a.emeraldSoft,a.amberSoft,a.roseSoft,a.slateSoft],S=C(P),M=C(U),V=i(()=>{const e={};for(const o of d.value){const l=(o.category||"Uncategorized").trim();e[l]=(e[l]||0)+1}const t=Object.keys(e).sort((o,l)=>e[l]-e[o]),n=t.map(o=>e[o]),b=t.map((o,l)=>M(l)),m=t.map((o,l)=>S(l));return{labels:t,datasets:[{label:"My Clubs",data:n,backgroundColor:b,borderColor:m,borderWidth:1.5}]}}),W=i(()=>{const e={active:0,pending:0,inactive:0},t=w.value;for(const n of d.value){const b=(n.users||[]).find(o=>o.id===t),m=N(b?.UserClub?.status);e[m]=(e[m]||0)+1}return{labels:["Active","Pending","Inactive"],datasets:[{data:[e.active,e.pending,e.inactive],backgroundColor:[a.emerald,a.amber,a.rose],borderColor:["white","white","white"],borderWidth:2}]}}),q=i(()=>{const e=d.value.map(o=>({name:o.name||o.code||`Club ${o.id}`,count:Array.isArray(o.users)?o.users.length:0})).sort((o,l)=>l.count-o.count),t=e.map(o=>o.name),n=e.map(o=>o.count),b=t.map((o,l)=>M(l)),m=t.map((o,l)=>S(l));return{labels:t,datasets:[{label:"Members",data:n,backgroundColor:b,borderColor:m,borderWidth:1.5}]}}),v=i(()=>f.value||g.isLoading||h.isLoading);return(e,t)=>(r(),tt(T,null,{default:B(()=>[x(Y,null,{default:B(()=>[t[11]||(t[11]=s("div",{class:"mb-4"},[s("h1",{class:"text-xl font-semibold text-gray-900"},"Student Dashboard"),s("p",{class:"text-sm text-gray-500"},"Your clubs, membership, and documents at a glance.")],-1)),s("div",st,[s("div",et,[s("div",ot,[t[0]||(t[0]=s("div",{class:"text-sm text-gray-500"},"My Clubs",-1)),(r(),c("svg",at,[s("path",{d:u(p)},null,8,lt)]))]),s("div",it,_(I.value),1),t[1]||(t[1]=s("div",{class:"mt-1 text-xs text-gray-500"},"You're a member of these clubs",-1))]),s("div",rt,[s("div",dt,[t[2]||(t[2]=s("div",{class:"text-sm text-gray-500"},"Active Memberships",-1)),(r(),c("svg",nt,[s("path",{d:u(E)},null,8,ct)]))]),s("div",ut,_(z.value),1),t[3]||(t[3]=s("div",{class:"mt-1 text-xs text-gray-500"},"Clubs currently active",-1))]),s("div",mt,[s("div",bt,[t[4]||(t[4]=s("div",{class:"text-sm text-gray-500"},"Members in My Clubs",-1)),(r(),c("svg",gt,[s("path",{d:u(F)},null,8,ht)]))]),s("div",xt,_(L.value),1),t[5]||(t[5]=s("div",{class:"mt-1 text-xs text-gray-500"},"Total membership size",-1))]),s("div",_t,[s("div",vt,[t[6]||(t[6]=s("div",{class:"text-sm text-gray-500"},"Documents",-1)),(r(),c("svg",pt,[s("path",{d:u(G)},null,8,yt)]))]),s("div",ft,_($.value),1),t[7]||(t[7]=s("div",{class:"mt-1 text-xs text-gray-500"},"Docs across your clubs",-1))])]),s("div",wt,[s("div",Ct,[s("div",St,[s("h3",Mt,[(r(),c("svg",At,[s("path",{d:u(p)},null,8,Bt)])),t[8]||(t[8]=y(" My Clubs by Category ",-1))])]),s("div",kt,[s("div",Dt,[x(A,{data:V.value,loading:v.value},null,8,["data","loading"])])])]),s("div",jt,[s("div",It,[s("h3",zt,[(r(),c("svg",Lt,[s("path",{d:u(O)},null,8,$t)])),t[9]||(t[9]=y(" My Membership Status ",-1))])]),s("div",Nt,[s("div",Pt,[x(H,{data:W.value,loading:v.value},null,8,["data","loading"])])])]),s("div",Ut,[s("div",Vt,[s("h3",Wt,[(r(),c("svg",qt,[s("path",{d:u(p)},null,8,Tt)])),t[10]||(t[10]=y(" Members by My Club ",-1))])]),s("div",Yt,[s("div",Et,[x(A,{data:q.value,loading:v.value,horizontal:!0},null,8,["data","loading"])])])])])]),_:1,__:[11]})]),_:1}))}};export{Xt as default};
